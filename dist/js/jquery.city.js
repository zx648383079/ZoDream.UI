var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
/**
 * 缓存数据
 */
var CacheUrl = (function () {
    function CacheUrl() {
    }
    CacheUrl.hasData = function (url) {
        return this._cacheData.hasOwnProperty(url);
    };
    CacheUrl.hasEvent = function (url) {
        return this._event.hasOwnProperty(url);
    };
    /**
     * 获取数据通过回调返回
     * @param url
     * @param callback
     */
    CacheUrl.getData = function (url, callback) {
        if (this.hasData(url)) {
            callback(this._cacheData[url]);
            return;
        }
        if (this.hasEvent(url)) {
            this._event[url].push(callback);
            return;
        }
        this._event[url] = [callback];
        var instance = this;
        $.getJSON(url, function (data) {
            if (data.code == 0) {
                instance.setData(url, data.data);
                return;
            }
            console.log('URL ERROR! ' + url);
        });
    };
    /**
     * 设置数据并回调
     * @param url
     * @param data
     */
    CacheUrl.setData = function (url, data) {
        this._cacheData[url] = data;
        if (!this.hasEvent(url)) {
            return;
        }
        this._event[url].forEach(function (callback) {
            callback(data);
        });
        delete this._event[url];
    };
    /**
     * 缓存的数据
     */
    CacheUrl._cacheData = {};
    /**
     * 缓存的事件
     */
    CacheUrl._event = {};
    return CacheUrl;
}());
var Eve = (function () {
    function Eve() {
    }
    Eve.prototype.on = function (event, callback) {
        this.options['on' + event] = callback;
        return this;
    };
    Eve.prototype.hasEvent = function (event) {
        return this.options.hasOwnProperty('on' + event);
    };
    Eve.prototype.trigger = function (event) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var realEvent = 'on' + event;
        if (!this.hasEvent(event)) {
            return;
        }
        return (_a = this.options[realEvent]).call.apply(_a, [this].concat(args));
        var _a;
    };
    return Eve;
}());
var Box = (function (_super) {
    __extends(Box, _super);
    function Box() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Box.prototype.showPosition = function () {
        this.setPosition();
        this.box.show();
        return this;
    };
    Box.prototype.setPosition = function () {
        var offset = this.element.offset();
        var x = offset.left - $(window).scrollLeft();
        var y = offset.top + this.element.outerHeight() - $(window).scrollTop();
        this.box.css({ left: x + "px", top: y + "px" });
        return this;
    };
    /**
     * 根据可能是相对值获取绝对值
     * @param abservable
     * @param reltive
     */
    Box.getReal = function (abservable, reltive) {
        if (reltive > 1) {
            return reltive;
        }
        return abservable * reltive;
    };
    return Box;
}(Eve));
/*!
 * jquery.city - https://github.com/zx648383079/ZoDream.UI
 * Version - 1.0
 * Licensed under the MIT license - http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2017 ZoDream
 */
var City = (function (_super) {
    __extends(City, _super);
    function City(element, options) {
        var _this = _super.call(this) || this;
        _this.element = element;
        _this._index = -1;
        _this.options = $.extend({}, new CityDefaultOptions(), options);
        if (typeof _this.options.data == 'function') {
            _this.options.data = _this.options.data.call(_this);
        }
        if (typeof _this.options.data == 'object') {
            _this.init();
            return _this;
        }
        var instance = _this;
        if (typeof _this.options.data == 'string') {
            CacheUrl.getData(_this.options.data, function (data) {
                instance.options.data = data;
                instance.init();
            });
        }
        return _this;
    }
    Object.defineProperty(City.prototype, "val", {
        get: function () {
            var val = '';
            this.map(function (id) {
                val = id;
            });
            return val;
        },
        set: function (arg) {
            this._val = arg;
            if (!this.box) {
                return;
            }
            this._selectedPath.apply(this, this.getPath(arg));
        },
        enumerable: true,
        configurable: true
    });
    City.prototype._selectedPath = function () {
        var args = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            args[_i] = arguments[_i];
        }
        var data = this.options.data;
        this._index = -1;
        this._header.html('');
        this._body.html('');
        var id;
        do {
            this._index++;
            id = args.shift();
            if (typeof data != 'object' || !data.hasOwnProperty(id)) {
                this.addTab(data);
                return;
            }
            this.addTab(data, '请选择', id);
            data = data[id][this.options.children];
        } while (args.length > 0);
        if (id) {
            this.trigger('change');
        }
    };
    City.prototype.init = function () {
        this._create();
        this._bindEvent();
        this.val = this._val || this.element.attr('data-id');
    };
    /**
     * 获取生成标签的头和身体
     */
    City.prototype._getHtml = function (data, title, selected) {
        if (title === void 0) { title = '请选择'; }
        var html = '';
        var instance = this;
        var header = '<li class="active">' + title + '</li>';
        $.each(data, function (i, item) {
            var _a = instance._getIdAndName(item, i), id = _a[0], name = _a[1];
            if (selected && id == selected) {
                html += '<li class="selected" data-id="' + id + '">' + name + '</li>';
                header = '<li class="active" data-id="' + id + '">' + name + '</li>';
                return;
            }
            html += '<li data-id="' + id + '">' + name + '</li>';
        });
        return [header, '<ul class="active">' + html + '</ul>'];
    };
    /**
     * 获取一个数据的id和显示的文字
     * @param item
     * @param i
     */
    City.prototype._getIdAndName = function (item, i) {
        if (typeof item != 'object') {
            return [i, item];
        }
        var name = item[this.options.name];
        if (this.options.id && item.hasOwnProperty(this.options.id)) {
            return [item[this.options.id], name];
        }
        return [i, name];
    };
    City.prototype._create = function () {
        this.box = $('<div class="selector" data-type="selector"></div>');
        var html = '<ul class="selector-header"></ul><div class="selector-body"></div>';
        if (!this.options.auto) {
            html += '<div class="selector-footer"><button class="selector-yes">确定</button></div>';
        }
        this.box.html(html + '<i class="fa fa-close"></i>');
        $(document.body).append(this.box);
        this._header = this.box.find('.selector-header');
        this._body = this.box.find('.selector-body');
    };
    City.prototype._bindEvent = function () {
        var instance = this;
        this.box.on('click', '.fa-close', function () {
            instance.close();
        });
        this._header.on('click', 'li', function () {
            instance.selectedTab($(this).index());
        });
        this._body.on('click', 'li', function () {
            var $this = $(this);
            var id = $this.attr('data-id');
            var index = $this.parent().index();
            $this.addClass('selected').siblings().removeClass('selected');
            instance._header.find('li').eq(index).attr('data-id', id)
                .text($this.text());
            instance.selected(id, index);
        });
        if (!this.options.auto) {
            this.box.on('click', '.selector-yes', function () {
                instance.trigger('done');
            });
        }
        /** 实现隐藏 */
        this.box.click(function (e) {
            e.stopPropagation();
        });
        this.element.click(function (e) {
            e.stopPropagation();
        });
        if (this.options.auto) {
            $(document).click(function () {
                instance.box.hide();
            });
        }
        $(window).scroll(function () {
            instance.setPosition();
        });
        this.element.click(function () {
            instance.show();
        });
    };
    City.prototype.bodyMap = function (callback, index) {
        if (index === void 0) { index = this._index; }
        this._body.find('ul').eq(index).find('li').each(function (i, ele) {
            var item = $(ele);
            var id = item.attr('data-id');
            if (!id) {
                return;
            }
            if (callback.call(item, id, item.text(), i) == false) {
                return false;
            }
        });
    };
    /**
     * 加载下一页不进行选择
     */
    City.prototype.selected = function (id, index) {
        if (index === void 0) { index = this._index; }
        this.remove(index + 1);
        var data = this._getNextData();
        this.trigger('change');
        if (typeof data == 'object') {
            this.addTab(data, '请选择');
        }
        if (!data || data.length == 0) {
            this.trigger('done');
            return this;
        }
        return this;
    };
    City.prototype._getNextData = function () {
        var data = this.options.data;
        var instance = this;
        this.map(function (id) {
            if (typeof data != 'object' || !data.hasOwnProperty(id)) {
                data = [];
                return false;
            }
            data = data[id][instance.options.children];
            if (!data) {
                data = [];
                return false;
            }
        });
        return data;
    };
    /**
     * 选中并触发加载下一页 不进行自动关闭
     */
    City.prototype.selectedId = function (id, index) {
        if (index === void 0) { index = this._index; }
        this.bodyMap(function (i) {
            if (i == id) {
                this.trigger('click');
                return false;
            }
        }, index);
    };
    City.prototype.close = function () {
        this.box.hide();
        return this;
    };
    City.prototype.show = function () {
        this.setPosition();
        this.box.show();
        return this;
    };
    City.prototype.selectedTab = function (index) {
        this._index = index;
        this._header.find('li').eq(index).addClass('active').siblings().removeClass('active');
        this._body.find('ul').eq(index).addClass('active').siblings().removeClass('active');
        return this;
    };
    City.prototype.addTab = function (data, title, selected) {
        if (title === void 0) { title = '请选择'; }
        this._header.find('li').removeClass('active');
        this._body.find('ul').removeClass('active');
        var _a = this._getHtml(data, title, selected), header = _a[0], body = _a[1];
        this._header.append(header);
        this._body.append(body);
        return this;
    };
    City.prototype.remove = function (start) {
        if (start === void 0) { start = 1; }
        var headers = this._header.find('li');
        var bodies = this._body.find('ul');
        for (var i = headers.length - 1; i >= start; i--) {
            headers.eq(i).remove();
            bodies.eq(i).remove();
        }
        return this;
    };
    City.prototype.map = function (callback) {
        this._header.find('li').each(function (i, ele) {
            var item = $(ele);
            var id = item.attr('data-id');
            if (!id) {
                return;
            }
            if (callback.call(item, id, item.text(), i) == false) {
                return false;
            }
        });
        return this;
    };
    City.prototype.text = function (link) {
        if (link === void 0) { link = this.options.line; }
        var arg = [];
        this.map(function (id, name) {
            arg.push(name);
        });
        return arg.join(link);
    };
    City.prototype.lastText = function () {
        var arg = '请选择';
        this.map(function (id, name) {
            arg = name;
        });
        return arg;
    };
    City.prototype.all = function () {
        var data = [];
        this.map(function (id) {
            data.push(id);
        });
        return data;
    };
    City.prototype.output = function (element) {
        if (element === void 0) { element = this.element; }
        element.attr('data-id', this.val);
        if (element.is('input') || element.is('textarea')) {
            element.val(this.text());
            return;
        }
        element.text(this.text());
    };
    City.prototype.change = function (callback) {
        return this.on('change', callback);
    };
    City.prototype.done = function (callback) {
        return this.on('done', callback);
    };
    /**
     * 根据ID查找无限树的路径
     * @param id
     */
    City.prototype.getPath = function (id) {
        if (!id) {
            return [];
        }
        if (this.options.hasOwnProperty(id)) {
            return [id];
        }
        var path = [], found = false, instance = this, findPath = function (data) {
            if (typeof data != 'object') {
                return;
            }
            if (data.hasOwnProperty(id)) {
                path.push(id);
                found = true;
                return;
            }
            $.each(data, function (key, args) {
                findPath(args[instance.options.children]);
                if (found) {
                    path.push(key);
                    return false;
                }
            });
        };
        $.each(this.options.data, function (key, data) {
            findPath(data[instance.options.children]);
            if (found) {
                path.push(key);
                return false;
            }
        });
        path.reverse();
        return path;
    };
    return City;
}(Box));
var CityDefaultOptions = (function () {
    function CityDefaultOptions() {
        this.id = 'id';
        this.name = 'name';
        this.children = 'children';
        this.line = '-';
        this.auto = true;
    }
    return CityDefaultOptions;
}());
;
(function ($) {
    $.fn.city = function (options) {
        return new City(this, options);
    };
})(jQuery);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNhY2hlLnRzIiwiZXZlbnQudHMiLCJib3gudHMiLCJqcXVlcnkuY2l0eS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7O0dBRUE7QUFDQTtJQUFBO0lBMkRBLENBQUE7SUFoREEsZ0JBQUEsR0FBQSxVQUFBLEdBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLFVBQUEsQ0FBQSxjQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsaUJBQUEsR0FBQSxVQUFBLEdBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxjQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUE7Ozs7T0FJQTtJQUNBLGdCQUFBLEdBQUEsVUFBQSxHQUFBLEVBQUEsUUFBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxNQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxPQUFBLENBQUEsR0FBQSxFQUFBLFVBQUEsSUFBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxRQUFBLENBQUEsT0FBQSxDQUFBLEdBQUEsRUFBQSxJQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLE9BQUEsQ0FBQSxHQUFBLENBQUEsYUFBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUE7Ozs7T0FJQTtJQUNBLGdCQUFBLEdBQUEsVUFBQSxHQUFBLEVBQUEsSUFBQTtRQUNBLElBQUEsQ0FBQSxVQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsTUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxVQUFBLFFBQUE7WUFDQSxRQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE9BQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUF6REE7O09BRUE7SUFDQSxtQkFBQSxHQUFBLEVBQUEsQ0FBQTtJQUVBOztPQUVBO0lBQ0EsZUFBQSxHQUFBLEVBQUEsQ0FBQTtJQWtEQSxlQUFBO0NBM0RBLEFBMkRBLElBQUE7QUM5REE7SUFBQTtJQW1CQSxDQUFBO0lBaEJBLGdCQUFBLEdBQUEsVUFBQSxLQUFBLEVBQUEsUUFBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQSxHQUFBLFFBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsc0JBQUEsR0FBQSxVQUFBLEtBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHFCQUFBLEdBQUEsVUFBQSxLQUFBO1FBQUEsY0FBQTthQUFBLFVBQUEsRUFBQSxxQkFBQSxFQUFBLElBQUE7WUFBQSw2QkFBQTs7UUFDQSxJQUFBLFNBQUEsR0FBQSxJQUFBLEdBQUEsS0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsQ0FBQSxLQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLFlBQUEsSUFBQSxTQUFBLElBQUEsR0FBQTs7SUFDQSxDQUFBO0lBQ0EsVUFBQTtBQUFBLENBbkJBLEFBbUJBLElBQUE7QUNuQkE7SUFBQSx1QkFBQTtJQUFBOztJQWdDQSxDQUFBO0lBMUJBLDBCQUFBLEdBQUE7UUFDQSxJQUFBLENBQUEsV0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx5QkFBQSxHQUFBO1FBQ0EsSUFBQSxNQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLE1BQUEsQ0FBQSxJQUFBLEdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLFVBQUEsRUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEdBQUEsTUFBQSxDQUFBLEdBQUEsR0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLFdBQUEsRUFBQSxHQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsSUFBQSxFQUFBLENBQUEsR0FBQSxJQUFBLEVBQUEsR0FBQSxFQUFBLENBQUEsR0FBQSxJQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBLENBQUE7SUFHQTs7OztPQUlBO0lBQ0EsV0FBQSxHQUFBLFVBQUEsVUFBQSxFQUFBLE9BQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxPQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLFVBQUEsR0FBQSxPQUFBLENBQUE7SUFDQSxDQUFBO0lBQ0EsVUFBQTtBQUFBLENBaENBLEFBZ0NBLENBaENBLEdBQUEsR0FnQ0E7QUNoQ0E7Ozs7OztHQU1BO0FBRUE7SUFBQSx3QkFBQTtJQUNBLGNBQ0EsT0FBQSxFQUNBLE9BQUE7UUFGQSxZQUlBLGlCQUFBLFNBZ0JBO1FBbkJBLGFBQUEsR0FBQSxPQUFBLENBQUE7UUE2QkEsWUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBO1FBekJBLEtBQUEsQ0FBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLEVBQUEsSUFBQSxrQkFBQSxFQUFBLEVBQUEsT0FBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxJQUFBLFVBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxLQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsR0FBQSxLQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxLQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsS0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBOztRQUVBLENBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxLQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxJQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxRQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxFQUFBLFVBQUEsSUFBQTtnQkFDQSxRQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsR0FBQSxJQUFBLENBQUE7Z0JBQ0EsUUFBQSxDQUFBLElBQUEsRUFBQSxDQUFBO1lBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBOztJQUNBLENBQUE7SUFjQSxzQkFBQSxxQkFBQTthQUFBO1lBQ0EsSUFBQSxHQUFBLEdBQUEsRUFBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLEVBQUE7Z0JBQ0EsR0FBQSxHQUFBLEVBQUEsQ0FBQTtZQUNBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLEdBQUEsQ0FBQTtRQUNBLENBQUE7YUFFQSxVQUFBLEdBQUE7WUFDQSxJQUFBLENBQUEsSUFBQSxHQUFBLEdBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLElBQUEsQ0FBQSxhQUFBLE9BQUEsSUFBQSxFQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsR0FBQSxDQUFBLEVBQUE7UUFDQSxDQUFBOzs7T0FSQTtJQVVBLDRCQUFBLEdBQUE7UUFBQSxjQUFBO2FBQUEsVUFBQSxFQUFBLHFCQUFBLEVBQUEsSUFBQTtZQUFBLHlCQUFBOztRQUNBLElBQUEsSUFBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLEVBQUEsQ0FBQTtRQUNBLEdBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtZQUNBLEVBQUEsR0FBQSxJQUFBLENBQUEsS0FBQSxFQUFBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLElBQUEsSUFBQSxRQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsY0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxJQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO2dCQUNBLE1BQUEsQ0FBQTtZQUNBLENBQUE7WUFDQSxJQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsRUFBQSxLQUFBLEVBQUEsRUFBQSxDQUFBLENBQUE7WUFDQSxJQUFBLEdBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLFFBQUEsSUFBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLEVBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7SUFDQSxDQUFBO0lBRUEsbUJBQUEsR0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxVQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLElBQUEsSUFBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7T0FFQTtJQUNBLHVCQUFBLEdBQUEsVUFBQSxJQUFBLEVBQUEsS0FBQSxFQUFBLFFBQUE7UUFBQSxzQkFBQSxFQUFBLGFBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLE1BQUEsR0FBQSxxQkFBQSxHQUFBLEtBQUEsR0FBQSxPQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxVQUFBLENBQUEsRUFBQSxJQUFBO1lBQ0EsSUFBQSxvQ0FBQSxFQUFBLFVBQUEsRUFBQSxZQUFBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxRQUFBLElBQUEsRUFBQSxJQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsSUFBQSxJQUFBLGdDQUFBLEdBQUEsRUFBQSxHQUFBLElBQUEsR0FBQSxJQUFBLEdBQUEsT0FBQSxDQUFBO2dCQUNBLE1BQUEsR0FBQSw4QkFBQSxHQUFBLEVBQUEsR0FBQSxJQUFBLEdBQUEsSUFBQSxHQUFBLE9BQUEsQ0FBQTtnQkFDQSxNQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsSUFBQSxJQUFBLGVBQUEsR0FBQSxFQUFBLEdBQUEsSUFBQSxHQUFBLElBQUEsR0FBQSxPQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxDQUFBLE1BQUEsRUFBQSxxQkFBQSxHQUFBLElBQUEsR0FBQSxPQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7OztPQUlBO0lBQ0EsNEJBQUEsR0FBQSxVQUFBLElBQUEsRUFBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxJQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxDQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsRUFBQSxJQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUEsSUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsc0JBQUEsR0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBLG1EQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLG9FQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsSUFBQSw2RUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsR0FBQSw2QkFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLGtCQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLEdBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxJQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHlCQUFBLEdBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxPQUFBLEVBQUEsV0FBQSxFQUFBO1lBQ0EsUUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLEVBQUEsQ0FBQSxPQUFBLEVBQUEsSUFBQSxFQUFBO1lBQ0EsUUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsS0FBQSxFQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFBLENBQUEsT0FBQSxFQUFBLElBQUEsRUFBQTtZQUNBLElBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsRUFBQSxHQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLEtBQUEsR0FBQSxLQUFBLENBQUEsTUFBQSxFQUFBLENBQUEsS0FBQSxFQUFBLENBQUE7WUFDQSxLQUFBLENBQUEsUUFBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLFFBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQTtZQUVBLFFBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsU0FBQSxFQUFBLEVBQUEsQ0FBQTtpQkFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBLENBQUE7WUFDQSxRQUFBLENBQUEsUUFBQSxDQUFBLEVBQUEsRUFBQSxLQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxPQUFBLEVBQUEsZUFBQSxFQUFBO2dCQUNBLFFBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxXQUFBO1FBQ0EsSUFBQSxDQUFBLEdBQUEsQ0FBQSxLQUFBLENBQUEsVUFBQSxDQUFBO1lBQ0EsQ0FBQSxDQUFBLGVBQUEsRUFBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxVQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsZUFBQSxFQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLENBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxLQUFBLENBQUE7Z0JBQ0EsUUFBQSxDQUFBLEdBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtZQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxNQUFBLENBQUE7WUFDQSxRQUFBLENBQUEsV0FBQSxFQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLElBQUEsRUFBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsc0JBQUEsR0FBQSxVQUFBLFFBQUEsRUFBQSxLQUFBO1FBQUEsc0JBQUEsRUFBQSxRQUFBLElBQUEsQ0FBQSxNQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsRUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLEVBQUEsR0FBQTtZQUNBLElBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsRUFBQSxJQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsQ0FBQSxDQUFBLElBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxNQUFBLENBQUEsS0FBQSxDQUFBO1lBQ0EsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUdBOztPQUVBO0lBQ0EsdUJBQUEsR0FBQSxVQUFBLEVBQUEsRUFBQSxLQUFBO1FBQUEsc0JBQUEsRUFBQSxRQUFBLElBQUEsQ0FBQSxNQUFBO1FBQ0EsSUFBQSxDQUFBLE1BQUEsQ0FBQSxLQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsWUFBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxJQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxFQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxJQUFBLElBQUEsQ0FBQSxNQUFBLElBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsMkJBQUEsR0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBO1FBQ0EsSUFBQSxRQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEdBQUEsQ0FBQSxVQUFBLEVBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLElBQUEsSUFBQSxRQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsY0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxJQUFBLEdBQUEsRUFBQSxDQUFBO2dCQUNBLE1BQUEsQ0FBQSxLQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsSUFBQSxHQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsT0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLElBQUEsR0FBQSxFQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUE7O09BRUE7SUFDQSx5QkFBQSxHQUFBLFVBQUEsRUFBQSxFQUFBLEtBQUE7UUFBQSxzQkFBQSxFQUFBLFFBQUEsSUFBQSxDQUFBLE1BQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLFVBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBLEVBQUEsS0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsb0JBQUEsR0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxFQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLG1CQUFBLEdBQUE7UUFDQSxJQUFBLENBQUEsV0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLElBQUEsRUFBQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSwwQkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLEdBQUEsS0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsRUFBQSxDQUNBLEtBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxRQUFBLEVBQUEsQ0FBQSxXQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLFFBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEscUJBQUEsR0FBQSxVQUFBLElBQUEsRUFBQSxLQUFBLEVBQUEsUUFBQTtRQUFBLHNCQUFBLEVBQUEsYUFBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEseUNBQUEsRUFBQSxjQUFBLEVBQUEsWUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEscUJBQUEsR0FBQSxVQUFBLEtBQUE7UUFBQSxzQkFBQSxFQUFBLFNBQUE7UUFDQSxJQUFBLE9BQUEsR0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO1FBQ0EsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsT0FBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxJQUFBLEtBQUEsRUFBQSxDQUFBLEVBQUEsRUFBQSxDQUFBO1lBQ0EsT0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsTUFBQSxFQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxrQkFBQSxHQUFBLFVBQUEsUUFBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsRUFBQSxHQUFBO1lBQ0EsSUFBQSxJQUFBLEdBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxFQUFBLEdBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxNQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsRUFBQSxFQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsRUFBQSxDQUFBLENBQUEsSUFBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLE1BQUEsQ0FBQSxLQUFBLENBQUE7WUFDQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLG1CQUFBLEdBQUEsVUFBQSxJQUFBO1FBQUEscUJBQUEsRUFBQSxPQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQTtRQUNBLElBQUEsR0FBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLENBQUEsVUFBQSxFQUFBLEVBQUEsSUFBQTtZQUNBLEdBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHVCQUFBLEdBQUE7UUFDQSxJQUFBLEdBQUEsR0FBQSxLQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLFVBQUEsRUFBQSxFQUFBLElBQUE7WUFDQSxHQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsR0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLGtCQUFBLEdBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLFVBQUEsRUFBQTtZQUNBLElBQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEscUJBQUEsR0FBQSxVQUFBLE9BQUE7UUFBQSx3QkFBQSxFQUFBLFVBQUEsSUFBQSxDQUFBLE9BQUE7UUFDQSxPQUFBLENBQUEsSUFBQSxDQUFBLFNBQUEsRUFBQSxJQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsRUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLE9BQUEsQ0FBQSxFQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsT0FBQSxDQUFBLEdBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHFCQUFBLEdBQUEsVUFBQSxRQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsUUFBQSxFQUFBLFFBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLG1CQUFBLEdBQUEsVUFBQSxRQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsTUFBQSxFQUFBLFFBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBOzs7T0FHQTtJQUNBLHNCQUFBLEdBQUEsVUFBQSxFQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLGNBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxFQUFBLEVBQ0EsS0FBQSxHQUFBLEtBQUEsRUFDQSxRQUFBLEdBQUEsSUFBQSxFQUNBLFFBQUEsR0FBQSxVQUFBLElBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLElBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLE1BQUEsQ0FBQTtZQUNBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsY0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxJQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBO2dCQUNBLEtBQUEsR0FBQSxJQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLENBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxFQUFBLFVBQUEsR0FBQSxFQUFBLElBQUE7Z0JBQ0EsUUFBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsT0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtvQkFDQSxJQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO29CQUNBLE1BQUEsQ0FBQSxLQUFBLENBQUE7Z0JBQ0EsQ0FBQTtZQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBO1FBRUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsRUFBQSxVQUFBLEdBQUEsRUFBQSxJQUFBO1lBQ0EsUUFBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsT0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLElBQUEsQ0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLEVBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBQ0EsV0FBQTtBQUFBLENBM1dBLEFBMldBLENBM1dBLEdBQUEsR0EyV0E7QUFjQTtJQUFBO1FBQ0EsT0FBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLFNBQUEsR0FBQSxNQUFBLENBQUE7UUFDQSxhQUFBLEdBQUEsVUFBQSxDQUFBO1FBQ0EsU0FBQSxHQUFBLEdBQUEsQ0FBQTtRQUNBLFNBQUEsR0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBQUEseUJBQUE7QUFBQSxDQU5BLEFBTUEsSUFBQTtBQUVBLENBQUE7QUFBQSxDQUFBLFVBQUEsQ0FBQTtJQUNBLENBQUEsQ0FBQSxFQUFBLENBQUEsSUFBQSxHQUFBLFVBQUEsT0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsT0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBLENBQUE7QUFDQSxDQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSIsImZpbGUiOiJqcXVlcnkuY2l0eS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDnvJPlrZjmlbDmja5cclxuICovXHJcbmNsYXNzIENhY2hlVXJsIHtcclxuICAgIC8qKlxyXG4gICAgICog57yT5a2Y55qE5pWw5o2uXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgc3RhdGljIF9jYWNoZURhdGE6IHtbdXJsOiBzdHJpbmddOiBhbnl9ID0ge307XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDnvJPlrZjnmoTkuovku7ZcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBzdGF0aWMgX2V2ZW50OiB7W3VybDogc3RyaW5nXTogQXJyYXk8KGRhdGE6IGFueSkgPT4gdm9pZD59ID0ge307XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBoYXNEYXRhKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2NhY2hlRGF0YS5oYXNPd25Qcm9wZXJ0eSh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgaGFzRXZlbnQodXJsOiBzdHJpbmcpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZXZlbnQuaGFzT3duUHJvcGVydHkodXJsKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPluaVsOaNrumAmui/h+Wbnuiwg+i/lOWbnlxyXG4gICAgICogQHBhcmFtIHVybCBcclxuICAgICAqIEBwYXJhbSBjYWxsYmFjayBcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXREYXRhKHVybDogc3RyaW5nLCBjYWxsYmFjazogKGRhdGE6IGFueSkgPT4gdm9pZCkge1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0RhdGEodXJsKSkge1xyXG4gICAgICAgICAgICBjYWxsYmFjayh0aGlzLl9jYWNoZURhdGFbdXJsXSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaGFzRXZlbnQodXJsKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9ldmVudFt1cmxdLnB1c2goY2FsbGJhY2spO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2V2ZW50W3VybF0gPSBbY2FsbGJhY2tdO1xyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgJC5nZXRKU09OKHVybCwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoZGF0YS5jb2RlID09IDApIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLnNldERhdGEodXJsLCBkYXRhLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdVUkwgRVJST1IhICcgKyB1cmwpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5pWw5o2u5bm25Zue6LCDXHJcbiAgICAgKiBAcGFyYW0gdXJsIFxyXG4gICAgICogQHBhcmFtIGRhdGEgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgc2V0RGF0YSh1cmw6IHN0cmluZywgZGF0YTogYW55KSB7XHJcbiAgICAgICAgdGhpcy5fY2FjaGVEYXRhW3VybF0gPSBkYXRhO1xyXG4gICAgICAgIGlmICghdGhpcy5oYXNFdmVudCh1cmwpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZXZlbnRbdXJsXS5mb3JFYWNoKGNhbGxiYWNrPT57XHJcbiAgICAgICAgICAgIGNhbGxiYWNrKGRhdGEpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGRlbGV0ZSB0aGlzLl9ldmVudFt1cmxdO1xyXG4gICAgfVxyXG59IiwiYWJzdHJhY3QgY2xhc3MgRXZlIHtcclxuICAgIHB1YmxpYyBvcHRpb25zOiBhbnk7XHJcblxyXG4gICAgcHVibGljIG9uKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbik6IHRoaXMge1xyXG4gICAgICAgIHRoaXMub3B0aW9uc1snb24nICsgZXZlbnRdID0gY2FsbGJhY2s7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGhhc0V2ZW50KGV2ZW50OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmhhc093blByb3BlcnR5KCdvbicgKyBldmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHRyaWdnZXIoZXZlbnQ6IHN0cmluZywgLi4uIGFyZ3M6IGFueVtdKSB7XHJcbiAgICAgICAgbGV0IHJlYWxFdmVudCA9ICdvbicgKyBldmVudDtcclxuICAgICAgICBpZiAoIXRoaXMuaGFzRXZlbnQoZXZlbnQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uc1tyZWFsRXZlbnRdLmNhbGwodGhpcywgLi4uYXJncyk7XHJcbiAgICB9XHJcbn0iLCJhYnN0cmFjdCBjbGFzcyBCb3ggZXh0ZW5kcyBFdmUge1xyXG5cclxuICAgIHB1YmxpYyBlbGVtZW50OiBKUXVlcnk7XHJcblxyXG4gICAgcHVibGljIGJveDogSlF1ZXJ5O1xyXG5cclxuICAgIHByb3RlY3RlZCBzaG93UG9zaXRpb24oKTogdGhpcyB7XHJcbiAgICAgICAgdGhpcy5zZXRQb3NpdGlvbigpO1xyXG4gICAgICAgIHRoaXMuYm94LnNob3coKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwcm90ZWN0ZWQgc2V0UG9zaXRpb24oKTogdGhpcyB7XHJcbiAgICAgICAgbGV0IG9mZnNldCA9IHRoaXMuZWxlbWVudC5vZmZzZXQoKTtcclxuICAgICAgICBsZXQgeCA9IG9mZnNldC5sZWZ0IC0gJCh3aW5kb3cpLnNjcm9sbExlZnQoKTtcclxuICAgICAgICBsZXQgeSA9IG9mZnNldC50b3AgKyB0aGlzLmVsZW1lbnQub3V0ZXJIZWlnaHQoKSAtICQod2luZG93KS5zY3JvbGxUb3AoKTtcclxuICAgICAgICB0aGlzLmJveC5jc3Moe2xlZnQ6IHggKyBcInB4XCIsIHRvcDogeSArIFwicHhcIn0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICAvKipcclxuICAgICAqIOagueaNruWPr+iDveaYr+ebuOWvueWAvOiOt+WPlue7neWvueWAvFxyXG4gICAgICogQHBhcmFtIGFic2VydmFibGUgXHJcbiAgICAgKiBAcGFyYW0gcmVsdGl2ZSBcclxuICAgICAqL1xyXG4gICAgcHVibGljIHN0YXRpYyBnZXRSZWFsKGFic2VydmFibGU6IG51bWJlciwgcmVsdGl2ZTogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgICAgICBpZiAocmVsdGl2ZSA+IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlbHRpdmU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhYnNlcnZhYmxlICogcmVsdGl2ZTtcclxuICAgIH1cclxufSIsIi8qIVxyXG4gKiBqcXVlcnkuY2l0eSAtIGh0dHBzOi8vZ2l0aHViLmNvbS96eDY0ODM4MzA3OS9ab0RyZWFtLlVJXHJcbiAqIFZlcnNpb24gLSAxLjBcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIC0gaHR0cDovL29wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL01JVFxyXG4gKlxyXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTcgWm9EcmVhbVxyXG4gKi9cclxuXHJcbmNsYXNzIENpdHkgZXh0ZW5kcyBCb3gge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsZW1lbnQ6IEpRdWVyeSxcclxuICAgICAgICBvcHRpb25zPzogQ2l0eU9wdGlvbnNcclxuICAgICkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0gJC5leHRlbmQoe30sIG5ldyBDaXR5RGVmYXVsdE9wdGlvbnMoKSwgb3B0aW9ucyk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMuZGF0YSA9PSAnZnVuY3Rpb24nKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5kYXRhID0gdGhpcy5vcHRpb25zLmRhdGEuY2FsbCh0aGlzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0aGlzLm9wdGlvbnMuZGF0YSA9PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgIGlmICh0eXBlb2YgdGhpcy5vcHRpb25zLmRhdGEgPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgQ2FjaGVVcmwuZ2V0RGF0YSh0aGlzLm9wdGlvbnMuZGF0YSwgZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uub3B0aW9ucy5kYXRhID0gZGF0YTtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmluaXQoKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcHRpb25zOiBDaXR5T3B0aW9ucztcclxuXHJcbiAgICBwdWJsaWMgYm94OiBKUXVlcnk7XHJcblxyXG4gICAgcHJpdmF0ZSBfaGVhZGVyOiBKUXVlcnk7XHJcblxyXG4gICAgcHJpdmF0ZSBfYm9keTogSlF1ZXJ5O1xyXG5cclxuICAgIHByaXZhdGUgX2luZGV4OiBudW1iZXIgPSAtMTtcclxuXHJcbiAgICBwcml2YXRlIF92YWw6IHN0cmluZztcclxuXHJcbiAgICBwdWJsaWMgZ2V0IHZhbCgpIHtcclxuICAgICAgICBsZXQgdmFsID0gJyc7XHJcbiAgICAgICAgdGhpcy5tYXAoaWQgPT4ge1xyXG4gICAgICAgICAgICB2YWwgPSBpZDtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdmFsO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXQgdmFsKGFyZzogc3RyaW5nKSB7XHJcbiAgICAgICAgdGhpcy5fdmFsID0gYXJnO1xyXG4gICAgICAgIGlmICghdGhpcy5ib3gpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9zZWxlY3RlZFBhdGgoLi4udGhpcy5nZXRQYXRoKGFyZykpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3NlbGVjdGVkUGF0aCguLi5hcmdzOiBBcnJheTxzdHJpbmc+KSB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLm9wdGlvbnMuZGF0YTtcclxuICAgICAgICB0aGlzLl9pbmRleCA9IC0xO1xyXG4gICAgICAgIHRoaXMuX2hlYWRlci5odG1sKCcnKTtcclxuICAgICAgICB0aGlzLl9ib2R5Lmh0bWwoJycpO1xyXG4gICAgICAgIGxldCBpZDtcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luZGV4ICsrO1xyXG4gICAgICAgICAgICBpZCA9IGFyZ3Muc2hpZnQoKTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBkYXRhICE9ICdvYmplY3QnIHx8ICFkYXRhLmhhc093blByb3BlcnR5KGlkKSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5hZGRUYWIoZGF0YSk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5hZGRUYWIoZGF0YSwgJ+ivt+mAieaLqScsIGlkKTtcclxuICAgICAgICAgICAgZGF0YSA9IGRhdGFbaWRdW3RoaXMub3B0aW9ucy5jaGlsZHJlbl07XHJcbiAgICAgICAgfSB3aGlsZSAoYXJncy5sZW5ndGggPiAwKTtcclxuICAgICAgICBpZiAoaWQpIHtcclxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdjaGFuZ2UnKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIGluaXQoKSB7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlKCk7XHJcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KCk7XHJcbiAgICAgICAgdGhpcy52YWwgPSB0aGlzLl92YWwgfHwgdGhpcy5lbGVtZW50LmF0dHIoJ2RhdGEtaWQnKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlueUn+aIkOagh+etvueahOWktOWSjOi6q+S9k1xyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9nZXRIdG1sKGRhdGE6IGFueSwgdGl0bGU6IHN0cmluZyA9ICfor7fpgInmi6knLCBzZWxlY3RlZD86IHN0cmluZyB8IG51bWJlcik6IFtzdHJpbmcsIHN0cmluZ10ge1xyXG4gICAgICAgIGxldCBodG1sID0gJyc7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBsZXQgaGVhZGVyID0gJzxsaSBjbGFzcz1cImFjdGl2ZVwiPicgKyB0aXRsZSArICc8L2xpPic7XHJcbiAgICAgICAgJC5lYWNoKGRhdGEsIChpLCBpdGVtKSA9PiB7XHJcbiAgICAgICAgICAgIGxldCBbaWQsIG5hbWVdID0gaW5zdGFuY2UuX2dldElkQW5kTmFtZShpdGVtLCBpKTtcclxuICAgICAgICAgICAgaWYgKHNlbGVjdGVkICYmIGlkID09IHNlbGVjdGVkKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sICs9ICc8bGkgY2xhc3M9XCJzZWxlY3RlZFwiIGRhdGEtaWQ9XCInICsgaWQgKyAnXCI+JyArIG5hbWUgKyc8L2xpPic7XHJcbiAgICAgICAgICAgICAgICBoZWFkZXIgPSAnPGxpIGNsYXNzPVwiYWN0aXZlXCIgZGF0YS1pZD1cIicgKyBpZCArICdcIj4nICsgbmFtZSArICc8L2xpPic7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaHRtbCArPSAnPGxpIGRhdGEtaWQ9XCInICsgaWQgKyAnXCI+JyArIG5hbWUgKyc8L2xpPic7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIFtoZWFkZXIsICc8dWwgY2xhc3M9XCJhY3RpdmVcIj4nICsgaHRtbCArICc8L3VsPiddO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6I635Y+W5LiA5Liq5pWw5o2u55qEaWTlkozmmL7npLrnmoTmloflrZdcclxuICAgICAqIEBwYXJhbSBpdGVtIFxyXG4gICAgICogQHBhcmFtIGkgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2dldElkQW5kTmFtZShpdGVtOiBhbnksIGk6IHN0cmluZ3wgbnVtYmVyKTogW3N0cmluZ3wgbnVtYmVyLCBzdHJpbmddIHtcclxuICAgICAgICBpZiAodHlwZW9mIGl0ZW0gIT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtpLCBpdGVtXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IG5hbWUgPSBpdGVtW3RoaXMub3B0aW9ucy5uYW1lXTtcclxuICAgICAgICBpZiAodGhpcy5vcHRpb25zLmlkICYmIGl0ZW0uaGFzT3duUHJvcGVydHkodGhpcy5vcHRpb25zLmlkKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gW2l0ZW1bdGhpcy5vcHRpb25zLmlkXSwgbmFtZV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbaSwgbmFtZV07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfY3JlYXRlKCkge1xyXG4gICAgICAgIHRoaXMuYm94ID0gJCgnPGRpdiBjbGFzcz1cInNlbGVjdG9yXCIgZGF0YS10eXBlPVwic2VsZWN0b3JcIj48L2Rpdj4nKTtcclxuICAgICAgICBsZXQgaHRtbCA9ICc8dWwgY2xhc3M9XCJzZWxlY3Rvci1oZWFkZXJcIj48L3VsPjxkaXYgY2xhc3M9XCJzZWxlY3Rvci1ib2R5XCI+PC9kaXY+JztcclxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5hdXRvKSB7XHJcbiAgICAgICAgICAgIGh0bWwgKz0gJzxkaXYgY2xhc3M9XCJzZWxlY3Rvci1mb290ZXJcIj48YnV0dG9uIGNsYXNzPVwic2VsZWN0b3IteWVzXCI+56Gu5a6aPC9idXR0b24+PC9kaXY+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5ib3guaHRtbChodG1sICsgJzxpIGNsYXNzPVwiZmEgZmEtY2xvc2VcIj48L2k+Jyk7XHJcbiAgICAgICAgJChkb2N1bWVudC5ib2R5KS5hcHBlbmQodGhpcy5ib3gpO1xyXG4gICAgICAgIHRoaXMuX2hlYWRlciA9IHRoaXMuYm94LmZpbmQoJy5zZWxlY3Rvci1oZWFkZXInKTtcclxuICAgICAgICB0aGlzLl9ib2R5ID0gdGhpcy5ib3guZmluZCgnLnNlbGVjdG9yLWJvZHknKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9iaW5kRXZlbnQoKSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLmJveC5vbignY2xpY2snLCAnLmZhLWNsb3NlJywgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmNsb3NlKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5faGVhZGVyLm9uKCdjbGljaycsICdsaScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgaW5zdGFuY2Uuc2VsZWN0ZWRUYWIoJCh0aGlzKS5pbmRleCgpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9ib2R5Lm9uKCdjbGljaycsICdsaScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsZXQgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICBsZXQgaWQgPSAkdGhpcy5hdHRyKCdkYXRhLWlkJyk7XHJcbiAgICAgICAgICAgIGxldCBpbmRleCA9ICR0aGlzLnBhcmVudCgpLmluZGV4KCk7XHJcbiAgICAgICAgICAgICR0aGlzLmFkZENsYXNzKCdzZWxlY3RlZCcpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ3NlbGVjdGVkJyk7XHJcblxyXG4gICAgICAgICAgICBpbnN0YW5jZS5faGVhZGVyLmZpbmQoJ2xpJykuZXEoaW5kZXgpLmF0dHIoJ2RhdGEtaWQnLCBpZClcclxuICAgICAgICAgICAgIC50ZXh0KCR0aGlzLnRleHQoKSk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnNlbGVjdGVkKGlkLCBpbmRleCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMuYXV0bykge1xyXG4gICAgICAgICAgICB0aGlzLmJveC5vbignY2xpY2snLCAnLnNlbGVjdG9yLXllcycsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UudHJpZ2dlcignZG9uZScpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgLyoqIOWunueOsOmakOiXjyAqL1xyXG4gICAgICAgIHRoaXMuYm94LmNsaWNrKGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuY2xpY2soZnVuY3Rpb24oZSkge1xyXG4gICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuYXV0bykge1xyXG4gICAgICAgICAgICAkKGRvY3VtZW50KS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmJveC5oaWRlKCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkKHdpbmRvdykuc2Nyb2xsKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5zZXRQb3NpdGlvbigpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2Uuc2hvdygpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBib2R5TWFwKGNhbGxiYWNrOiAoaWQ6IHN0cmluZywgbmFtZTogc3RyaW5nLCBpbmRleDogbnVtYmVyKSA9PiBhbnksIGluZGV4OiBudW1iZXIgPSB0aGlzLl9pbmRleCkge1xyXG4gICAgICAgIHRoaXMuX2JvZHkuZmluZCgndWwnKS5lcShpbmRleCkuZmluZCgnbGknKS5lYWNoKGZ1bmN0aW9uKGksIGVsZSkge1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9ICQoZWxlKTtcclxuICAgICAgICAgICAgbGV0IGlkID0gaXRlbS5hdHRyKCdkYXRhLWlkJyk7XHJcbiAgICAgICAgICAgIGlmICghaWQpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoY2FsbGJhY2suY2FsbChpdGVtLCBpZCwgaXRlbS50ZXh0KCksIGkpID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDliqDovb3kuIvkuIDpobXkuI3ov5vooYzpgInmi6lcclxuICAgICAqL1xyXG4gICAgcHVibGljIHNlbGVjdGVkKGlkPzogc3RyaW5nfCBudW1iZXIsIGluZGV4OiBudW1iZXIgPSB0aGlzLl9pbmRleCkge1xyXG4gICAgICAgIHRoaXMucmVtb3ZlKGluZGV4ICsgMSk7XHJcbiAgICAgICAgbGV0IGRhdGEgPSB0aGlzLl9nZXROZXh0RGF0YSgpO1xyXG4gICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJyk7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIHRoaXMuYWRkVGFiKGRhdGEsICfor7fpgInmi6knKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFkYXRhIHx8IGRhdGEubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgdGhpcy50cmlnZ2VyKCdkb25lJyk7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXROZXh0RGF0YSgpOiBhbnkge1xyXG4gICAgICAgIGxldCBkYXRhID0gdGhpcy5vcHRpb25zLmRhdGE7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLm1hcChpZCA9PiB7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgZGF0YSAhPSAnb2JqZWN0JyB8fCAhZGF0YS5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcclxuICAgICAgICAgICAgICAgIGRhdGEgPSBbXTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBkYXRhID0gZGF0YVtpZF1baW5zdGFuY2Uub3B0aW9ucy5jaGlsZHJlbl07XHJcbiAgICAgICAgICAgIGlmICghZGF0YSkge1xyXG4gICAgICAgICAgICAgICAgZGF0YSA9IFtdO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDpgInkuK3lubbop6blj5HliqDovb3kuIvkuIDpobUg5LiN6L+b6KGM6Ieq5Yqo5YWz6ZetXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZWxlY3RlZElkKGlkOiBzdHJpbmd8IG51bWJlciwgaW5kZXg6IG51bWJlciA9IHRoaXMuX2luZGV4KSB7XHJcbiAgICAgICAgdGhpcy5ib2R5TWFwKGZ1bmN0aW9uKGkpIHtcclxuICAgICAgICAgICAgaWYgKGkgPT0gaWQpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMudHJpZ2dlcignY2xpY2snKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0sICBpbmRleCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNsb3NlKCkge1xyXG4gICAgICAgIHRoaXMuYm94LmhpZGUoKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2hvdygpIHtcclxuICAgICAgICB0aGlzLnNldFBvc2l0aW9uKCk7XHJcbiAgICAgICAgdGhpcy5ib3guc2hvdygpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZWxlY3RlZFRhYihpbmRleDogbnVtYmVyKTogdGhpcyB7XHJcbiAgICAgICAgdGhpcy5faW5kZXggPSBpbmRleDtcclxuICAgICAgICB0aGlzLl9oZWFkZXIuZmluZCgnbGknKS5lcVxyXG4gICAgICAgIChpbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHRoaXMuX2JvZHkuZmluZCgndWwnKS5lcShpbmRleCkuYWRkQ2xhc3MoJ2FjdGl2ZScpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhZGRUYWIoZGF0YTogYW55LCB0aXRsZTogc3RyaW5nID0gJ+ivt+mAieaLqScsIHNlbGVjdGVkPzogc3RyaW5nfCBudW1iZXIpOiB0aGlzIHtcclxuICAgICAgICB0aGlzLl9oZWFkZXIuZmluZCgnbGknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XHJcbiAgICAgICAgdGhpcy5fYm9keS5maW5kKCd1bCcpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcclxuICAgICAgICBsZXQgW2hlYWRlciwgYm9keV0gPSB0aGlzLl9nZXRIdG1sKGRhdGEsIHRpdGxlLCBzZWxlY3RlZCk7XHJcbiAgICAgICAgdGhpcy5faGVhZGVyLmFwcGVuZChoZWFkZXIpO1xyXG4gICAgICAgIHRoaXMuX2JvZHkuYXBwZW5kKGJvZHkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW1vdmUoc3RhcnQ6IG51bWJlciA9IDEpOiB0aGlzIHtcclxuICAgICAgICBsZXQgaGVhZGVycyA9IHRoaXMuX2hlYWRlci5maW5kKCdsaScpO1xyXG4gICAgICAgIGxldCBib2RpZXMgPSB0aGlzLl9ib2R5LmZpbmQoJ3VsJyk7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IGhlYWRlcnMubGVuZ3RoIC0gMTsgaSA+PSBzdGFydDsgaS0tKSB7XHJcbiAgICAgICAgICAgIGhlYWRlcnMuZXEoaSkucmVtb3ZlKCk7XHJcbiAgICAgICAgICAgIGJvZGllcy5lcShpKS5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG1hcChjYWxsYmFjazogKGlkOiBzdHJpbmcsIG5hbWU6IHN0cmluZywgaW5kZXg6IG51bWJlcikgPT4gYW55KTogdGhpcyB7XHJcbiAgICAgICAgdGhpcy5faGVhZGVyLmZpbmQoJ2xpJykuZWFjaChmdW5jdGlvbihpLCBlbGUpIHtcclxuICAgICAgICAgICAgbGV0IGl0ZW0gPSAkKGVsZSk7XHJcbiAgICAgICAgICAgIGxldCBpZCA9IGl0ZW0uYXR0cignZGF0YS1pZCcpO1xyXG4gICAgICAgICAgICBpZiAoIWlkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGNhbGxiYWNrLmNhbGwoaXRlbSwgaWQsIGl0ZW0udGV4dCgpLCBpKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHRleHQobGluazogc3RyaW5nID0gdGhpcy5vcHRpb25zLmxpbmUpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCBhcmcgPSBbXTtcclxuICAgICAgICB0aGlzLm1hcCgoaWQsIG5hbWUpID0+IHtcclxuICAgICAgICAgICAgYXJnLnB1c2gobmFtZSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGFyZy5qb2luKGxpbmspO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBsYXN0VGV4dCgpOiBzdHJpbmcge1xyXG4gICAgICAgIGxldCBhcmcgPSAn6K+36YCJ5oupJztcclxuICAgICAgICB0aGlzLm1hcCgoaWQsIG5hbWUpID0+IHtcclxuICAgICAgICAgICAgYXJnID0gbmFtZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gYXJnO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhbGwoKTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBbXTtcclxuICAgICAgICB0aGlzLm1hcChpZCA9PiB7XHJcbiAgICAgICAgICAgIGRhdGEucHVzaChpZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG91dHB1dChlbGVtZW50OiBKUXVlcnkgPSB0aGlzLmVsZW1lbnQpIHtcclxuICAgICAgICBlbGVtZW50LmF0dHIoJ2RhdGEtaWQnLCB0aGlzLnZhbCk7XHJcbiAgICAgICAgaWYgKGVsZW1lbnQuaXMoJ2lucHV0JykgfHwgZWxlbWVudC5pcygndGV4dGFyZWEnKSkge1xyXG4gICAgICAgICAgICBlbGVtZW50LnZhbCh0aGlzLnRleHQoKSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxlbWVudC50ZXh0KHRoaXMudGV4dCgpKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2hhbmdlKGNhbGxiYWNrOiAoaWQ/OiBzdHJpbmd8IG51bWJlciwgaW5kZXg/OiBudW1iZXIsIHNlbGVjdGVkPzogc3RyaW5nfCBudW1iZXIpID0+IGFueSk6IHRoaXMge1xyXG4gICAgICAgIHJldHVybiB0aGlzLm9uKCdjaGFuZ2UnLCBjYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGRvbmUoY2FsbGJhY2s6IEZ1bmN0aW9uKTogdGhpcyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub24oJ2RvbmUnLCBjYWxsYmFjayk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja5JROafpeaJvuaXoOmZkOagkeeahOi3r+W+hFxyXG4gICAgICogQHBhcmFtIGlkIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgZ2V0UGF0aChpZDogc3RyaW5nKTogQXJyYXk8c3RyaW5nPiB7XHJcbiAgICAgICAgaWYgKCFpZCkge1xyXG4gICAgICAgICAgICByZXR1cm4gW107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbnMuaGFzT3duUHJvcGVydHkoaWQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbaWRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgcGF0aCA9IFtdLFxyXG4gICAgICAgICAgICBmb3VuZCA9IGZhbHNlLFxyXG4gICAgICAgICAgICBpbnN0YW5jZSA9IHRoaXMsXHJcbiAgICAgICAgICAgIGZpbmRQYXRoID0gZnVuY3Rpb24oZGF0YTogYW55KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIGRhdGEgIT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXRoLnB1c2goaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvdW5kID0gdHJ1ZTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAkLmVhY2goZGF0YSwgZnVuY3Rpb24oa2V5LCBhcmdzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmluZFBhdGgoYXJnc1tpbnN0YW5jZS5vcHRpb25zLmNoaWxkcmVuXSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvdW5kKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHBhdGgucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICQuZWFjaCh0aGlzLm9wdGlvbnMuZGF0YSwgZnVuY3Rpb24oa2V5LCBkYXRhKSB7XHJcbiAgICAgICAgICAgIGZpbmRQYXRoKGRhdGFbaW5zdGFuY2Uub3B0aW9ucy5jaGlsZHJlbl0pO1xyXG4gICAgICAgICAgICBpZiAoZm91bmQpIHtcclxuICAgICAgICAgICAgICAgIHBhdGgucHVzaChrZXkpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcGF0aC5yZXZlcnNlKCk7XHJcbiAgICAgICAgcmV0dXJuIHBhdGg7XHJcbiAgICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBDaXR5T3B0aW9ucyB7XHJcbiAgICBbc2V0dGluZzogc3RyaW5nXTogYW55LFxyXG4gICAgZGF0YT86IGFueSxcclxuICAgIG9uY2hhbmdlPzogKCkgPT4gYW55LFxyXG4gICAgb25kb25lPzogRnVuY3Rpb24sXHJcbiAgICBpZD86IHN0cmluZywgICAvLyBpZOeahOagh+W/l1xyXG4gICAgbmFtZT86IHN0cmluZywgIC8vIOaWh+Wtl+eahOagh+W/l1xyXG4gICAgY2hpbGRyZW4/OiBzdHJpbmcsIC8vIOWtkOS7o+eahOagh+W/l1xyXG4gICAgbGluZT86IHN0cmluZywgIC8v6L+e5o6l56ym5Y+3XHJcbiAgICBhdXRvPzogYm9vbGVhbiAvLyDoh6rliqjovpPlh7pcclxufVxyXG5cclxuY2xhc3MgQ2l0eURlZmF1bHRPcHRpb25zIGltcGxlbWVudHMgQ2l0eU9wdGlvbnMge1xyXG4gICAgaWQ6IHN0cmluZyA9ICdpZCc7XHJcbiAgICBuYW1lOiBzdHJpbmcgPSAnbmFtZSc7XHJcbiAgICBjaGlsZHJlbjogc3RyaW5nID0gJ2NoaWxkcmVuJztcclxuICAgIGxpbmU6IHN0cmluZyA9ICctJztcclxuICAgIGF1dG86IGJvb2xlYW4gPSB0cnVlO1xyXG59XHJcblxyXG47KGZ1bmN0aW9uKCQ6IGFueSkge1xyXG4gICAgJC5mbi5jaXR5ID0gZnVuY3Rpb24ob3B0aW9ucyA/OiBDaXR5T3B0aW9ucykge1xyXG4gICAgICAgIHJldHVybiBuZXcgQ2l0eSh0aGlzLCBvcHRpb25zKTsgXHJcbiAgICB9O1xyXG59KShqUXVlcnkpOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
