var DialogType,DialogDirection,DialogStatus,DialogDiskType,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,o){t.__proto__=o}||function(t,o){for(var i in o)o.hasOwnProperty(i)&&(t[i]=o[i])};return function(o,i){function e(){this.constructor=o}t(o,i),o.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}(),CacheUrl=function(){function t(){}return t.hasData=function(t){return this._cacheData.hasOwnProperty(t)},t.hasEvent=function(t){return this._event.hasOwnProperty(t)},t.getData=function(t,o){if(this.hasData(t))o(this._cacheData[t]);else if(this.hasEvent(t))this._event[t].push(o);else{this._event[t]=[o];var i=this;$.getJSON(t,function(o){0!=o.code?console.log("URL ERROR! "+t):i.setData(t,o.data)})}},t.setData=function(t,o){this._cacheData[t]=o,this.hasEvent(t)&&(this._event[t].forEach(function(t){t(o)}),delete this._event[t])},t._cacheData={},t._event={},t}(),Eve=function(){function t(){}return t.prototype.on=function(t,o){return this.options["on"+t]=o,this},t.prototype.hasEvent=function(t){return this.options.hasOwnProperty("on"+t)},t.prototype.trigger=function(t){for(var o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var e,n="on"+t;if(this.hasEvent(t))return(e=this.options[n]).call.apply(e,[this].concat(o))},t}(),Box=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}return __extends(o,t),o.prototype.showPosition=function(){return this.setPosition(),this.box.show(),this},o.prototype.setPosition=function(){var t=this.element.offset(),o=t.left-$(window).scrollLeft(),i=t.top+this.element.outerHeight()-$(window).scrollTop();return this.box.css({left:o+"px",top:i+"px"}),this},o.getReal=function(t,o){return o>1?o:t*o},o}(Eve),DialogCore=function(t){function o(o,i){var e=t.call(this)||this;return e.id=i,e._status=DialogStatus.closed,e.options=$.extend({},e.getDefaultOption(),o),e.options.type=Dialog.parseEnum(e.options.type,DialogType),e}return __extends(o,t),Object.defineProperty(o.prototype,"status",{get:function(){return this._status},set:function(t){if(t=Dialog.parseEnum(t,DialogStatus),this._status!=t)switch(t){case DialogStatus.show:this.showBox();break;case DialogStatus.hide:this.hideBox();break;case DialogStatus.closing:this.options.closeAnimate?this.closingBox():this.closeBox();break;case DialogStatus.closed:this.closeBox();break;default:throw"status error:"+t}},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"y",{get:function(){return this._y||(this._y=this.box.offset().top-$(window).scrollTop()),this._y},set:function(t){this._y=t,this.css("top",t+"px")},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"height",{get:function(){return this._height||(this._height=this.box.height()),this._height},set:function(t){this._height=t,this.box.height(t)},enumerable:!0,configurable:!0}),o.prototype.changeStatus=function(t){this._status=t},o.prototype.getDefaultOption=function(){return new DefaultDialogOption},o.prototype.showBox=function(){return this.box||this.init(),0==this.trigger("show")?(console.log("show stop!"),!1):(this.doShowStatus(),!0)},o.prototype.doShowStatus=function(){this.box.show(),this._status=DialogStatus.show},o.prototype.hideBox=function(){return this.box||this.init(),0==this.trigger("hide")?(console.log("hide stop!"),!1):(this.doHideStatus(),!0)},o.prototype.doHideStatus=function(){this.box.hide(),this._status=DialogStatus.hide},o.prototype.closingBox=function(){return!!this.box&&(this.status!=DialogStatus.closing&&this.status!=DialogStatus.closed&&(0==this.trigger("closing")?(console.log("closing stop!"),!1):(this.doClosingStatus(),!0)))},o.prototype.doClosingStatus=function(){this._status=DialogStatus.closing;var t=this;this.box.addClass("dialog-closing").one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){t.status==DialogStatus.closing&&t.closeBox()})},o.prototype.closeBox=function(){return!!this.box&&(0==this.trigger("closed")?(console.log("closed stop!"),!1):(this.doCloseStatus(),!0))},o.prototype.doCloseStatus=function(){this._status=DialogStatus.closed,this._dialogBg&&(this._dialogBg.remove(),this._dialogBg=void 0),Dialog.removeItem(this.id),this.box.remove(),this.box=void 0},o.prototype.createCore=function(){return this.box=$('<div class="dialog dialog-'+DialogType[this.options.type]+'" data-type="dialog" dialog-id='+this.id+"></div>"),this},o.prototype.css=function(t,o){return this.box.css(t,o),this},o.prototype.show=function(){return this.status=DialogStatus.show,this},o.prototype.hide=function(){return this.status=DialogStatus.hide,this},o.prototype.close=function(t){return void 0===t&&(t=!0),this.status=t?DialogStatus.closing:DialogStatus.closed,this},o.prototype.toggle=function(){return this.status==DialogStatus.hide?this.show():this.hide()},o.prototype.getDialogTop=function(){var t,o=this,i=this;return Dialog.map(function(e){e.options.type==o.options.type&&e.id!=i.id&&(!t||e.y<t)&&(t=e.y)}),t},o.prototype.getDialogBottom=function(){var t,o=this,i=this;return Dialog.map(function(e){if(e.options.type==o.options.type&&e.id!=i.id){var n=e.y+e.height;(!t||n>t)&&(t=n)}}),t},o.prototype._getBottom=function(){return Math.max(.33*$(window).height()-this.height/2,0)},o.prototype._getTop=function(){return Math.max($(window).height()/2-this.height/2,0)},o.prototype._getLeft=function(){return Math.max($(window).width()/2-this.box.width()/2,0)},o.prototype._getRight=function(){return Math.max($(window).width()/2-this.box.width()/2,0)},o.prototype._getWidth=function(){var t=Dialog.$window.width();return this.options.width>1?t:t*this.options.width},o.prototype._getHeight=function(){var t=Dialog.$window.height();return this.options.height>1?t:t*this.options.height},o.prototype._getLeftTop=function(t,o,i,e,n){switch(t){case DialogDirection.leftTop:return[0,0];case DialogDirection.top:return[(n-o)/2,0];case DialogDirection.rightTop:return[n-o,0];case DialogDirection.right:return[n-o,(n-i)/2];case DialogDirection.rightBottom:return[n-o,n-i];case DialogDirection.bottom:return[(n-o)/2,n-i];case DialogDirection.leftBottom:return[0,n-i];case DialogDirection.left:return[0,(n-i)/2];case DialogDirection.center:default:return[(n-o)/2,(n-i)/2]}},o.prototype.top=function(t){return t?this.css("top",t+"px"):this.box.offset().top},o.prototype.left=function(t){return t?this.css("left",t+"px"):this.box.offset().left},o.prototype.width=function(t){return t?this.css("width",t+"px"):this.box.width()},o.prototype.addClass=function(t){return this.box.addClass(t),this},o.prototype.hasClass=function(t){return this.box.hasClass(t)},o.prototype.removeClass=function(t){return this.box.removeClass(t),this},o.prototype.find=function(t){return this.box.find(t)},o}(Box),DefaultDialogOption=function(){return function(){this.title="提示",this.type=DialogType.tip,this.canMove=!0,this.closeAnimate=!0,this.ondone=function(){this.close()}}}(),Dialog=function(){function t(){}return t.create=function(t){return t.type||(t.type=DialogType.tip),t.type=this.parseEnum(t.type,DialogType),new(this.getMethod(t.type))(t)},t.parseEnum=function(t,o){return"string"==typeof t?o[t]:t},t.tip=function(t,o){return void 0===o&&(o=2e3),"object"!=typeof t&&(t={content:t,time:o}),t.type=DialogType.tip,this.create(t).show()},t.message=function(t,o){return void 0===o&&(o=2e3),"object"!=typeof t&&(t={content:t,time:o}),t.type=DialogType.message,this.create(t).show()},t.pop=function(t,o,i){return void 0===i&&(i=2e3),"object"!=typeof t&&(t={content:t,time:i,target:o}),t.type=DialogType.pop,this.create(t).show()},t.loading=function(t){return void 0===t&&(t=0),"object"!=typeof t&&(t={time:t}),t.type=DialogType.loading,this.create(t).show()},t.content=function(t,o,i){return"object"!=typeof t&&(t={content:t,hasYes:o,hasNo:i}),t.type=DialogType.content,this.create(t).show()},t.box=function(t,o,i,e){return void 0===o&&(o="提示"),"object"!=typeof t&&(t={content:t,title:o,hasYes:i,hasNo:e}),t.type=DialogType.box,this.create(t).show()},t.form=function(t,o,i,e,n){return void 0===o&&(o="提示"),this.create({type:DialogType.form,content:t,title:o,hasYes:e,hasNo:n,ondone:i}).show()},t.page=function(t,o,i,e){return void 0===o&&(o="提示"),"object"!=typeof t&&(t={content:t,title:o,hasYes:i,hasNo:e}),t.type=DialogType.page,this.create(t).show()},t.notify=function(t,o,i){return void 0===t&&(t="通知"),void 0===o&&(o=""),void 0===i&&(i=""),"object"!=typeof t&&(t={title:t,content:o,ico:i}),t.type=DialogType.notify,this.create(t).show()},t.addItem=function(t){this._data[++this._guid]=t,t.id=this._guid},t.hasItem=function(t){return void 0===t&&(t=this._guid),this._data.hasOwnProperty(t+"")},t.get=function(t){if(void 0===t&&(t=this._guid),this.hasItem(t))return this._data[t];throw"error:"+t},t.removeItem=function(t){void 0===t&&(t=this._guid),this.hasItem(t)&&(this._data[t].close(),delete this._data[t])},t.remove=function(){this.map(function(t){t.close()})},t.map=function(t){for(var o in this._data){if(this.hasItem(o))if(0==t(this._data[o]))return}},t.showBg=function(t,o){void 0===t&&(t=$(document.body)),void 0===o&&(o=!0);var i=this;this._dialogBg||(this._dialogBg=$('<div class="dialog-bg"></div>'),this._dialogBg.click(function(t){t.stopPropagation(),i.remove()})),t.append(this._dialogBg),this._dialogBg.toggleClass("dialog-bg-private",!o),this._bgLock++,this._dialogBg.show()},t.closeBg=function(){this._dialogBg&&(this._bgLock--,this._bgLock>0||this._dialogBg.hide())},t.addMethod=function(t,o){this.methods[t]=o},t.hasMethod=function(t){return this.methods.hasOwnProperty(t.toString())},t.getMethod=function(t){return this.methods[t]},t.methods={},t._data={},t._guid=0,t._tipData=[],t._bgLock=0,t.$window=$(window),t}();!function(t){t[t.tip=0]="tip",t[t.message=1]="message",t[t.notify=2]="notify",t[t.pop=3]="pop",t[t.loading=4]="loading",t[t.select=5]="select",t[t.image=6]="image",t[t.disk=7]="disk",t[t.form=8]="form",t[t.content=9]="content",t[t.box=10]="box",t[t.page=11]="page"}(DialogType||(DialogType={})),function(t){t[t.top=0]="top",t[t.right=1]="right",t[t.bottom=2]="bottom",t[t.left=3]="left",t[t.center=4]="center",t[t.leftTop=5]="leftTop",t[t.rightTop=6]="rightTop",t[t.rightBottom=7]="rightBottom",t[t.leftBottom=8]="leftBottom"}(DialogDirection||(DialogDirection={})),function(t){t[t.hide=0]="hide",t[t.show=1]="show",t[t.closing=2]="closing",t[t.closed=3]="closed"}(DialogStatus||(DialogStatus={})),function(t){t[t.file=0]="file",t[t.directory=1]="directory"}(DialogDiskType||(DialogDiskType={}));var DialogPlugin=function(){function t(t,o){this.element=t,this.option=o;var i=this;this.element.click(function(){i.dialog||(i.dialog=Dialog.create(i._parseOption($(this)))),i.dialog.show()})}return t.prototype._parseOption=function(t){var o=$.extend({},this.option);return o.type=Dialog.parseEnum(t.attr("dialog-type")||this.option.type,DialogType),o.content=t.attr("dialog-content")||this.option.content,o.url=t.attr("dialog-url")||this.option.url,o.time=parseInt(t.attr("dialog-time"))||this.option.time,o.type!=DialogType.pop||o.target||(o.target=t),o},t}();jQuery.fn.dialog=function(t){return new DialogPlugin(this,t)};var DialogTip=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.init=function(){Dialog.addItem(this),this.createCore().createContent().appendParent().setProperty().bindEvent().addTime()},o.prototype.getDefaultOption=function(){return new DefaultDialogTipOption},o.prototype.createContent=function(){return this.box.text(this.options.content),this},o.prototype.appendParent=function(){return this.box?this.options.target?(this.options.target.append(this.box),this.box.addClass("dialog-private"),this):($(document.body).append(this.box),this):this},o.prototype.setProperty=function(){var t=Dialog.$window.width(),o=this.box.width();return this.y=(this.getDialogTop()||.68*Dialog.$window.height()+30)-30-this.height,this.css("left",(t-o)/2+"px"),this},o.prototype.bindEvent=function(){this.box.click(function(t){t.stopPropagation()});var t=this;return $(window).resize(function(){t.box&&t.resize()}),this},o.prototype.resize=function(){var t=Dialog.$window.width(),o=this.box.width();this.css("left",(t-o)/2+"px"),this.trigger("resize")},o.prototype.addTime=function(){if(!(this.options.time<=0)){var t=this;this._timeHandle=setTimeout(function(){t._timeHandle=void 0,t.close()},this.options.time)}},o.prototype.stopTime=function(){this._timeHandle&&(clearTimeout(this._timeHandle),this._timeHandle=void 0)},o.prototype.closingBox=function(){return!!t.prototype.closingBox.call(this)&&(this.stopTime(),!0)},o.prototype.closeBox=function(){return!!t.prototype.closeBox.call(this)&&(this.changeOther(),this.stopTime(),!0)},o.prototype.changeOther=function(){var t=this;Dialog.map(function(o){o.options.type!=DialogType.tip||o.y>=t.y||(o.y+=t.height+30)})},o}(DialogCore),DefaultDialogTipOption=function(){return function(){this.time=2e3}}();Dialog.addMethod(DialogType.tip,DialogTip);var DialogMessage=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.setProperty=function(){return this.height,this.y=(this.getDialogBottom()||.1*Dialog.$window.height()-30)+30,this},o.prototype.bindEvent=function(){return this},o.prototype.changeOther=function(){var t=this;Dialog.map(function(o){o.options.type!=DialogType.message||o.y<=t.y||(o.y-=t.height+30)})},o}(DialogTip);Dialog.addMethod(DialogType.message,DialogMessage);var DialogNotify=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.createContent=function(){throw new Error("Method not implemented.")},o.prototype.setProperty=function(){throw new Error("Method not implemented.")},o.prototype.getDefaultOption=function(){return new DefaultDialogNotifyOption},o.prototype.showBox=function(){return!this.notify&&(Dialog.addItem(this),this._createNotify(),!0)},o.prototype.hideBox=function(){return this.closeBox()},o.prototype.closingBox=function(){return this.closeBox()},o.prototype.closeBox=function(){return this.status!=DialogStatus.closing&&this.status!=DialogStatus.closed&&(0==this.trigger("closed")?(console.log("closed stop!"),!1):(this._closeNotify(),Dialog.removeItem(this.id),this.changeStatus(DialogStatus.closed),this.stopTime(),!0))},o.prototype._createNotify=function(){var t=this;"Notification"in window?Notification.requestPermission().then(function(o){"granted"!==o&&console.log("您的浏览器支持但未开启桌面提醒！"),t.notify=new Notification(t.options.title,{body:t.options.content,icon:t.options.ico}),t.notify.addEventListener("click",function(o){t.trigger("done")})}):console.log("您的浏览器不支持桌面提醒！")},o.prototype._closeNotify=function(){this.notify&&(this.notify.close(),this.notify=void 0)},o}(DialogTip),DefaultDialogNotifyOption=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.title="提示",o}return __extends(o,t),o}(DefaultDialogTipOption);Dialog.addMethod(DialogType.notify,DialogNotify);var DialogPop=function(t){function o(o,i){var e=t.call(this,o,i)||this;return e.options.direction&&(e.options.direction=Dialog.parseEnum(e.options.direction,DialogDirection)),e}return __extends(o,t),o.prototype.setProperty=function(){return this._setPopProperty(),this},o.prototype.appendParent=function(){return this.box?($(document.body).append(this.box),this):this},o.prototype.bindEvent=function(){return this},o.prototype._getRandomDirection=function(){return Math.floor(8*Math.random())},o.prototype._setPopProperty=function(){this.options.direction||(this.options.direction=this._getRandomDirection()),this.box.addClass("dialog-pop-"+DialogDirection[this.options.direction]);var t=this.options.target.offset(),o=this._getPopLeftTop(Dialog.parseEnum(this.options.direction,DialogCore),this.box.outerWidth(),this.box.outerHeight(),t.left,t.top,this.options.target.outerWidth(),this.options.target.outerHeight()),i=o[0],e=o[1];this.box.css({left:i+"px",top:e+"px"})},o.prototype._getPopLeftTop=function(t,o,i,e,n,s,a){switch(t){case DialogDirection.rightTop:case DialogDirection.right:return[e+s+30,n+(a-i)/2];case DialogDirection.rightBottom:case DialogDirection.bottom:return[e+(s-o)/2,n+a+30];case DialogDirection.leftBottom:case DialogDirection.left:return[e-o-30,n+(a-i)/2];case DialogDirection.center:case DialogDirection.leftTop:case DialogDirection.top:default:return[e+(s-o)/2,n-i-30]}},o}(DialogTip);Dialog.addMethod(DialogType.pop,DialogPop);var DialogLoading=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.getDefaultOption=function(){return new DefaultDialogLoadingOption},o.prototype.createContent=function(){return this.box.html(this._getLoading()),this},o.prototype.setProperty=function(){var t=this.options.target||Dialog.$window,o=t.width(),i=this.box.width(),e=t.height(),n=this.box.height();return this.css({left:(o-i)/2+"px",top:(e-n)/2+"px"}),this},o.prototype._getLoading=function(){for(var t="",o=this.options.count;o>0;o--)t+="<span></span>";return'<div class="'+this.options.extra+'">'+t+"</div>"},o.prototype.showBox=function(){return!!t.prototype.showBox.call(this)&&(this.options.target?(Dialog.showBg(this.options.target,!1),!0):(Dialog.showBg(),!0))},o.prototype.hideBox=function(){return!!t.prototype.hideBox.call(this)&&(Dialog.closeBg(),!0)},o.prototype.closingBox=function(){return!!t.prototype.closingBox.call(this)&&(Dialog.closeBg(),!0)},o.prototype.closeBox=function(){var o=this.status;return!!t.prototype.closeBox.call(this)&&(o!=DialogStatus.closing&&Dialog.closeBg(),!0)},o}(DialogTip),DefaultDialogLoadingOption=function(){return function(){this.extra="loading",this.count=5,this.time=0}}();Dialog.addMethod(DialogType.loading,DialogLoading);var DialogContent=function(t){function o(o,i){var e=t.call(this,o,i)||this;if(e._isLoading=!1,!e.options.content&&e.options.url){var n=e;e.isLoading=!0,$.get(e.options.url,function(t){n.options.content=t,this.isLoading=!1,n.init()})}return e}return __extends(o,t),Object.defineProperty(o.prototype,"isLoading",{get:function(){return this._isLoading},set:function(t){this._isLoading=t,this._toggleLoading(),this._isLoading||this.status!=DialogStatus.show||this.showBox()},enumerable:!0,configurable:!0}),o.prototype._toggleLoading=function(t){void 0===t&&(t=this.status),this.isLoading&&t==DialogStatus.show?this._loadingDialog?this._loadingDialog.show():this._loadingDialog=Dialog.loading().show():this._loadingDialog&&(this._loadingDialog.close(),this._loadingDialog=void 0)},o.prototype.init=function(){Dialog.addItem(this),this.createCore().createContent().appendParent().setProperty().bindEvent(),this.status==DialogStatus.show&&this.showBox()},o.prototype.getDefaultOption=function(){return new DefaultDialogContentOption},o.prototype.createContent=function(){return this.box.html(this.getContentHtml()+this.getFooterHtml()),this},o.prototype.appendParent=function(){return $(document.body).append(this.box),this},o.prototype.setProperty=function(){return this},o.prototype.bindEvent=function(){return this.box.click(function(t){t.stopPropagation()}),this.onClick(".dialog-yes",function(){this.trigger("done")}),this.onClick(".dialog-close",function(){this.close()}),this},o.prototype.getContentHtml=function(){var t=this.options.content;return"object"==typeof t&&(t=JSON.stringify(t)),'<div class="dialog-body">'+t+"</div>"},o.prototype.getFooterHtml=function(){if(!this.options.hasYes&&!this.options.hasNo&&"object"==typeof this.options.button&&this.options.button instanceof Array&&0==this.options.button.length)return"";var t='<div class="dialog-footer">';return this.options.hasYes&&(t+='<button class="dialog-yes">'+("string"==typeof this.options.hasYes?this.options.hasYes:"确认")+"</button>"),this.options.hasNo&&(t+='<button class="dialog-close">'+("string"==typeof this.options.hasNo?this.options.hasNo:"取消")+"</button>"),"string"==typeof this.options.button&&(this.options.button=[this.options.button]),$.each(this.options.button,function(o,i){t+="string"!=typeof i?'<button class="'+i.tag+'">'+i.content+"</button>":'<button">'+i+"</button>"}),t+="</div>"},o.prototype.onClick=function(t,o){var i=this;this.box.on("click",t,function(t){o.call(i,$(this))})},o.prototype.showBox=function(){return this.isLoading?(this.changeStatus(DialogStatus.show),!1):!!t.prototype.showBox.call(this)&&(Dialog.showBg(this.options.target),!0)},o.prototype.hideBox=function(){return this.isLoading?(this.changeStatus(DialogStatus.hide),!1):!!t.prototype.hideBox.call(this)&&(Dialog.closeBg(),!0)},o.prototype.closingBox=function(){return this.isLoading?(this.changeStatus(DialogStatus.hide),!1):!!t.prototype.closingBox.call(this)&&(Dialog.closeBg(),!0)},o.prototype.closeBox=function(){if(this.isLoading)return this.changeStatus(DialogStatus.hide),!1;var o=this.status;return!!t.prototype.closeBox.call(this)&&(o!=DialogStatus.closing&&Dialog.closeBg(),!0)},o}(DialogCore),DefaultDialogContentOption=function(){return function(){this.hasYes=!0,this.hasNo=!0,this.time=0,this.button=[]}}();Dialog.addMethod(DialogType.content,DialogContent);var DialogBox=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.createContent=function(){return this.box.html(this.getHeaderHtml()+this.getContentHtml()+this.getFooterHtml()),this},o.prototype.setProperty=function(){var t=this.options.target||Dialog.$window,o=t.width(),i=this.box.width(),e=t.height(),n=this.box.height();return o>i&&e>n?(this.css({left:(o-i)/2+"px",top:(e-n)/2+"px"}),this):(this.options.type=DialogType.page,this.box.addClass("dialog-page"),Dialog.closeBg(),this)},o.prototype.bindEvent=function(){var o,i,e=this,n=!1;return this.box.find(".dialog-header .dialog-title").mousedown(function(t){n=!0,o=t.pageX-parseInt(e.box.css("left")),i=t.pageY-parseInt(e.box.css("top")),e.box.fadeTo(20,.5)}),$(document).mousemove(function(t){n&&e.status==DialogStatus.show&&e.box.css({top:t.pageY-i,left:t.pageX-o})}).mouseup(function(){n=!1,e.box&&e.status==DialogStatus.show&&e.box.fadeTo("fast",1)}),$(window).resize(function(){e.box&&e.resize()}),t.prototype.bindEvent.call(this)},o.prototype.resize=function(){this.setProperty(),this.trigger("resize")},o.prototype.getDefaultOption=function(){return new DefaultDialogBoxOption},o.prototype.getHeaderHtml=function(){var t='<div class="dialog-header"><div class="dialog-title">';return this.options.ico&&(t+='<i class="fa fa-'+this.options.ico+'"></i>'),this.options.title&&(t+=this.options.title),t+'</div><i class="fa fa-close dialog-close"></i></div>'},o}(DialogContent),DefaultDialogBoxOption=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.title="提示",o.canMove=!0,o}return __extends(o,t),o}(DefaultDialogContentOption);Dialog.addMethod(DialogType.box,DialogBox);var DialogForm=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),Object.defineProperty(o.prototype,"data",{get:function(){return this._data||(this._data=this._getFormData()),this._data},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"elements",{get:function(){return this._elements||(this._elements=this._getFormElement()),this._elements},enumerable:!0,configurable:!0}),o.prototype.getContentHtml=function(){return'<div class="dialog-body">'+this._createForm(this.options.content)+"</div>"},o.prototype._createForm=function(t){if("object"!=typeof t)return t;var o="",i=this;return $.each(t,function(t,e){o+=i._createInput(t,e)}),o},o.prototype._createInput=function(t,o){"object"!=typeof o&&(o={label:o}),o.type||(o.type=o.item?"select":"text");var i="",e="",n="";switch(o.default&&(n=o.defaultVal),o.label&&(e+="<label>"+o.label+"</label>"),o.id&&(i+=' id="'+o.id+'"'),o.class&&(i+=' class="'+o.class+'"'),o.required&&(i+=' required="required"'),o.placeholder&&(i+=' placeholder="'+o.placeholder+'"'),o.type){case"textarea":e+='<textarea name="'+t+'" '+i+">"+n+"</textarea>";break;case"select":var s="";$.each(o.item,function(t,o){t==n&&(t+='" selected="selected'),s+='<option value="'+t+'">'+o+"</option>"}),e+='<select name="'+t+'" '+i+">"+s+"<select>";break;case"radio":case"checkbox":e+="<div"+i+">",$.each(o.item,function(i,s){i==n&&(i+='" checked="checked'),e+='<input type="'+o.type+'" name="'+t+'" value="'+i+'">'+s}),e+="<div>";break;default:e+='<input type="'+o.type+'" name="'+t+'" '+i+' value="'+n+'">'}return'<div class="input-group">'+e+"</div>"},o.prototype._getFormElement=function(){var t={};return this.box.find("input,select,textarea,button").each(function(o,i){var e=$(i),n=e.attr("name");n&&(!e.is("[type=ridio]")&&!e.is("[type=checkbox]")&&n.indexOf("[]")<0?t[n]=e:t.hasOwnProperty(n)?t[n].push(i):t[n]=e)}),t},o.prototype._getFormData=function(){var t={};return $.each(this.elements,function(o,i){if(i.is("[type=ridio]"))i.each(function(i,e){var n=$(e);n.attr("checked")&&(t[o]=n.val())});else{if(i.is("[type=checkbox]")){var e=[];return i.each(function(t,o){var i=$(o);i.attr("checked")&&e.push(i.val())}),void(t[o]=e)}if(o.indexOf("[]")>0){var n=[];return i.each(function(t,o){var i=$(o);n.push(i.val())}),void(t[o]=n)}t[o]=i.val()}}),t},o}(DialogBox);Dialog.addMethod(DialogType.form,DialogForm);var DialogPage=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.getHeaderHtml=function(){var t='<div class="dialog-header"><i class="fa fa-arrow-left"></i><div class="dialog-title">';return this.options.ico&&(t+='<i class="fa fa-'+this.options.ico+'"></i>'),this.options.title&&(t+=this.options.title),t+'</div><i class="fa fa-close dialog-close"></i></div>'},o.prototype.bindEvent=function(){return this.box.click(function(t){t.stopPropagation()}),this.onClick(".dialog-header .fa-arrow-left",function(){this.close()}),this.onClick(".dialog-yes",function(){this.trigger("done")}),this.onClick(".dialog-close",function(){this.close()}),this},o}(DialogBox);Dialog.addMethod(DialogType.page,DialogPage);var DialogImage=function(t){function o(o,i){var e=t.call(this,o,i)||this;return e._index=0,e}return __extends(o,t),Object.defineProperty(o.prototype,"src",{get:function(){return this._src},set:function(t){t||(t=this.options.content),this._src=t,this._img.attr("style","").attr("src",t)},enumerable:!0,configurable:!0}),o.prototype.createContent=function(){return this.box.html(this.getContentHtml()),this._img=this.box.find(".dialog-body img"),this},o.prototype.setProperty=function(){var t=this.options.target||Dialog.$window,o=t.width(),i=this._img.width(),e=t.height(),n=this._img.height();if(i<=o&&n<=e)return this.css({left:(o-i)/2+"px",top:(e-n)/2+"px",height:n,width:i}),this;var s=i/o,a=n/e;return s>=a?(n/=s,this.css({left:0,top:(e-n)/2+"px",height:n,width:o}),this._img.css({height:n,width:o}),this):(i/=a,this.css({left:(o-i)/2+"px",top:0,height:e,width:i}),this._img.css({height:n,width:o}),this)},o.prototype.bindEvent=function(){this.box.click(function(t){t.stopPropagation()}),this.onClick(".dialog-close",function(){this.close()}),this.onClick(".dialog-previous",function(){this.previous()}),this.onClick(".dialog-next",function(){this.next()});var t=this;return $(window).resize(function(){t.box&&t.resize()}),this.box.find(".dialog-body img").bind("load",function(){t.box&&t.resize()}),this},o.prototype.resize=function(){this.setProperty(),this.trigger("resize")},o.prototype.previous=function(){this.src=this.trigger("previous",--this._index)},o.prototype.next=function(){this.src=this.trigger("next",++this._index)},o.prototype.getContentHtml=function(){return this.options.content||(this.options.content=this.trigger("next",++this._index)),'<i class="fa fa-chevron-left dialog-previous"></i><div class="dialog-body"><img src="'+this.options.content+'"></div><i class="fa fa-chevron-right dialog-next"></i><i class="fa fa-close dialog-close"></i>'},o}(DialogContent),DefaultDialogImageOption=function(){return function(){this.onnext=function(t){return $(document.body).find("img").eq(t).attr("src")},this.onprevious=function(t){return $(document.body).find("img").eq(t).attr("src")}}}();Dialog.addMethod(DialogType.image,DialogImage);var DialogDisk=function(t){function o(o,i){return t.call(this,o,i)||this}return __extends(o,t),o.prototype.bindEvent=function(){this.catalogBox=this.box.find(".dialog-body .dialog-catalog"),this.fileBox=this.box.find(".dialog-body .dialog-content");var o=this;return"object"==typeof this.options.catalog?this.showCatalog(this.options.catalog):$.getJSON(this.options.catalog,function(t){0==t.code&&o.showCatalog(t.data)}),"object"==typeof this.options.content?this.showFile(this.options.content):$.getJSON(this.options.content,function(t){0==t.code&&o.showFile(t.data)}),this.catalogBox.on("click",".tree-item",function(){var t=$(this);t.addClass("active").siblings().removeClass("active"),o.open(t.attr("data-url"))}),this.fileBox.on("click",".folder-item",function(){var t=$(this);t.addClass("active").siblings().removeClass("active"),o.open(t.attr("data-url"))}),this.fileBox.on("click",".file-item",function(){var t=$(this);t.addClass("active"),o.options.multiple||t.siblings().removeClass("active"),o.trigger("openFile",t.attr("data-url"),t)}),t.prototype.bindEvent.call(this)},o.prototype.getContentHtml=function(){return'<div class="dialog-body"><div class="dialog-catalog"></div><div class="dialog-content"></div></div>'},o.prototype.getDefaultOption=function(){return new DefaultDialogDiskOption},o.prototype.open=function(t){var o=this;t?CacheUrl.getData(t,function(t){o.showFile(t)}):console.log("url is empty")},o.prototype.val=function(){if(!this.options.multiple)return this.fileBox.find(".file-item.active").attr("data-url");var t=[];return this.mapSelectedFile(function(o){t.push(o)}),t},o.prototype.mapSelectedFile=function(t){return this.fileBox.find(".file-item.active").each(function(o,i){var e=$(i),n=e.attr("data-url");if(0==t.call(e,n,e,o))return!1}),this},o.prototype.map=function(t,o){void 0===o&&(o=!1);var i=".file-item";return o&&(i=".folder-item,"+i),this.fileBox.find(i).each(function(o,i){var e=$(i),n=e.attr("data-url");if(0==t.call(e,n,e,o))return!1}),this},o.prototype.showFile=function(t){var o=this,i="";$.each(t,function(t,e){e.type=Dialog.parseEnum(e.type,DialogDiskType),e.type!=DialogDiskType.file?i+=o._getFolderItem(e):i+=o._getFileItem(e)}),this.fileBox.html(i)},o.prototype._getFileItem=function(t){return'<div class="file-item" data-url="'+t[this.options.url]+'"><i class="fa fa-file-o"></i><div class="file-name">'+t[this.options.name]+"</div></div>"},o.prototype._getFolderItem=function(t){return'<div class="folder-item" data-url="'+t[this.options.url]+'"><i class="fa fa-folder-o"></i><div class="file-name">'+t[this.options.name]+"</div></div>"},o.prototype.showCatalog=function(t){var o=this,i="";$.each(t,function(t,e){i+=o._getCatalogItem(e)}),""!=i?this.catalogBox.html('<ul class="tree">'+i+"</ul>"):this.catalogBox.hide()},o.prototype._getCatalogItem=function(t){var o='<li class="tree-item" data-url="'+t[this.options.url]+'"><div class="tree-header">'+t[this.options.name]+"</div>";return t.hasOwnProperty(this.options.children)&&(o+=this._getCatalogChild(t[this.options.children])),o+"</li>"},o.prototype._getCatalogChild=function(t){var o=this,i="";return $.each(t,function(t,e){i+=o._getCatalogItem(e)}),'<ul class="tree-child">'+i+"</ul>"},o}(DialogBox),DefaultDialogDiskOption=function(t){function o(){var o=null!==t&&t.apply(this,arguments)||this;return o.name="name",o.title="文件管理",o.children="children",o.url="url",o.multiple=!1,o.onclosing=function(){return this.hide(),!1},o}return __extends(o,t),o}(DefaultDialogBoxOption);Dialog.addMethod(DialogType.disk,DialogDisk);