var TargetMode;
(function (TargetMode) {
    TargetMode[TargetMode["tab"] = 0] = "tab";
    TargetMode[TargetMode["self"] = 1] = "self";
    TargetMode[TargetMode["blank"] = 2] = "blank";
    TargetMode[TargetMode["window"] = 3] = "window";
})(TargetMode || (TargetMode = {}));
var NavbarDefaultOption = (function () {
    function NavbarDefaultOption() {
    }
    return NavbarDefaultOption;
}());
var NavItem = (function () {
    function NavItem(name, ico, url, children, target, id, image) {
        if (url === void 0) { url = 'javascript:;'; }
        if (target === void 0) { target = TargetMode.tab; }
        this.name = name;
        this.ico = ico;
        this.url = url;
        this.children = children;
        this.target = target;
        this.id = id;
        this.image = image;
    }
    NavItem.prototype.getChild = function (allId) {
        if (allId.length < 1) {
            return this;
        }
        if (!this.children) {
            throw new Error('error id: ' + allId[0]);
        }
        var id = allId.shift();
        if (!this.children.hasOwnProperty(id)) {
            throw new Error('error id: ' + id);
        }
        return this.children[id].getChild(allId);
    };
    NavItem.prototype.addItem = function (id, item) {
        this.removeItem(id);
        if (!this.children) {
            this.children = {};
        }
        this.children[id] = item;
        this._renderChild(id, item);
        return this;
    };
    NavItem.prototype.removeItem = function (id) {
        if (!this.children) {
            return this;
        }
        if (this.children.hasOwnProperty(id)) {
            this.children[id].remove();
            delete this.children[id];
        }
        return this;
    };
    NavItem.prototype.remove = function () {
        this.element.remove();
    };
    NavItem.prototype.addActive = function () {
        this.element.addClass("active").siblings().removeClass("active");
        return this;
    };
    NavItem.prototype.active = function (id) {
        this.addActive();
        if (!id || id.length == 0 || !this.children) {
            this.element.trigger('click');
            return this;
        }
        var k = typeof id == 'string' ? id : id.shift();
        if (!this.children.hasOwnProperty(k)) {
            throw new Error('error id: ' + k);
        }
        if (typeof id == 'string') {
            this.children[k].active();
            return this;
        }
        this.children[k].active(id);
        return this;
    };
    NavItem.prototype.render = function (id) {
        this.id = id;
        this.element = $('<li></li>');
        this.element.data(this);
        var html = '<a href="' + this.url + '">';
        if (this.ico) {
            html += '<i class="fa fa-' + this.ico + '"></i>';
        }
        if (this.image) {
            html += '<i class="fa image-icon" style="background-image: url(' + this.image + ')"></i>';
        }
        html += '<span>' + this.name + '</span></a>';
        this.element.append(html);
        this._renderChildren();
        return this.element;
    };
    NavItem.prototype._addUl = function () {
        if (this.ul) {
            return;
        }
        this.ul = $('<ul></ul>');
        this.element.append(this.ul);
    };
    NavItem.prototype._renderChildren = function () {
        if (!this.children) {
            return;
        }
        this._addUl();
        var k = this.id + '/';
        var instance = this;
        $.each(this.children, function (id, item) {
            instance.ul.append(item.render(k + id));
        });
    };
    NavItem.prototype._renderChild = function (id, item) {
        this._addUl();
        this.ul.append(item.render(this.id + '/' + id));
    };
    NavItem.prototype.clone = function () {
        var item = new NavItem(this.name, this.ico, this.url);
        item.id = this.id;
        return item;
    };
    NavItem.parse = function (data) {
        if (data instanceof NavItem) {
            return data;
        }
        var item = new NavItem(data['name']);
        if (data.hasOwnProperty('ico')) {
            item.ico = data['ico'];
        }
        if (data.hasOwnProperty('image')) {
            item.image = data['image'];
        }
        if (data.hasOwnProperty('target')) {
            item.target = typeof data['target'] == 'string' ? TargetMode[data['target']] : data['target'];
        }
        if (data.hasOwnProperty('url')) {
            item.url = data['url'];
        }
        if (data.hasOwnProperty('children')) {
            item.children = {};
            $.each(data['children'], function (id, child) {
                item.children[id] = NavItem.parse(child);
            });
        }
        return item;
    };
    return NavItem;
}());
var Tab = (function () {
    function Tab(element, option) {
        this.element = element;
        this.option = option;
        this._data = [];
        this._head = this.element.find(".zd-tab-head ul");
        this._body = this.element.find(".zd-tab-body");
        this._bindEvent();
    }
    Tab.prototype._bindEvent = function () {
        var instance = this;
        this._head.on("click", ".zd-tab-item", function () {
            instance.showItem($(this).index());
        });
        this._head.on("click", ".zd-tab-item .fa-close", function () {
            // 当所有标签页关闭时会出错，页面错乱
            instance.removeItem($(this).parent().index());
        });
    };
    Tab.prototype.setProperty = function () {
        var items = this._head.find('.zd-tab-item');
        var width = items.width();
        this._head.width(items.length * width);
    };
    Tab.prototype.addItem = function (item) {
        if (this.hasItem(item)) {
            this.showItem(item);
            return;
        }
        this._head.append('<li class="zd-tab-item"><span>' + item.name + '</span><i class="fa fa-close"></i></li>');
        this._body.append('<iframe class="zd-tab-item" height="100%" src="' + item.url + '"></iframe>');
        this._data.push(item.clone());
        this.showItem(this._data.length - 1);
        this.setProperty();
    };
    Tab.prototype.hasItem = function (item) {
        if (typeof item != 'string') {
            item = item.id;
        }
        return this._getIndexById(item) >= 0;
    };
    Tab.prototype.removeItem = function (index) {
        if (this._data.length < 2) {
            return;
        }
        if (typeof index == 'string') {
            index = this._getIndexById(index);
        }
        if (index < 0 || index >= this._data.length) {
            return;
        }
        var item = this._head.find('.zd-tab-item').eq(index);
        if (item.hasClass("active")) {
            this.showItem(index - 1);
        }
        item.remove();
        this._body.find('.zd-tab-item').eq(index).remove();
        this._data.splice(index, 1);
    };
    Tab.prototype.showItem = function (index) {
        if (this._data.length < 1) {
            return;
        }
        if (typeof index == 'string') {
            index = this._getIndexById(index);
        }
        else if (typeof index == 'object') {
            index = this._getIndexById(index.id);
        }
        if (index < 0) {
            index = 0;
        }
        if (index >= this._data.length) {
            index = this._data.length - 1;
        }
        this._head.find('.zd-tab-item').eq(index).addClass("active").siblings().removeClass("active");
        this._body.find('.zd-tab-item').eq(index).addClass("active").siblings().removeClass("active");
        if (this.option.active) {
            this.option.active(this._data[index]);
        }
        this._setHistory(this._data[index]);
    };
    Tab.prototype._getIndexById = function (id) {
        for (var i = this._data.length - 1; i >= 0; i--) {
            if (this._data[i].id == id) {
                return i;
            }
        }
        return -1;
    };
    Tab.prototype._setHistory = function (item) {
        var url = window.location.href.split('#')[0] + '#' + item.id;
        history.pushState(item, item.name, url);
    };
    return Tab;
}());
var Navbar = (function () {
    function Navbar(element, option) {
        this.element = element;
        this.option = $.extend({}, new NavbarDefaultOption(), option);
        this.tab = $(this.option.tab).tab({
            active: function (item) {
                //console.log(item);
            }
        });
        this._bottom = this.element.find('.nav-bottom');
        this._top = this.element.find('.nav-top');
        this.refresh();
        this._bindEvent();
        // 刷新浏览器时跳转
        var url = window.location.href.split('#');
        if (url.length > 1) {
            this.open(url[1]);
        }
        else if (this.option.default) {
            this.open(this.option.default);
        }
    }
    /**
     * 绑定事件
     */
    Navbar.prototype._bindEvent = function () {
        var instance = this;
        this.element.on("click", 'li a', function (e) {
            e.preventDefault();
        });
        this.element.on("click", 'li', function () {
            var item = $(this).data();
            instance.openItem(item);
        });
        $(window).bind('popstate', function (e) {
            // 浏览器返回跳转
            var item = e.originalEvent.state;
            instance.tab.showItem(item);
        });
        $(window).resize(function () {
            instance._setProperty();
            instance.tab.setProperty();
        });
    };
    Navbar.prototype._setProperty = function () {
        this._top.height($(window).height() - this._top.offset().top - this._bottom.height());
    };
    Navbar.prototype.open = function (path, isTop) {
        if (isTop === void 0) { isTop = true; }
        _a = this._pathToId(path, isTop), isTop = _a[0], path = _a[1];
        var id = path.shift();
        if (this.option.data.hasOwnProperty(id)) {
            this.option.data[id].active(path);
            return;
        }
        if (this.option.bottom.hasOwnProperty(id)) {
            this.option.bottom[id].active(path);
            return;
        }
        throw new Error('error id: ' + id);
        var _a;
    };
    Navbar.prototype.openItem = function (item) {
        item.addActive();
        if (item.url.indexOf('#') >= 0 || item.url.indexOf('javascript:') >= 0) {
            return;
        }
        switch (item.target) {
            case TargetMode.tab:
                this.tab.addItem(item);
                break;
            case TargetMode.blank:
                window.open(item.url, '_blank');
                break;
            case TargetMode.self:
                window.location.href = item.url;
                break;
            case TargetMode.window:
                window.open(item.url);
                break;
            default:
                break;
        }
    };
    Navbar.prototype.refresh = function () {
        this._addItem(this._top, this.option.data);
        if (!this.option.bottom) {
            this._setProperty();
            return;
        }
        this._addItem(this._bottom, this.option.bottom);
        this._setProperty();
    };
    // 动态添加
    Navbar.prototype.addItem = function (path, item) {
        var _a = this._pathToId(path), isTop = _a[0], allId = _a[1];
        var id = allId.pop();
        if (allId.length > 0) {
            this.getItem(allId).addItem(id, NavItem.parse(item));
            return;
        }
        this.removeItem([id], isTop);
        var data = {};
        data[id] = item;
        if (isTop) {
            this.option.data[id] = item;
            this._addItem(this._top, data);
            return;
        }
        this.option.data[id] = item;
        this._addItem(this._bottom, data);
        return;
    };
    Navbar.prototype.removeItem = function (path, isTop) {
        if (isTop === void 0) { isTop = true; }
        _a = this._pathToId(path, isTop), isTop = _a[0], path = _a[1];
        var id = path.pop();
        if (path.length > 0) {
            this.getItem(path).removeItem(id);
            return this;
        }
        if (isTop && this.option.data.hasOwnProperty(id)) {
            this.option.data[id].remove();
            delete this.option.data[id];
            return this;
        }
        if (this.option.bottom.hasOwnProperty(id)) {
            this.option.bottom[id].remove();
            delete this.option.bottom[id];
            return this;
        }
        return this;
        var _a;
    };
    /**
     *
     * @param path
     * @param isTop
     */
    Navbar.prototype.getItem = function (path, isTop) {
        if (isTop === void 0) { isTop = true; }
        _a = this._pathToId(path, isTop), isTop = _a[0], path = _a[1];
        var id = path.shift();
        if (isTop && this.option.data.hasOwnProperty(id)) {
            return this.option.data[id].getChild(path);
        }
        if (this.option.bottom.hasOwnProperty(id)) {
            return this.option.bottom[id].getChild(path);
        }
        throw new Error('error id: ' + id);
        var _a;
    };
    /**
     * 路径转换成Id
     * @param path
     */
    Navbar.prototype._pathToId = function (path, isTop) {
        if (isTop === void 0) { isTop = true; }
        if (typeof path != 'string') {
            return [isTop, path];
        }
        if (!isTop) {
            return [isTop, [path]];
        }
        var paths = path.split(':');
        if (paths.length > 1 && paths[0] == 'bottom') {
            isTop = false;
            path = paths[1];
        }
        paths = path.split('/');
        var allId = [];
        paths.forEach(function (id) {
            if (id == '') {
                return;
            }
            allId.push(id);
        });
        return [isTop, allId];
    };
    Navbar.prototype._addItem = function (element, data) {
        $.each(data, function (id, item) {
            item = NavItem.parse(item);
            element.append(item.render(id));
            data[id] = item;
        });
    };
    return Navbar;
}());
;
(function ($) {
    $.fn.tab = function (option) {
        return new Tab(this, option);
    };
    $.fn.navbar = function (option) {
        return new Navbar(this, option);
    };
})(jQuery);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm9wdGlvbi50cyIsIm5hdkl0ZW0udHMiLCJ0YWIudHMiLCJqcXVlcnkubmF2YmFyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLElBQUEsVUFLQTtBQUxBLFdBQUEsVUFBQTtJQUNBLHlDQUFBLENBQUE7SUFDQSwyQ0FBQSxDQUFBO0lBQ0EsNkNBQUEsQ0FBQTtJQUNBLCtDQUFBLENBQUE7QUFDQSxDQUFBLEVBTEEsVUFBQSxLQUFBLFVBQUEsUUFLQTtBQVNBO0lBQUE7SUFFQSxDQUFBO0lBQUEsMEJBQUE7QUFBQSxDQUZBLEFBRUEsSUFBQTtBQ2hCQTtJQUNBLGlCQUNBLElBQUEsRUFDQSxHQUFBLEVBQ0EsR0FBQSxFQUNBLFFBQUEsRUFDQSxNQUFBLEVBQ0EsRUFBQSxFQUNBLEtBQUE7UUFKQSxvQkFBQSxFQUFBLG9CQUFBO1FBRUEsdUJBQUEsRUFBQSxTQUFBLFVBQUEsQ0FBQSxHQUFBO1FBSkEsU0FBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLFFBQUEsR0FBQSxHQUFBLENBQUE7UUFDQSxRQUFBLEdBQUEsR0FBQSxDQUFBO1FBQ0EsYUFBQSxHQUFBLFFBQUEsQ0FBQTtRQUNBLFdBQUEsR0FBQSxNQUFBLENBQUE7UUFDQSxPQUFBLEdBQUEsRUFBQSxDQUFBO1FBQ0EsVUFBQSxHQUFBLEtBQUEsQ0FBQTtJQUdBLENBQUE7SUFNQSwwQkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsSUFBQSxLQUFBLENBQUEsWUFBQSxHQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsRUFBQSxHQUFBLEtBQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxjQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxJQUFBLEtBQUEsQ0FBQSxZQUFBLEdBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsUUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHlCQUFBLEdBQUEsVUFBQSxFQUFBLEVBQUEsSUFBQTtRQUNBLElBQUEsQ0FBQSxVQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLFFBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFFBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsWUFBQSxDQUFBLEVBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsNEJBQUEsR0FBQSxVQUFBLEVBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLGNBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsUUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLE1BQUEsRUFBQSxDQUFBO1lBQ0EsT0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsd0JBQUEsR0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxFQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsMkJBQUEsR0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLFFBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsd0JBQUEsR0FBQSxVQUFBLEVBQUE7UUFDQSxJQUFBLENBQUEsU0FBQSxFQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUEsSUFBQSxFQUFBLENBQUEsTUFBQSxJQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLENBQUEsT0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLE9BQUEsRUFBQSxJQUFBLFFBQUEsR0FBQSxFQUFBLEdBQUEsRUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLGNBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLElBQUEsS0FBQSxDQUFBLFlBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLEVBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHdCQUFBLEdBQUEsVUFBQSxFQUFBO1FBQ0EsSUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxJQUFBLEdBQUEsV0FBQSxHQUFBLElBQUEsQ0FBQSxHQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLElBQUEsa0JBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxHQUFBLFFBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsSUFBQSx3REFBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLEdBQUEsU0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsSUFBQSxRQUFBLEdBQUEsSUFBQSxDQUFBLElBQUEsR0FBQSxhQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxlQUFBLEVBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUdBLHdCQUFBLEdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsRUFBQSxHQUFBLENBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxpQ0FBQSxHQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsTUFBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxJQUFBLENBQUEsRUFBQSxHQUFBLEdBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsRUFBQSxVQUFBLEVBQUEsRUFBQSxJQUFBO1lBQ0EsUUFBQSxDQUFBLEVBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLEdBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDhCQUFBLEdBQUEsVUFBQSxFQUFBLEVBQUEsSUFBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxFQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsR0FBQSxHQUFBLEdBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx1QkFBQSxHQUFBO1FBQ0EsSUFBQSxJQUFBLEdBQUEsSUFBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxJQUFBLENBQUEsR0FBQSxFQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxFQUFBLEdBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsYUFBQSxHQUFBLFVBQUEsSUFBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsWUFBQSxPQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxJQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLEdBQUEsR0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsS0FBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsY0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxNQUFBLEdBQUEsT0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsUUFBQSxHQUFBLFVBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsR0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsR0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsY0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxRQUFBLEdBQUEsRUFBQSxDQUFBO1lBQ0EsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLEVBQUEsVUFBQSxFQUFBLEVBQUEsS0FBQTtnQkFDQSxJQUFBLENBQUEsUUFBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLE9BQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUNBLGNBQUE7QUFBQSxDQXpKQSxBQXlKQSxJQUFBO0FDekpBO0lBQ0EsYUFDQSxPQUFBLEVBQ0EsTUFBQTtRQURBLFlBQUEsR0FBQSxPQUFBLENBQUE7UUFDQSxXQUFBLEdBQUEsTUFBQSxDQUFBO1FBT0EsVUFBQSxHQUFBLEVBQUEsQ0FBQTtRQUxBLElBQUEsQ0FBQSxLQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsaUJBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsR0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxVQUFBLEVBQUEsQ0FBQTtJQUNBLENBQUE7SUFRQSx3QkFBQSxHQUFBO1FBQ0EsSUFBQSxRQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFBLENBQUEsT0FBQSxFQUFBLGNBQUEsRUFBQTtZQUNBLFFBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEtBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsRUFBQSxDQUFBLE9BQUEsRUFBQSx3QkFBQSxFQUFBO1lBQ0Esb0JBQUE7WUFDQSxRQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEseUJBQUEsR0FBQTtRQUNBLElBQUEsS0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxLQUFBLEdBQUEsS0FBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsR0FBQSxLQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxxQkFBQSxHQUFBLFVBQUEsSUFBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsQ0FBQSxnQ0FBQSxHQUFBLElBQUEsQ0FBQSxJQUFBLEdBQUEseUNBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsaURBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxHQUFBLGFBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFdBQUEsRUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHFCQUFBLEdBQUEsVUFBQSxJQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxJQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsR0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsYUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx3QkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxLQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLEtBQUEsR0FBQSxJQUFBLENBQUEsYUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsR0FBQSxDQUFBLElBQUEsS0FBQSxJQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxRQUFBLENBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxzQkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxLQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLEtBQUEsR0FBQSxJQUFBLENBQUEsYUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxPQUFBLEtBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsS0FBQSxHQUFBLElBQUEsQ0FBQSxhQUFBLENBQUEsS0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsS0FBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsS0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLFFBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsUUFBQSxFQUFBLENBQUEsV0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxXQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDJCQUFBLEdBQUEsVUFBQSxFQUFBO1FBQ0EsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHlCQUFBLEdBQUEsVUFBQSxJQUFBO1FBQ0EsSUFBQSxHQUFBLEdBQUEsTUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxHQUFBLEdBQUEsR0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBO1FBQ0EsT0FBQSxDQUFBLFNBQUEsQ0FBQSxJQUFBLEVBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxHQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFDQSxVQUFBO0FBQUEsQ0EzR0EsQUEyR0EsSUFBQTtBQzNHQTtJQUNBLGdCQUNBLE9BQUEsRUFDQSxNQUFBO1FBREEsWUFBQSxHQUFBLE9BQUEsQ0FBQTtRQUdBLElBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLEVBQUEsSUFBQSxtQkFBQSxFQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxHQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQTtZQUNBLE1BQUEsRUFBQSxVQUFBLElBQUE7Z0JBQ0Esb0JBQUE7WUFDQSxDQUFBO1NBQ0EsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsR0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxhQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxJQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsVUFBQSxFQUFBLENBQUE7UUFDQSxXQUFBO1FBQ0EsSUFBQSxHQUFBLEdBQUEsTUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsR0FBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFBQSxJQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtJQUNBLENBQUE7SUFTQTs7T0FFQTtJQUNBLDJCQUFBLEdBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLEVBQUEsQ0FBQSxPQUFBLEVBQUEsTUFBQSxFQUFBLFVBQUEsQ0FBQTtZQUNBLENBQUEsQ0FBQSxjQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxFQUFBLENBQUEsT0FBQSxFQUFBLElBQUEsRUFBQTtZQUNBLElBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxFQUFBLFVBQUEsQ0FBQTtZQUNBLFVBQUE7WUFDQSxJQUFBLElBQUEsR0FBQSxDQUFBLENBQUEsYUFBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxHQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsTUFBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLFlBQUEsRUFBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLEdBQUEsQ0FBQSxXQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDZCQUFBLEdBQUE7UUFDQSxJQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsTUFBQSxFQUFBLEdBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHFCQUFBLEdBQUEsVUFBQSxJQUFBLEVBQUEsS0FBQTtRQUFBLHNCQUFBLEVBQUEsWUFBQTtRQUNBLGdDQUFBLEVBQUEsYUFBQSxFQUFBLFlBQUEsQ0FBQTtRQUNBLElBQUEsRUFBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsY0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxNQUFBLENBQUEsTUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLElBQUEsS0FBQSxDQUFBLFlBQUEsR0FBQSxFQUFBLENBQUEsQ0FBQTs7SUFDQSxDQUFBO0lBRUEseUJBQUEsR0FBQSxVQUFBLElBQUE7UUFDQSxJQUFBLENBQUEsU0FBQSxFQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLE9BQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxPQUFBLENBQUEsYUFBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLEtBQUEsVUFBQSxDQUFBLEdBQUE7Z0JBQ0EsSUFBQSxDQUFBLEdBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7Z0JBQ0EsS0FBQSxDQUFBO1lBQ0EsS0FBQSxVQUFBLENBQUEsS0FBQTtnQkFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxHQUFBLEVBQUEsUUFBQSxDQUFBLENBQUE7Z0JBQ0EsS0FBQSxDQUFBO1lBQ0EsS0FBQSxVQUFBLENBQUEsSUFBQTtnQkFDQSxNQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBO2dCQUNBLEtBQUEsQ0FBQTtZQUNBLEtBQUEsVUFBQSxDQUFBLE1BQUE7Z0JBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7Z0JBQ0EsS0FBQSxDQUFBO1lBQ0E7Z0JBQ0EsS0FBQSxDQUFBO1FBQ0EsQ0FBQTtJQUNBLENBQUE7SUFFQSx3QkFBQSxHQUFBO1FBQ0EsSUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxFQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxZQUFBLEVBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsUUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLEVBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxZQUFBLEVBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxPQUFBO0lBQ0Esd0JBQUEsR0FBQSxVQUFBLElBQUEsRUFBQSxJQUFBO1FBQ0EsSUFBQSx5QkFBQSxFQUFBLGFBQUEsRUFBQSxhQUFBLENBQUE7UUFDQSxJQUFBLEVBQUEsR0FBQSxLQUFBLENBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxFQUFBLEVBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxLQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLEdBQUEsSUFBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxFQUFBLElBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsRUFBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSwyQkFBQSxHQUFBLFVBQUEsSUFBQSxFQUFBLEtBQUE7UUFBQSxzQkFBQSxFQUFBLFlBQUE7UUFDQSxnQ0FBQSxFQUFBLGFBQUEsRUFBQSxZQUFBLENBQUE7UUFDQSxJQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLFVBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxJQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLGNBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtZQUNBLE9BQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsTUFBQSxDQUFBLGNBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsTUFBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtZQUNBLE9BQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7O0lBQ0EsQ0FBQTtJQUVBOzs7O09BSUE7SUFDQSx3QkFBQSxHQUFBLFVBQUEsSUFBQSxFQUFBLEtBQUE7UUFBQSxzQkFBQSxFQUFBLFlBQUE7UUFDQSxnQ0FBQSxFQUFBLGFBQUEsRUFBQSxZQUFBLENBQUE7UUFDQSxJQUFBLEVBQUEsR0FBQSxJQUFBLENBQUEsS0FBQSxFQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsY0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsY0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxJQUFBLEtBQUEsQ0FBQSxZQUFBLEdBQUEsRUFBQSxDQUFBLENBQUE7O0lBQ0EsQ0FBQTtJQUVBOzs7T0FHQTtJQUNBLDBCQUFBLEdBQUEsVUFBQSxJQUFBLEVBQUEsS0FBQTtRQUFBLHNCQUFBLEVBQUEsWUFBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLE9BQUEsSUFBQSxJQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsQ0FBQSxLQUFBLEVBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLENBQUEsS0FBQSxFQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLElBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxLQUFBLEdBQUEsS0FBQSxDQUFBO1lBQ0EsSUFBQSxHQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxLQUFBLEdBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsS0FBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxPQUFBLENBQUEsVUFBQSxFQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsRUFBQSxJQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLEtBQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxDQUFBLEtBQUEsRUFBQSxLQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx5QkFBQSxHQUFBLFVBQUEsT0FBQSxFQUFBLElBQUE7UUFDQSxDQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxVQUFBLEVBQUEsRUFBQSxJQUFBO1lBQ0EsSUFBQSxHQUFBLE9BQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7WUFDQSxPQUFBLENBQUEsTUFBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFDQSxhQUFBO0FBQUEsQ0FyTUEsQUFxTUEsSUFBQTtBQUVBLENBQUE7QUFBQSxDQUFBLFVBQUEsQ0FBQTtJQUNBLENBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxHQUFBLFVBQUEsTUFBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLEdBQUEsQ0FBQSxJQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBLENBQUE7SUFDQSxDQUFBLENBQUEsRUFBQSxDQUFBLE1BQUEsR0FBQSxVQUFBLE1BQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxNQUFBLENBQUEsSUFBQSxFQUFBLE1BQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQSxDQUFBO0FBQ0EsQ0FBQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUEiLCJmaWxlIjoianF1ZXJ5Lm5hdmJhci5qcyIsInNvdXJjZXNDb250ZW50IjpbImVudW0gVGFyZ2V0TW9kZSB7XHJcbiAgICB0YWIsXHJcbiAgICBzZWxmLFxyXG4gICAgYmxhbmssXHJcbiAgICB3aW5kb3dcclxufVxyXG5cclxuaW50ZXJmYWNlIE5hdmJhck9wdGlvbiB7XHJcbiAgICBkYXRhPzoge1tpZDogc3RyaW5nXTogYW55fTtcclxuICAgIGJvdHRvbT86IHtbaWQ6IHN0cmluZ106IGFueX07XHJcbiAgICB0YWI/OiBKUXVlcnksXHJcbiAgICBkZWZhdWx0Pzogc3RyaW5nLFxyXG59XHJcblxyXG5jbGFzcyBOYXZiYXJEZWZhdWx0T3B0aW9uIGltcGxlbWVudHMgTmF2YmFyT3B0aW9uIHtcclxuICAgIFxyXG59XHJcblxyXG5pbnRlcmZhY2UgVGFiT3B0aW9uIHtcclxuICAgIGFjdGl2ZTogKE5hdkl0ZW0pPT52b2lkXHJcbn0iLCJjbGFzcyBOYXZJdGVtIHtcclxuICAgIGNvbnN0cnVjdG9yKFxyXG4gICAgICAgIHB1YmxpYyBuYW1lOiBzdHJpbmcsXHJcbiAgICAgICAgcHVibGljIGljbz86IHN0cmluZyxcclxuICAgICAgICBwdWJsaWMgdXJsOiBzdHJpbmcgPSAnamF2YXNjcmlwdDo7JyxcclxuICAgICAgICBwdWJsaWMgY2hpbGRyZW4/OiB7W2lkOiBzdHJpbmddOiBOYXZJdGVtfSxcclxuICAgICAgICBwdWJsaWMgdGFyZ2V0OiBUYXJnZXRNb2RlID0gVGFyZ2V0TW9kZS50YWIsXHJcbiAgICAgICAgcHVibGljIGlkPzogc3RyaW5nLFxyXG4gICAgICAgIHB1YmxpYyBpbWFnZT86IHN0cmluZyxcclxuICAgICkge1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZWxlbWVudDogSlF1ZXJ5O1xyXG5cclxuICAgIHB1YmxpYyB1bDogSlF1ZXJ5O1xyXG5cclxuICAgIHB1YmxpYyBnZXRDaGlsZChhbGxJZDogc3RyaW5nW10pOiBOYXZJdGVtIHtcclxuICAgICAgICBpZiAoYWxsSWQubGVuZ3RoIDwgMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLmNoaWxkcmVuKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3IgaWQ6ICcrIGFsbElkWzBdKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGlkID0gYWxsSWQuc2hpZnQoKTtcclxuICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW4uaGFzT3duUHJvcGVydHkoaWQpKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3IgaWQ6ICcrIGlkKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW5baWRdLmdldENoaWxkKGFsbElkKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYWRkSXRlbShpZDogc3RyaW5nLCBpdGVtOiBOYXZJdGVtKTogdGhpcyB7XHJcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKGlkKTtcclxuICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgdGhpcy5jaGlsZHJlbiA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmNoaWxkcmVuW2lkXSA9IGl0ZW07XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyQ2hpbGQoaWQsIGl0ZW0pO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW1vdmVJdGVtKGlkOiBzdHJpbmcpOiB0aGlzIHtcclxuICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0aGlzLmNoaWxkcmVuLmhhc093blByb3BlcnR5KGlkKSkge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuW2lkXS5yZW1vdmUoKTtcclxuICAgICAgICAgICAgZGVsZXRlIHRoaXMuY2hpbGRyZW5baWRdO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVtb3ZlKCkge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5yZW1vdmUoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgYWRkQWN0aXZlKCk6IHRoaXMge1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBhY3RpdmUoaWQ/OiBzdHJpbmdbXSB8IHN0cmluZyk6IHRoaXMge1xyXG4gICAgICAgIHRoaXMuYWRkQWN0aXZlKCk7XHJcbiAgICAgICAgaWYgKCFpZCB8fCBpZC5sZW5ndGggPT0gMCB8fCAhdGhpcy5jaGlsZHJlbikge1xyXG4gICAgICAgICAgICB0aGlzLmVsZW1lbnQudHJpZ2dlcignY2xpY2snKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBrID0gdHlwZW9mIGlkID09ICdzdHJpbmcnID8gaWQgOiBpZC5zaGlmdCgpO1xyXG4gICAgICAgIGlmICghdGhpcy5jaGlsZHJlbi5oYXNPd25Qcm9wZXJ0eShrKSkge1xyXG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2Vycm9yIGlkOiAnKyBrKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHR5cGVvZiBpZCA9PSAnc3RyaW5nJykge1xyXG4gICAgICAgICAgICB0aGlzLmNoaWxkcmVuW2tdLmFjdGl2ZSgpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5jaGlsZHJlbltrXS5hY3RpdmUoaWQpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZW5kZXIoaWQ6IHN0cmluZyk6IEpRdWVyeSB7XHJcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudCA9ICQoJzxsaT48L2xpPicpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5kYXRhKHRoaXMpO1xyXG4gICAgICAgIGxldCBodG1sID0gJzxhIGhyZWY9XCInICsgdGhpcy51cmwgKyAnXCI+JztcclxuICAgICAgICBpZiAodGhpcy5pY28pIHtcclxuICAgICAgICAgICAgaHRtbCArPSAnPGkgY2xhc3M9XCJmYSBmYS0nK3RoaXMuaWNvKydcIj48L2k+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMuaW1hZ2UpIHtcclxuICAgICAgICAgICAgaHRtbCArPSAnPGkgY2xhc3M9XCJmYSBpbWFnZS1pY29uXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWltYWdlOiB1cmwoJysgdGhpcy5pbWFnZSArJylcIj48L2k+JztcclxuICAgICAgICB9XHJcbiAgICAgICAgaHRtbCArPSAnPHNwYW4+Jyt0aGlzLm5hbWUrJzwvc3Bhbj48L2E+JztcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kKGh0bWwpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckNoaWxkcmVuKCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudDtcclxuICAgIH1cclxuXHJcblxyXG4gICAgcHJpdmF0ZSBfYWRkVWwoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMudWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnVsID0gJCgnPHVsPjwvdWw+Jyk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmFwcGVuZCh0aGlzLnVsKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9yZW5kZXJDaGlsZHJlbigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuY2hpbGRyZW4pIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9hZGRVbCgpO1xyXG4gICAgICAgIGxldCBrID0gdGhpcy5pZCArICcvJztcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgICQuZWFjaCh0aGlzLmNoaWxkcmVuLCBmdW5jdGlvbihpZDogc3RyaW5nLCBpdGVtOiBOYXZJdGVtKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnVsLmFwcGVuZChpdGVtLnJlbmRlcihrICsgaWQpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9yZW5kZXJDaGlsZChpZDogc3RyaW5nLCBpdGVtOiBOYXZJdGVtKSB7XHJcbiAgICAgICAgdGhpcy5fYWRkVWwoKTtcclxuICAgICAgICB0aGlzLnVsLmFwcGVuZChpdGVtLnJlbmRlcih0aGlzLmlkICsgJy8nICsgaWQpKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xvbmUoKTogTmF2SXRlbSB7XHJcbiAgICAgICAgbGV0IGl0ZW0gPSBuZXcgTmF2SXRlbSh0aGlzLm5hbWUsIHRoaXMuaWNvLCB0aGlzLnVybCk7XHJcbiAgICAgICAgaXRlbS5pZCA9IHRoaXMuaWQ7XHJcbiAgICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBwYXJzZShkYXRhOiBPYmplY3QpOiBOYXZJdGVtIHtcclxuICAgICAgICBpZiAoZGF0YSBpbnN0YW5jZW9mIE5hdkl0ZW0pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpdGVtID0gbmV3IE5hdkl0ZW0oZGF0YVsnbmFtZSddKTtcclxuICAgICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eSgnaWNvJykpIHtcclxuICAgICAgICAgICAgaXRlbS5pY28gPSBkYXRhWydpY28nXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGRhdGEuaGFzT3duUHJvcGVydHkoJ2ltYWdlJykpIHtcclxuICAgICAgICAgICAgaXRlbS5pbWFnZSA9IGRhdGFbJ2ltYWdlJ107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KCd0YXJnZXQnKSkge1xyXG4gICAgICAgICAgICBpdGVtLnRhcmdldCA9IHR5cGVvZiBkYXRhWyd0YXJnZXQnXSA9PSAnc3RyaW5nJyA/IFRhcmdldE1vZGVbZGF0YVsndGFyZ2V0J11dIDogZGF0YVsndGFyZ2V0J107XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChkYXRhLmhhc093blByb3BlcnR5KCd1cmwnKSkge1xyXG4gICAgICAgICAgICBpdGVtLnVybCA9IGRhdGFbJ3VybCddO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoZGF0YS5oYXNPd25Qcm9wZXJ0eSgnY2hpbGRyZW4nKSkge1xyXG4gICAgICAgICAgICBpdGVtLmNoaWxkcmVuID0ge307XHJcbiAgICAgICAgICAgICQuZWFjaChkYXRhWydjaGlsZHJlbiddLCBmdW5jdGlvbihpZDogc3RyaW5nLCBjaGlsZDogT2JqZWN0KSB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLmNoaWxkcmVuW2lkXSA9IE5hdkl0ZW0ucGFyc2UoY2hpbGQpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGl0ZW07XHJcbiAgICB9XHJcbn0iLCJjbGFzcyBUYWIge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsZW1lbnQ6IEpRdWVyeSxcclxuICAgICAgICBwdWJsaWMgb3B0aW9uOiBUYWJPcHRpb25cclxuICAgICkge1xyXG4gICAgICAgIHRoaXMuX2hlYWQgPSB0aGlzLmVsZW1lbnQuZmluZChcIi56ZC10YWItaGVhZCB1bFwiKTtcclxuICAgICAgICB0aGlzLl9ib2R5ID0gdGhpcy5lbGVtZW50LmZpbmQoXCIuemQtdGFiLWJvZHlcIik7XHJcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZGF0YTogQXJyYXk8TmF2SXRlbT4gPSBbXTtcclxuXHJcbiAgICBwcml2YXRlIF9oZWFkOiBKUXVlcnk7XHJcblxyXG4gICAgcHJpdmF0ZSBfYm9keTogSlF1ZXJ5O1xyXG5cclxuICAgIHByaXZhdGUgX2JpbmRFdmVudCgpIHtcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2hlYWQub24oXCJjbGlja1wiLCBcIi56ZC10YWItaXRlbVwiLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2Uuc2hvd0l0ZW0oJCh0aGlzKS5pbmRleCgpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9oZWFkLm9uKFwiY2xpY2tcIiwgXCIuemQtdGFiLWl0ZW0gLmZhLWNsb3NlXCIsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAvLyDlvZPmiYDmnInmoIfnrb7pobXlhbPpl63ml7bkvJrlh7rplJnvvIzpobXpnaLplJnkubFcclxuICAgICAgICAgICAgaW5zdGFuY2UucmVtb3ZlSXRlbSgkKHRoaXMpLnBhcmVudCgpLmluZGV4KCkpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXRQcm9wZXJ0eSgpIHtcclxuICAgICAgICBsZXQgaXRlbXMgPSB0aGlzLl9oZWFkLmZpbmQoJy56ZC10YWItaXRlbScpO1xyXG4gICAgICAgIGxldCB3aWR0aCA9IGl0ZW1zLndpZHRoKCk7XHJcbiAgICAgICAgdGhpcy5faGVhZC53aWR0aChpdGVtcy5sZW5ndGggKiB3aWR0aCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGFkZEl0ZW0oaXRlbTogTmF2SXRlbSkge1xyXG4gICAgICAgIGlmICh0aGlzLmhhc0l0ZW0oaXRlbSkpIHtcclxuICAgICAgICAgICAgdGhpcy5zaG93SXRlbShpdGVtKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9oZWFkLmFwcGVuZCgnPGxpIGNsYXNzPVwiemQtdGFiLWl0ZW1cIj48c3Bhbj4nICsgaXRlbS5uYW1lICsgJzwvc3Bhbj48aSBjbGFzcz1cImZhIGZhLWNsb3NlXCI+PC9pPjwvbGk+Jyk7XHJcbiAgICAgICAgdGhpcy5fYm9keS5hcHBlbmQoJzxpZnJhbWUgY2xhc3M9XCJ6ZC10YWItaXRlbVwiIGhlaWdodD1cIjEwMCVcIiBzcmM9XCInICsgaXRlbS51cmwgKyAnXCI+PC9pZnJhbWU+Jyk7XHJcbiAgICAgICAgdGhpcy5fZGF0YS5wdXNoKGl0ZW0uY2xvbmUoKSk7XHJcbiAgICAgICAgdGhpcy5zaG93SXRlbSh0aGlzLl9kYXRhLmxlbmd0aCAtIDEpO1xyXG4gICAgICAgIHRoaXMuc2V0UHJvcGVydHkoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaGFzSXRlbShpdGVtOiBOYXZJdGVtfCBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICBpZiAodHlwZW9mIGl0ZW0gIT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgaXRlbSA9IGl0ZW0uaWQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9nZXRJbmRleEJ5SWQoaXRlbSkgPj0gMDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcmVtb3ZlSXRlbShpbmRleDogbnVtYmVyIHwgc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RhdGEubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmICh0eXBlb2YgaW5kZXggPT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgaW5kZXggPSB0aGlzLl9nZXRJbmRleEJ5SWQoaW5kZXgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaW5kZXggPCAwIHx8IGluZGV4ID49IHRoaXMuX2RhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGl0ZW0gPSB0aGlzLl9oZWFkLmZpbmQoJy56ZC10YWItaXRlbScpLmVxKGluZGV4KTtcclxuICAgICAgICBpZiAoaXRlbS5oYXNDbGFzcyhcImFjdGl2ZVwiKSkge1xyXG4gICAgICAgICAgICB0aGlzLnNob3dJdGVtKGluZGV4IC0gMSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGl0ZW0ucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fYm9keS5maW5kKCcuemQtdGFiLWl0ZW0nKS5lcShpbmRleCkucmVtb3ZlKCk7XHJcbiAgICAgICAgdGhpcy5fZGF0YS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzaG93SXRlbShpbmRleDogbnVtYmVyIHwgc3RyaW5nIHwgTmF2SXRlbSkge1xyXG4gICAgICAgIGlmICh0aGlzLl9kYXRhLmxlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodHlwZW9mIGluZGV4ID09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gdGhpcy5fZ2V0SW5kZXhCeUlkKGluZGV4KTtcclxuICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBpbmRleCA9PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICBpbmRleCA9IHRoaXMuX2dldEluZGV4QnlJZChpbmRleC5pZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcclxuICAgICAgICAgICAgaW5kZXggPSAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoaW5kZXggPj0gdGhpcy5fZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaW5kZXggPSB0aGlzLl9kYXRhLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2hlYWQuZmluZCgnLnpkLXRhYi1pdGVtJykuZXEoaW5kZXgpLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICAgICAgdGhpcy5fYm9keS5maW5kKCcuemQtdGFiLWl0ZW0nKS5lcShpbmRleCkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgICAgICBpZiAodGhpcy5vcHRpb24uYWN0aXZlKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9uLmFjdGl2ZSh0aGlzLl9kYXRhW2luZGV4XSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3NldEhpc3RvcnkodGhpcy5fZGF0YVtpbmRleF0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2dldEluZGV4QnlJZChpZDogc3RyaW5nKTogbnVtYmVyIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gdGhpcy5fZGF0YS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fZGF0YVtpXS5pZCA9PSBpZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIC0xO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3NldEhpc3RvcnkoaXRlbTogTmF2SXRlbSkge1xyXG4gICAgICAgIGxldCB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZi5zcGxpdCgnIycpWzBdICsgJyMnICtpdGVtLmlkO1xyXG4gICAgICAgIGhpc3RvcnkucHVzaFN0YXRlKGl0ZW0sIGl0ZW0ubmFtZSwgdXJsKTtcclxuICAgIH1cclxufSIsImNsYXNzIE5hdmJhciB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgZWxlbWVudDogSlF1ZXJ5LFxyXG4gICAgICAgIG9wdGlvbj86IE5hdmJhck9wdGlvblxyXG4gICAgKSB7XHJcbiAgICAgICAgdGhpcy5vcHRpb24gPSAkLmV4dGVuZCh7fSwgbmV3IE5hdmJhckRlZmF1bHRPcHRpb24oKSwgb3B0aW9uKTtcclxuICAgICAgICB0aGlzLnRhYiA9ICQodGhpcy5vcHRpb24udGFiKS50YWIoe1xyXG4gICAgICAgICAgICBhY3RpdmU6IGZ1bmN0aW9uKGl0ZW06IE5hdkl0ZW0pIHtcclxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coaXRlbSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9ib3R0b20gPSB0aGlzLmVsZW1lbnQuZmluZCgnLm5hdi1ib3R0b20nKTtcclxuICAgICAgICB0aGlzLl90b3AgPSB0aGlzLmVsZW1lbnQuZmluZCgnLm5hdi10b3AnKTtcclxuICAgICAgICB0aGlzLnJlZnJlc2goKTtcclxuICAgICAgICB0aGlzLl9iaW5kRXZlbnQoKTtcclxuICAgICAgICAvLyDliLfmlrDmtY/op4jlmajml7bot7PovaxcclxuICAgICAgICBsZXQgdXJsID0gd2luZG93LmxvY2F0aW9uLmhyZWYuc3BsaXQoJyMnKTtcclxuICAgICAgICBpZiAodXJsLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5vcGVuKHVybFsxXSk7XHJcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbi5kZWZhdWx0KSB7XHJcbiAgICAgICAgICAgIHRoaXMub3Blbih0aGlzLm9wdGlvbi5kZWZhdWx0KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIG9wdGlvbjogTmF2YmFyT3B0aW9uO1xyXG4gICAgXHJcbiAgICBwdWJsaWMgdGFiOiBUYWI7XHJcblxyXG4gICAgcHJpdmF0ZSBfYm90dG9tOiBKUXVlcnk7XHJcbiAgICBwcml2YXRlIF90b3A6IEpRdWVyeTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOe7keWumuS6i+S7tlxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9iaW5kRXZlbnQoKSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLmVsZW1lbnQub24oXCJjbGlja1wiLCAnbGkgYScsIGZ1bmN0aW9uKGUpIHtcclxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5vbihcImNsaWNrXCIsICdsaScsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsZXQgaXRlbTogTmF2SXRlbSA9ICQodGhpcykuZGF0YSgpO1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5vcGVuSXRlbShpdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAkKHdpbmRvdykuYmluZCgncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XHJcbiAgICAgICAgICAgIC8vIOa1j+iniOWZqOi/lOWbnui3s+i9rFxyXG4gICAgICAgICAgICBsZXQgaXRlbTogTmF2SXRlbSA9IGUub3JpZ2luYWxFdmVudC5zdGF0ZTtcclxuICAgICAgICAgICAgaW5zdGFuY2UudGFiLnNob3dJdGVtKGl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLl9zZXRQcm9wZXJ0eSgpO1xyXG4gICAgICAgICAgICBpbnN0YW5jZS50YWIuc2V0UHJvcGVydHkoKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9zZXRQcm9wZXJ0eSgpIHtcclxuICAgICAgICB0aGlzLl90b3AuaGVpZ2h0KCQod2luZG93KS5oZWlnaHQoKSAtIHRoaXMuX3RvcC5vZmZzZXQoKS50b3AgLSB0aGlzLl9ib3R0b20uaGVpZ2h0KCkpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcGVuKHBhdGg6IHN0cmluZ3wgc3RyaW5nW10sIGlzVG9wOiBib29sZWFuID0gdHJ1ZSkge1xyXG4gICAgICAgIFtpc1RvcCwgcGF0aF0gPSB0aGlzLl9wYXRoVG9JZChwYXRoLCBpc1RvcCk7XHJcbiAgICAgICAgbGV0IGlkID0gcGF0aC5zaGlmdCgpO1xyXG4gICAgICAgIGlmICh0aGlzLm9wdGlvbi5kYXRhLmhhc093blByb3BlcnR5KGlkKSkge1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbi5kYXRhW2lkXS5hY3RpdmUocGF0aCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uLmJvdHRvbS5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb24uYm90dG9tW2lkXS5hY3RpdmUocGF0aCk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdlcnJvciBpZDogJysgaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcGVuSXRlbShpdGVtOiBOYXZJdGVtKSB7XHJcbiAgICAgICAgaXRlbS5hZGRBY3RpdmUoKTtcclxuICAgICAgICBpZiAoaXRlbS51cmwuaW5kZXhPZignIycpID49IDAgfHwgaXRlbS51cmwuaW5kZXhPZignamF2YXNjcmlwdDonKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgc3dpdGNoIChpdGVtLnRhcmdldCkge1xyXG4gICAgICAgICAgICBjYXNlIFRhcmdldE1vZGUudGFiOlxyXG4gICAgICAgICAgICAgICAgdGhpcy50YWIuYWRkSXRlbShpdGVtKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFRhcmdldE1vZGUuYmxhbms6XHJcbiAgICAgICAgICAgICAgICB3aW5kb3cub3BlbihpdGVtLnVybCwgJ19ibGFuaycpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGNhc2UgVGFyZ2V0TW9kZS5zZWxmOlxyXG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBpdGVtLnVybDtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlIFRhcmdldE1vZGUud2luZG93OlxyXG4gICAgICAgICAgICAgICAgd2luZG93Lm9wZW4oaXRlbS51cmwpO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlZnJlc2goKSB7XHJcbiAgICAgICAgdGhpcy5fYWRkSXRlbSh0aGlzLl90b3AsIHRoaXMub3B0aW9uLmRhdGEpOyBcclxuICAgICAgICBpZiAoIXRoaXMub3B0aW9uLmJvdHRvbSkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZXRQcm9wZXJ0eSgpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2FkZEl0ZW0odGhpcy5fYm90dG9tLCB0aGlzLm9wdGlvbi5ib3R0b20pO1xyXG4gICAgICAgIHRoaXMuX3NldFByb3BlcnR5KCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8g5Yqo5oCB5re75YqgXHJcbiAgICBwdWJsaWMgYWRkSXRlbShwYXRoOiBzdHJpbmcsIGl0ZW06IE5hdkl0ZW18IE9iamVjdCkge1xyXG4gICAgICAgIGxldCBbaXNUb3AsIGFsbElkXSA9IHRoaXMuX3BhdGhUb0lkKHBhdGgpO1xyXG4gICAgICAgIGxldCBpZCA9IGFsbElkLnBvcCgpO1xyXG4gICAgICAgIGlmIChhbGxJZC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuZ2V0SXRlbShhbGxJZCkuYWRkSXRlbShpZCwgTmF2SXRlbS5wYXJzZShpdGVtKSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKFtpZF0sIGlzVG9wKTtcclxuICAgICAgICBsZXQgZGF0YSA9IHt9O1xyXG4gICAgICAgIGRhdGFbaWRdID0gaXRlbTtcclxuICAgICAgICBpZiAoaXNUb3ApIHtcclxuICAgICAgICAgICAgdGhpcy5vcHRpb24uZGF0YVtpZF0gPSBpdGVtO1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRJdGVtKHRoaXMuX3RvcCwgZGF0YSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vcHRpb24uZGF0YVtpZF0gPSBpdGVtO1xyXG4gICAgICAgIHRoaXMuX2FkZEl0ZW0odGhpcy5fYm90dG9tLCBkYXRhKTtcclxuICAgICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHJlbW92ZUl0ZW0ocGF0aDogc3RyaW5nfCBzdHJpbmdbXSwgaXNUb3A6IGJvb2xlYW4gPSB0cnVlKTogdGhpcyB7XHJcbiAgICAgICAgW2lzVG9wLCBwYXRoXSA9IHRoaXMuX3BhdGhUb0lkKHBhdGgsIGlzVG9wKTtcclxuICAgICAgICBsZXQgaWQgPSBwYXRoLnBvcCgpO1xyXG4gICAgICAgIGlmIChwYXRoLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5nZXRJdGVtKHBhdGgpLnJlbW92ZUl0ZW0oaWQpO1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGlzVG9wICYmIHRoaXMub3B0aW9uLmRhdGEuaGFzT3duUHJvcGVydHkoaWQpKSB7XHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9uLmRhdGFbaWRdLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5vcHRpb24uZGF0YVtpZF07XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAodGhpcy5vcHRpb24uYm90dG9tLmhhc093blByb3BlcnR5KGlkKSkge1xyXG4gICAgICAgICAgICB0aGlzLm9wdGlvbi5ib3R0b21baWRdLnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBkZWxldGUgdGhpcy5vcHRpb24uYm90dG9tW2lkXTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBcclxuICAgICAqIEBwYXJhbSBpc1RvcCBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldEl0ZW0ocGF0aDogc3RyaW5nfCBzdHJpbmdbXSwgaXNUb3A6IGJvb2xlYW4gPSB0cnVlKTogTmF2SXRlbSB7XHJcbiAgICAgICAgW2lzVG9wLCBwYXRoXSA9IHRoaXMuX3BhdGhUb0lkKHBhdGgsIGlzVG9wKTtcclxuICAgICAgICBsZXQgaWQgPSBwYXRoLnNoaWZ0KCk7XHJcbiAgICAgICAgaWYgKGlzVG9wICYmIHRoaXMub3B0aW9uLmRhdGEuaGFzT3duUHJvcGVydHkoaWQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLm9wdGlvbi5kYXRhW2lkXS5nZXRDaGlsZChwYXRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9uLmJvdHRvbS5oYXNPd25Qcm9wZXJ0eShpZCkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9uLmJvdHRvbVtpZF0uZ2V0Q2hpbGQocGF0aCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignZXJyb3IgaWQ6ICcrIGlkKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOi3r+W+hOi9rOaNouaIkElkXHJcbiAgICAgKiBAcGFyYW0gcGF0aCBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfcGF0aFRvSWQocGF0aDogc3RyaW5nfCBzdHJpbmdbXSwgaXNUb3A6IGJvb2xlYW4gPSB0cnVlKTogW2Jvb2xlYW4sIHN0cmluZ1tdXSB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBwYXRoICE9ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbaXNUb3AsIHBhdGhdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIWlzVG9wKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBbaXNUb3AsIFtwYXRoXV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBwYXRocyA9IHBhdGguc3BsaXQoJzonKTtcclxuICAgICAgICBpZiAocGF0aHMubGVuZ3RoID4gMSAmJiBwYXRoc1swXSA9PSAnYm90dG9tJykge1xyXG4gICAgICAgICAgICBpc1RvcCA9IGZhbHNlO1xyXG4gICAgICAgICAgICBwYXRoID0gcGF0aHNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHBhdGhzID0gcGF0aC5zcGxpdCgnLycpO1xyXG4gICAgICAgIGxldCBhbGxJZCA9IFtdO1xyXG4gICAgICAgIHBhdGhzLmZvckVhY2goaWQgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaWQgPT0gJycpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBhbGxJZC5wdXNoKGlkKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gW2lzVG9wLCBhbGxJZF07XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfYWRkSXRlbShlbGVtZW50OiBKUXVlcnksIGRhdGE6IHtbaWQ6IHN0cmluZ106IE5hdkl0ZW19KSB7XHJcbiAgICAgICAgJC5lYWNoKGRhdGEsIGZ1bmN0aW9uKGlkOiBzdHJpbmcsIGl0ZW06IE5hdkl0ZW0pIHtcclxuICAgICAgICAgICAgaXRlbSA9IE5hdkl0ZW0ucGFyc2UoaXRlbSk7XHJcbiAgICAgICAgICAgIGVsZW1lbnQuYXBwZW5kKGl0ZW0ucmVuZGVyKGlkKSk7XHJcbiAgICAgICAgICAgIGRhdGFbaWRdID0gaXRlbTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG5cclxuOyhmdW5jdGlvbigkOiBhbnkpIHtcclxuICAgICQuZm4udGFiID0gZnVuY3Rpb24ob3B0aW9uID86IFRhYk9wdGlvbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgVGFiKHRoaXMsIG9wdGlvbik7IFxyXG4gICAgfTtcclxuICAgICQuZm4ubmF2YmFyID0gZnVuY3Rpb24ob3B0aW9uID86IE5hdmJhck9wdGlvbikge1xyXG4gICAgICAgIHJldHVybiBuZXcgTmF2YmFyKHRoaXMsIG9wdGlvbik7IFxyXG4gICAgfTtcclxufSkoalF1ZXJ5KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
