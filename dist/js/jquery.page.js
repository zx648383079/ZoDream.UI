var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var Eve = (function () {
    function Eve() {
    }
    Eve.prototype.on = function (event, callback) {
        this.options['on' + event] = callback;
        return this;
    };
    Eve.prototype.hasEvent = function (event) {
        return this.options.hasOwnProperty('on' + event);
    };
    Eve.prototype.trigger = function (event) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var realEvent = 'on' + event;
        if (!this.hasEvent(event)) {
            return;
        }
        return (_a = this.options[realEvent]).call.apply(_a, [this].concat(args));
        var _a;
    };
    return Eve;
}());
var Box = (function (_super) {
    __extends(Box, _super);
    function Box() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    Box.prototype.showPosition = function () {
        this.setPosition();
        this.box.show();
        return this;
    };
    Box.prototype.setPosition = function () {
        var offset = this.element.offset();
        var x = offset.left - $(window).scrollLeft();
        var y = offset.top + this.element.outerHeight() - $(window).scrollTop();
        this.box.css({ left: x + "px", top: y + "px" });
        return this;
    };
    /**
     * 根据可能是相对值获取绝对值
     * @param abservable
     * @param reltive
     */
    Box.getReal = function (abservable, reltive) {
        if (reltive > 1) {
            return reltive;
        }
        return abservable * reltive;
    };
    return Box;
}(Eve));
var Uri = (function () {
    function Uri(_path, _data) {
        if (_path === void 0) { _path = ''; }
        if (_data === void 0) { _data = {}; }
        this._path = _path;
        this._data = _data;
        if (_path.indexOf('?') >= 0) {
            _a = this._parseUrl(_path), _path = _a[0], _data = _a[1];
        }
        var _a;
    }
    Uri.prototype.setData = function (key, val) {
        if (typeof key == 'object') {
            this._data = $.extend(this._data, key);
        }
        else {
            this._data[key] = val;
        }
        return this;
    };
    Uri.prototype.clearData = function () {
        this._data = {};
        return this;
    };
    Uri.prototype.get = function (success, dataType) {
        $.get(this.toString(), success, dataType);
    };
    Uri.prototype.getJson = function (success) {
        $.getJSON(this.toString(), success);
    };
    Uri.prototype.post = function (data, success, dataType) {
        $.post(this.toString(), data, success, dataType);
    };
    Uri.parse = function (url) {
        if (typeof url == 'object') {
            return url;
        }
        return new Uri(url);
    };
    Uri.prototype.toString = function () {
        var param = Uri.getData(this._data);
        if (param == '') {
            return this._path;
        }
        return this._path + '?' + param;
    };
    Uri.getData = function (args) {
        if ('object' != typeof args) {
            return args;
        }
        var value = '';
        $.each(args, function (key, item) {
            value += Uri._filterValue(item, key);
        });
        return value.substring(0, value.length - 1);
    };
    Uri._filterValue = function (data, pre) {
        if (typeof data != 'object') {
            return pre + "=" + data + "&";
        }
        var value = '';
        var isArray = data instanceof Array;
        $.each(data, function (key, item) {
            value += Uri._filterValue(item, pre + (isArray ? "[]" : "[" + key + "]"));
        });
        return value;
    };
    Uri.prototype._parseUrl = function (url) {
        var _a = url.split('?', 2), path = _a[0], param = _a[1];
        if (!param) {
            return [path, {}];
        }
        var ret = {}, seg = param.split('&'), len = seg.length, i = 0, s; //len = 2
        for (; i < len; i++) {
            if (!seg[i]) {
                continue;
            }
            s = seg[i].split('=');
            ret[s[0]] = s[1];
        }
        return [path, ret];
    };
    return Uri;
}());
/**
 * 分页
 */
var Page = (function (_super) {
    __extends(Page, _super);
    function Page(element, option) {
        var _this = _super.call(this) || this;
        _this.element = element;
        _this.options = $.extend({}, new PageDefaultOption(), option);
        _this.options.url = Uri.parse(_this.options.url);
        _this.options.deleteUrl = Uri.parse(_this.options.deleteUrl);
        _this.options.updateUrl = Uri.parse(_this.options.updateUrl);
        _this.init();
        _this.search();
        return _this;
    }
    Page.prototype.init = function () {
        var instance = this;
        this._body = this.element.find(this.options.pageBody);
        this._searchForm = this.element.find(this.options.searchForm);
        this._searchElements = this._searchForm.find('input,select,textarea');
        this._pager = $('<ul class="pager"></ul>').pager({
            paginate: function (page) {
                instance.search('page', page);
            }
        });
        this._checkAll = this.element.find('.checkAll');
        this.element.append(this._pager.element);
        this._bindEvent();
    };
    Page.prototype.checkAll = function () {
        this._body.find(".checkbox").addClass('checked');
    };
    Page.prototype.getCheckedRow = function () {
        var data = [];
        var instance = this;
        this._body.find('.checkbox.checked').each(function (i, el) {
            data.push($(el).parents(instance.options.row));
        });
        return data;
    };
    Page.prototype.getChecked = function () {
        var data = [];
        var instance = this;
        $.each(this.getCheckedRow(), function (i, item) {
            data.push(item.attr(instance.options.idTag));
        });
        return data;
    };
    /**
     * 排序
     * @param name
     * @param order
     */
    Page.prototype.sort = function (name, order) {
        this.search({
            sort: name,
            order: order
        });
    };
    /**
     * 搜索
     * @param name
     * @param val
     */
    Page.prototype.search = function (name, val) {
        if (name === void 0) { name = {}; }
        if (typeof name != 'object') {
            name = (_a = {}, _a[name] = val, _a);
        }
        if (!name.hasOwnProperty('page')) {
            name['page'] = 1;
        }
        this.options.url.setData(name);
        this.refresh();
        var _a;
    };
    /**
     * 删除选中
     */
    Page.prototype.deleteChecked = function () {
        var elements = this.getCheckedRow();
        var instance = this;
        var data = [];
        elements.forEach(function (item) {
            data.push(item.attr(instance.options.idTag));
        });
        this.deleteId.apply(this, data);
    };
    Page.prototype.deleteRow = function (element) {
        var id = element.attr(this.options.idTag);
        if (!id) {
            return;
        }
        this.deleteId(id);
    };
    /**
     * 获取id标记
     */
    Page.prototype._getIdTag = function () {
        return this.options.idTag.replace('data-', '');
    };
    Page.prototype.deleteId = function () {
        var data = [];
        for (var _i = 0; _i < arguments.length; _i++) {
            data[_i] = arguments[_i];
        }
        if (data.length == 0) {
            return;
        }
        var instance = this;
        if (false == this.trigger.apply(this, ['delete'].concat(data))) {
            console.log('delete is stop!');
            return;
        }
        this.options.deleteUrl.setData(this._getIdTag(), data).post({}, function (data) {
            if (data.code == 0) {
                instance.refresh();
            }
        }, 'json');
    };
    Page.prototype.refresh = function () {
        var instance = this;
        if (this.options.beforeQuery
            && this.options.beforeQuery.call(this) == false) {
            console.log('query is stop!');
            return;
        }
        this.options.url.getJson(function (data) {
            if (instance.options.afterQuery) {
                instance.options.afterQuery.call(this, data);
            }
            if (data.code != 0) {
                console.log(data);
                return;
            }
            instance._createBody(data.data.pagelist);
            instance._pager.change(data.data.page, Math.ceil(data.data.total / data.data.pageSize));
        });
    };
    /**
     * 判断是否为空值
     * @param val
     */
    Page.prototype._checkEmpty = function (val) {
        return !val || val == '' || val.trim() == '';
    };
    Page.prototype.updateColumn = function (element) {
        var name = element.attr('data-name');
        if (this._checkEmpty(name)) {
            return;
        }
        var id = element.parents(this.options.row).attr(this.options.idTag);
        if (this._checkEmpty(id)) {
            return;
        }
        if (this.options.beforeUpdate
            && false == this.options.beforeUpdate.call(this, element, id)) {
            return;
        }
        var instance = this;
        var input = $('<input type="text">');
        input.val(element.text());
        input.blur(function () {
            var val = input.val();
            input.remove();
            element.text(val);
            instance.updateData(id, name, val);
        });
        element.html('').append(input);
        input.focus();
    };
    Page.prototype.updateData = function (id, name, val) {
        if (false == this.trigger('update', id, name, val)) {
            console.log('update is stop!');
            return;
        }
        this.options.updateUrl.post((_a = {},
            _a[this._getIdTag()] = id,
            _a.name = name,
            _a.value = val,
            _a), function (data) {
        }, 'json');
        var _a;
    };
    Page.prototype._bindEvent = function () {
        var instance = this;
        this._searchForm.find("[type=submit]").click(function () {
            instance.search(instance._getSearchFormData());
        });
        this.element.find(this.options.sortRow + '>*').click(function () {
            var $this = $(this);
            var name = $this.attr('data-name');
            if (instance._checkEmpty(name)) {
                return;
            }
            if ($this.hasClass('sort-asc')) {
                $this.removeClass().addClass('sort-desc');
                instance.sort(name, 'desc');
            }
            else {
                $this.removeClass().addClass('sort-asc');
                instance.sort(name, 'asc');
            }
        });
        this._checkAll.click(function () {
            var $this = $(this);
            if ($this.hasClass('checked')) {
                $this.removeClass('checked');
                return;
            }
            instance._checkAll.addClass('checked');
            instance._body.find('.checkbox').addClass('checked');
        });
        this.element.find('.deleteAll').click(function () {
            var $this = $(this);
            var tip = $this.attr('data-tip') || instance.options.deleteTip;
            if (confirm(tip)) {
                instance.deleteChecked();
            }
        });
        this.element.find(this.options.filterRow + ' input').blur(function () {
            instance._searchElement($(this));
        });
        this.element.find(this.options.filterRow + ' select').change(function () {
            instance._searchElement($(this));
        });
        this._body.on("click", '.delete', function () {
            var $this = $(this);
            var tip = $this.attr('data-tip') || instance.options.deleteTip;
            if (confirm(tip)) {
                instance.deleteRow($this.parents(instance.options.row));
            }
        });
        this._body.on("click", '.checkbox', function () {
            var $this = $(this);
            if ($this.hasClass('checked')) {
                $this.removeClass('checked');
                instance._checkAll.removeClass('checked');
                return;
            }
            $this.addClass('checked');
        });
        this._body.on('click', this.options.column, function () {
            instance.updateColumn($(this));
        });
    };
    Page.prototype._searchElement = function (element) {
        var name = element.attr('name');
        if (!name) {
            return;
        }
        this.search(name, element.val());
    };
    Page.prototype._createBody = function (data) {
        var html = '';
        if (typeof data == 'object') {
            var instance_1 = this;
            $.each(data, function (i, item) {
                html += instance_1.options.createRow(item);
            });
        }
        else {
            html = data;
        }
        this._body.html(html);
    };
    Page.prototype._getSearchFormData = function () {
        var data = {};
        var instance = this;
        this._searchElements.each(function (i, ele) {
            var element = $(ele);
            var name = element.attr('name');
            if (element.is('[type=ridio]')) {
                if (element.is(':checked')) {
                    data[name] = element.val();
                }
                return;
            }
            if (element.is('[type=checkbox]')) {
                if (element.is(':checked')) {
                    data[name] = element.val(); // 多选时未解决
                }
                return;
            }
            data[name] = element.val();
        });
        return data;
    };
    Page.prototype.delete = function (callback) {
        return this.on('delete', callback);
    };
    Page.prototype.update = function (callback) {
        return this.on('update', callback);
    };
    return Page;
}(Box));
var PageDefaultOption = (function () {
    function PageDefaultOption() {
        this.url = 'query';
        this.updateUrl = 'update';
        this.deleteUrl = 'delete';
        this.idTag = 'data-id';
        this.searchForm = '.page-search';
        this.deleteTip = '确定删除？';
        this.pageBody = '.page-body';
        this.filterRow = '.filter-row';
        this.sortRow = '.sort-row';
        this.row = 'tr';
        this.column = 'td';
    }
    return PageDefaultOption;
}());
;
(function ($) {
    $.fn.page = function (option) {
        return new Page(this, option);
    };
})(jQuery);

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV2ZW50LnRzIiwiYm94LnRzIiwidXJpLnRzIiwianF1ZXJ5LnBhZ2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBO0lBQUE7SUFtQkEsQ0FBQTtJQWhCQSxnQkFBQSxHQUFBLFVBQUEsS0FBQSxFQUFBLFFBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsR0FBQSxLQUFBLENBQUEsR0FBQSxRQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHNCQUFBLEdBQUEsVUFBQSxLQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsY0FBQSxDQUFBLElBQUEsR0FBQSxLQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxxQkFBQSxHQUFBLFVBQUEsS0FBQTtRQUFBLGNBQUE7YUFBQSxVQUFBLEVBQUEscUJBQUEsRUFBQSxJQUFBO1lBQUEsNkJBQUE7O1FBQ0EsSUFBQSxTQUFBLEdBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLENBQUEsS0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxZQUFBLElBQUEsU0FBQSxJQUFBLEdBQUE7O0lBQ0EsQ0FBQTtJQUNBLFVBQUE7QUFBQSxDQW5CQSxBQW1CQSxJQUFBO0FDbkJBO0lBQUEsdUJBQUE7SUFBQTs7SUFnQ0EsQ0FBQTtJQTFCQSwwQkFBQSxHQUFBO1FBQ0EsSUFBQSxDQUFBLFdBQUEsRUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEdBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEseUJBQUEsR0FBQTtRQUNBLElBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxNQUFBLENBQUEsSUFBQSxHQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxVQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLE1BQUEsQ0FBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxXQUFBLEVBQUEsR0FBQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsU0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsR0FBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxDQUFBLEdBQUEsSUFBQSxFQUFBLEdBQUEsRUFBQSxDQUFBLEdBQUEsSUFBQSxFQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBR0E7Ozs7T0FJQTtJQUNBLFdBQUEsR0FBQSxVQUFBLFVBQUEsRUFBQSxPQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsT0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxVQUFBLEdBQUEsT0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUNBLFVBQUE7QUFBQSxDQWhDQSxBQWdDQSxDQWhDQSxHQUFBLEdBZ0NBO0FDaENBO0lBQ0EsYUFDQSxLQUFBLEVBQ0EsS0FBQTtRQURBLHNCQUFBLEVBQUEsVUFBQTtRQUNBLHNCQUFBLEVBQUEsVUFBQTtRQURBLFVBQUEsR0FBQSxLQUFBLENBQUE7UUFDQSxVQUFBLEdBQUEsS0FBQSxDQUFBO1FBRUEsRUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLE9BQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsMEJBQUEsRUFBQSxhQUFBLEVBQUEsYUFBQSxDQUFBO1FBQ0EsQ0FBQTs7SUFDQSxDQUFBO0lBRUEscUJBQUEsR0FBQSxVQUFBLEdBQUEsRUFBQSxHQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxHQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxLQUFBLEdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUFBLElBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxHQUFBLENBQUEsR0FBQSxHQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx1QkFBQSxHQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLGlCQUFBLEdBQUEsVUFBQSxPQUFBLEVBQUEsUUFBQTtRQUNBLENBQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsRUFBQSxFQUFBLE9BQUEsRUFBQSxRQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxxQkFBQSxHQUFBLFVBQUEsT0FBQTtRQUNBLENBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsRUFBQSxFQUFBLE9BQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLGtCQUFBLEdBQUEsVUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLFFBQUE7UUFDQSxDQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLFFBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLFNBQUEsR0FBQSxVQUFBLEdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLEdBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLEdBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxHQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsc0JBQUEsR0FBQTtRQUNBLElBQUEsS0FBQSxHQUFBLEdBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxJQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsR0FBQSxHQUFBLEdBQUEsS0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLFdBQUEsR0FBQSxVQUFBLElBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxRQUFBLElBQUEsT0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxVQUFBLEdBQUEsRUFBQSxJQUFBO1lBQ0EsS0FBQSxJQUFBLEdBQUEsQ0FBQSxZQUFBLENBQUEsSUFBQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsS0FBQSxDQUFBLFNBQUEsQ0FBQSxDQUFBLEVBQUEsS0FBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxnQkFBQSxHQUFBLFVBQUEsSUFBQSxFQUFBLEdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLElBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsSUFBQSxHQUFBLEdBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLE9BQUEsR0FBQSxJQUFBLFlBQUEsS0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsVUFBQSxHQUFBLEVBQUEsSUFBQTtZQUNBLEtBQUEsSUFBQSxHQUFBLENBQUEsWUFBQSxDQUFBLElBQUEsRUFBQSxHQUFBLEdBQUEsQ0FBQSxPQUFBLEdBQUEsSUFBQSxHQUFBLEdBQUEsR0FBQSxHQUFBLEdBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLEtBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx1QkFBQSxHQUFBLFVBQUEsR0FBQTtRQUNBLElBQUEsc0JBQUEsRUFBQSxZQUFBLEVBQUEsYUFBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLENBQUEsSUFBQSxFQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsR0FBQSxHQUFBLEVBQUEsRUFDQSxHQUFBLEdBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxHQUFBLENBQUEsRUFDQSxHQUFBLEdBQUEsR0FBQSxDQUFBLE1BQUEsRUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLFNBQUE7UUFDQSxHQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxHQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxRQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsQ0FBQSxHQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxLQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7WUFDQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxDQUFBLElBQUEsRUFBQSxHQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFDQSxVQUFBO0FBQUEsQ0EzRkEsQUEyRkEsSUFBQTtBQzNGQTs7R0FFQTtBQUNBO0lBQUEsd0JBQUE7SUFDQSxjQUNBLE9BQUEsRUFDQSxNQUFBO1FBRkEsWUFJQSxpQkFBQSxTQU9BO1FBVkEsYUFBQSxHQUFBLE9BQUEsQ0FBQTtRQUlBLEtBQUEsQ0FBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxFQUFBLEVBQUEsSUFBQSxpQkFBQSxFQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsT0FBQSxDQUFBLEdBQUEsR0FBQSxHQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsT0FBQSxDQUFBLFNBQUEsR0FBQSxHQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsT0FBQSxDQUFBLFNBQUEsR0FBQSxHQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsSUFBQSxFQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsTUFBQSxFQUFBLENBQUE7O0lBQ0EsQ0FBQTtJQWNBLG1CQUFBLEdBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsV0FBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsVUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsZUFBQSxHQUFBLElBQUEsQ0FBQSxXQUFBLENBQUEsSUFBQSxDQUFBLHVCQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBLHlCQUFBLENBQUEsQ0FBQSxLQUFBLENBQUE7WUFDQSxRQUFBLEVBQUEsVUFBQSxJQUFBO2dCQUNBLFFBQUEsQ0FBQSxNQUFBLENBQUEsTUFBQSxFQUFBLElBQUEsQ0FBQSxDQUFBO1lBQ0EsQ0FBQTtTQUNBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxTQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsV0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFVBQUEsRUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHVCQUFBLEdBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsNEJBQUEsR0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLG1CQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLEVBQUEsRUFBQTtZQUNBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBR0EseUJBQUEsR0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLGFBQUEsRUFBQSxFQUFBLFVBQUEsQ0FBQSxFQUFBLElBQUE7WUFDQSxJQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLE9BQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBOzs7O09BSUE7SUFDQSxtQkFBQSxHQUFBLFVBQUEsSUFBQSxFQUFBLEtBQUE7UUFDQSxJQUFBLENBQUEsTUFBQSxDQUFBO1lBQ0EsSUFBQSxFQUFBLElBQUE7WUFDQSxLQUFBLEVBQUEsS0FBQTtTQUNBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7OztPQUlBO0lBQ0EscUJBQUEsR0FBQSxVQUFBLElBQUEsRUFBQSxHQUFBO1FBQUEscUJBQUEsRUFBQSxTQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxJQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsYUFBQSxHQUFBLElBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxjQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLE1BQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxFQUFBLENBQUE7O0lBQ0EsQ0FBQTtJQUVBOztPQUVBO0lBQ0EsNEJBQUEsR0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQSxhQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLFFBQUEsQ0FBQSxPQUFBLENBQUEsVUFBQSxJQUFBO1lBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFFBQUEsT0FBQSxJQUFBLEVBQUEsSUFBQSxFQUFBO0lBQ0EsQ0FBQTtJQUVBLHdCQUFBLEdBQUEsVUFBQSxPQUFBO1FBQ0EsSUFBQSxFQUFBLEdBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxRQUFBLENBQUEsRUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBQ0E7O09BRUE7SUFDQSx3QkFBQSxHQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxDQUFBLE9BQUEsQ0FBQSxPQUFBLEVBQUEsRUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsdUJBQUEsR0FBQTtRQUFBLGNBQUE7YUFBQSxVQUFBLEVBQUEscUJBQUEsRUFBQSxJQUFBO1lBQUEseUJBQUE7O1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsSUFBQSxJQUFBLENBQUEsT0FBQSxPQUFBLElBQUEsR0FBQSxRQUFBLFNBQUEsSUFBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsT0FBQSxDQUFBLEdBQUEsQ0FBQSxpQkFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxTQUFBLEVBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxFQUFBLFVBQUEsSUFBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxRQUFBLENBQUEsT0FBQSxFQUFBLENBQUE7WUFDQSxDQUFBO1FBQ0EsQ0FBQSxFQUFBLE1BQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHNCQUFBLEdBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLFdBQUE7ZUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLFdBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE9BQUEsQ0FBQSxHQUFBLENBQUEsZ0JBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsR0FBQSxDQUFBLE9BQUEsQ0FBQSxVQUFBLElBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsT0FBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsUUFBQSxDQUFBLE9BQUEsQ0FBQSxVQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsT0FBQSxDQUFBLEdBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtnQkFDQSxNQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLFdBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLE1BQUEsQ0FBQSxNQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsR0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7O09BR0E7SUFDQSwwQkFBQSxHQUFBLFVBQUEsR0FBQTtRQUNBLE1BQUEsQ0FBQSxDQUFBLEdBQUEsSUFBQSxHQUFBLElBQUEsRUFBQSxJQUFBLEdBQUEsQ0FBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsMkJBQUEsR0FBQSxVQUFBLE9BQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLFdBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxFQUFBLEdBQUEsT0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLFdBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxZQUFBO2VBQ0EsS0FBQSxJQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsWUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsT0FBQSxFQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxDQUFBLENBQUEscUJBQUEsQ0FBQSxDQUFBO1FBQ0EsS0FBQSxDQUFBLEdBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxJQUFBLENBQUE7WUFDQSxJQUFBLEdBQUEsR0FBQSxLQUFBLENBQUEsR0FBQSxFQUFBLENBQUE7WUFDQSxLQUFBLENBQUEsTUFBQSxFQUFBLENBQUE7WUFDQSxPQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLFVBQUEsQ0FBQSxFQUFBLEVBQUEsSUFBQSxFQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxPQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSx5QkFBQSxHQUFBLFVBQUEsRUFBQSxFQUFBLElBQUEsRUFBQSxHQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxJQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxFQUFBLEVBQUEsRUFBQSxJQUFBLEVBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsT0FBQSxDQUFBLEdBQUEsQ0FBQSxpQkFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUEsSUFBQTtZQUNBLEdBQUEsSUFBQSxDQUFBLFNBQUEsRUFBQSxJQUFBLEVBQUE7WUFDQSxPQUFBLEdBQUEsSUFBQTtZQUNBLFFBQUEsR0FBQSxHQUFBO2lCQUNBLFVBQUEsSUFBQTtRQUVBLENBQUEsRUFBQSxNQUFBLENBQUEsQ0FBQTs7SUFDQSxDQUFBO0lBRUEseUJBQUEsR0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxXQUFBLENBQUEsSUFBQSxDQUFBLGVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxNQUFBLENBQUEsUUFBQSxDQUFBLGtCQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLE9BQUEsR0FBQSxJQUFBLENBQUEsQ0FBQSxLQUFBLENBQUE7WUFDQSxJQUFBLEtBQUEsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7WUFDQSxJQUFBLElBQUEsR0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLFdBQUEsQ0FBQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFdBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxRQUFBLENBQUEsVUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLEtBQUEsQ0FBQSxXQUFBLEVBQUEsQ0FBQSxRQUFBLENBQUEsV0FBQSxDQUFBLENBQUE7Z0JBQ0EsUUFBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7WUFDQSxDQUFBO1lBQUEsSUFBQSxDQUFBLENBQUE7Z0JBQ0EsS0FBQSxDQUFBLFdBQUEsRUFBQSxDQUFBLFFBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQTtnQkFDQSxRQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsRUFBQSxLQUFBLENBQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxTQUFBLENBQUEsS0FBQSxDQUFBO1lBQ0EsSUFBQSxLQUFBLEdBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBLFFBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsS0FBQSxDQUFBLFdBQUEsQ0FBQSxTQUFBLENBQUEsQ0FBQTtnQkFDQSxNQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLFNBQUEsQ0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7WUFDQSxRQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxXQUFBLENBQUEsQ0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLFlBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLElBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsR0FBQSxHQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLElBQUEsUUFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLFFBQUEsQ0FBQSxhQUFBLEVBQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxHQUFBLFFBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxHQUFBLFNBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsRUFBQSxDQUFBLE9BQUEsRUFBQSxTQUFBLEVBQUE7WUFDQSxJQUFBLEtBQUEsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7WUFDQSxJQUFBLEdBQUEsR0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLFVBQUEsQ0FBQSxJQUFBLFFBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxRQUFBLENBQUEsU0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLE9BQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxFQUFBLENBQUEsT0FBQSxFQUFBLFdBQUEsRUFBQTtZQUNBLElBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLEtBQUEsQ0FBQSxXQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7Z0JBQ0EsUUFBQSxDQUFBLFNBQUEsQ0FBQSxXQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7Z0JBQ0EsTUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLEtBQUEsQ0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxLQUFBLENBQUEsRUFBQSxDQUFBLE9BQUEsRUFBQSxJQUFBLENBQUEsT0FBQSxDQUFBLE1BQUEsRUFBQTtZQUNBLFFBQUEsQ0FBQSxZQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSw2QkFBQSxHQUFBLFVBQUEsT0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE1BQUEsQ0FBQSxJQUFBLEVBQUEsT0FBQSxDQUFBLEdBQUEsRUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsMEJBQUEsR0FBQSxVQUFBLElBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxFQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLElBQUEsSUFBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxVQUFBLEdBQUEsSUFBQSxDQUFBO1lBQ0EsQ0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsVUFBQSxDQUFBLEVBQUEsSUFBQTtnQkFDQSxJQUFBLElBQUEsVUFBQSxDQUFBLE9BQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsaUNBQUEsR0FBQTtRQUNBLElBQUEsSUFBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxlQUFBLENBQUEsSUFBQSxDQUFBLFVBQUEsQ0FBQSxFQUFBLEdBQUE7WUFDQSxJQUFBLE9BQUEsR0FBQSxDQUFBLENBQUEsR0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLElBQUEsR0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxDQUFBLEVBQUEsQ0FBQSxjQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxDQUFBLEVBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7b0JBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxHQUFBLE9BQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTtnQkFDQSxDQUFBO2dCQUNBLE1BQUEsQ0FBQTtZQUNBLENBQUE7WUFDQSxFQUFBLENBQUEsQ0FBQSxPQUFBLENBQUEsRUFBQSxDQUFBLGlCQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxDQUFBLEVBQUEsQ0FBQSxVQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7b0JBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxHQUFBLE9BQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQSxDQUFBLFNBQUE7Z0JBQ0EsQ0FBQTtnQkFDQSxNQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxHQUFBLE9BQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxxQkFBQSxHQUFBLFVBQUEsUUFBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLFFBQUEsRUFBQSxRQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSxxQkFBQSxHQUFBLFVBQUEsUUFBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsRUFBQSxDQUFBLFFBQUEsRUFBQSxRQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFDQSxXQUFBO0FBQUEsQ0E1VEEsQUE0VEEsQ0E1VEEsR0FBQSxHQTRUQTtBQXNCQTtJQUFBO1FBQ0EsUUFBQSxHQUFBLE9BQUEsQ0FBQTtRQUNBLGNBQUEsR0FBQSxRQUFBLENBQUE7UUFDQSxjQUFBLEdBQUEsUUFBQSxDQUFBO1FBQ0EsVUFBQSxHQUFBLFNBQUEsQ0FBQTtRQUNBLGVBQUEsR0FBQSxjQUFBLENBQUE7UUFDQSxjQUFBLEdBQUEsT0FBQSxDQUFBO1FBQ0EsYUFBQSxHQUFBLFlBQUEsQ0FBQTtRQUNBLGNBQUEsR0FBQSxhQUFBLENBQUE7UUFDQSxZQUFBLEdBQUEsV0FBQSxDQUFBO1FBQ0EsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLFdBQUEsR0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBQUEsd0JBQUE7QUFBQSxDQVpBLEFBWUEsSUFBQTtBQUdBLENBQUE7QUFBQSxDQUFBLFVBQUEsQ0FBQTtJQUNBLENBQUEsQ0FBQSxFQUFBLENBQUEsSUFBQSxHQUFBLFVBQUEsTUFBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLElBQUEsQ0FBQSxJQUFBLEVBQUEsTUFBQSxDQUFBLENBQUE7SUFDQSxDQUFBLENBQUE7QUFDQSxDQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSIsImZpbGUiOiJqcXVlcnkucGFnZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImFic3RyYWN0IGNsYXNzIEV2ZSB7XHJcbiAgICBwdWJsaWMgb3B0aW9uczogYW55O1xyXG5cclxuICAgIHB1YmxpYyBvbihldmVudDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pOiB0aGlzIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnNbJ29uJyArIGV2ZW50XSA9IGNhbGxiYWNrO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBoYXNFdmVudChldmVudDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgnb24nICsgZXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB0cmlnZ2VyKGV2ZW50OiBzdHJpbmcsIC4uLiBhcmdzOiBhbnlbXSkge1xyXG4gICAgICAgIGxldCByZWFsRXZlbnQgPSAnb24nICsgZXZlbnQ7XHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc0V2ZW50KGV2ZW50KSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNbcmVhbEV2ZW50XS5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG59IiwiYWJzdHJhY3QgY2xhc3MgQm94IGV4dGVuZHMgRXZlIHtcclxuXHJcbiAgICBwdWJsaWMgZWxlbWVudDogSlF1ZXJ5O1xyXG5cclxuICAgIHB1YmxpYyBib3g6IEpRdWVyeTtcclxuXHJcbiAgICBwcm90ZWN0ZWQgc2hvd1Bvc2l0aW9uKCk6IHRoaXMge1xyXG4gICAgICAgIHRoaXMuc2V0UG9zaXRpb24oKTtcclxuICAgICAgICB0aGlzLmJveC5zaG93KCk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgcHJvdGVjdGVkIHNldFBvc2l0aW9uKCk6IHRoaXMge1xyXG4gICAgICAgIGxldCBvZmZzZXQgPSB0aGlzLmVsZW1lbnQub2Zmc2V0KCk7XHJcbiAgICAgICAgbGV0IHggPSBvZmZzZXQubGVmdCAtICQod2luZG93KS5zY3JvbGxMZWZ0KCk7XHJcbiAgICAgICAgbGV0IHkgPSBvZmZzZXQudG9wICsgdGhpcy5lbGVtZW50Lm91dGVySGVpZ2h0KCkgLSAkKHdpbmRvdykuc2Nyb2xsVG9wKCk7XHJcbiAgICAgICAgdGhpcy5ib3guY3NzKHtsZWZ0OiB4ICsgXCJweFwiLCB0b3A6IHkgKyBcInB4XCJ9KTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmoLnmja7lj6/og73mmK/nm7jlr7nlgLzojrflj5bnu53lr7nlgLxcclxuICAgICAqIEBwYXJhbSBhYnNlcnZhYmxlIFxyXG4gICAgICogQHBhcmFtIHJlbHRpdmUgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzdGF0aWMgZ2V0UmVhbChhYnNlcnZhYmxlOiBudW1iZXIsIHJlbHRpdmU6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgaWYgKHJlbHRpdmUgPiAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybiByZWx0aXZlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYWJzZXJ2YWJsZSAqIHJlbHRpdmU7XHJcbiAgICB9XHJcbn0iLCJjbGFzcyBVcmkge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHJpdmF0ZSBfcGF0aDogc3RyaW5nID0gJycsXHJcbiAgICAgICAgcHJpdmF0ZSBfZGF0YToge1trZXk6IHN0cmluZ106IHN0cmluZ30gPSB7fVxyXG4gICAgKSB7XHJcbiAgICAgICAgaWYgKF9wYXRoLmluZGV4T2YoJz8nKSA+PSAwKSB7XHJcbiAgICAgICAgICAgIFtfcGF0aCwgX2RhdGFdID0gdGhpcy5fcGFyc2VVcmwoX3BhdGgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0RGF0YShrZXk6IGFueSwgdmFsPzogc3RyaW5nKTogdGhpcyB7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBrZXkgPT0gJ29iamVjdCcpIHtcclxuICAgICAgICAgICAgdGhpcy5fZGF0YSA9ICQuZXh0ZW5kKHRoaXMuX2RhdGEsIGtleSk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fZGF0YVtrZXldID0gdmFsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY2xlYXJEYXRhKCk6IHRoaXMge1xyXG4gICAgICAgIHRoaXMuX2RhdGEgPSB7fTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0KHN1Y2Nlc3M/OiAoZGF0YTogYW55LCB0ZXh0U3RhdHVzOiBzdHJpbmcsIGpxWEhSOiBKUXVlcnlYSFIpID0+IGFueSwgZGF0YVR5cGU/OiBzdHJpbmcpIHtcclxuICAgICAgICAkLmdldCh0aGlzLnRvU3RyaW5nKCksIHN1Y2Nlc3MsIGRhdGFUeXBlKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0SnNvbihzdWNjZXNzPzogKGRhdGE6IGFueSwgdGV4dFN0YXR1czogc3RyaW5nLCBqcVhIUjogSlF1ZXJ5WEhSKSA9PiBhbnkpIHtcclxuICAgICAgICAkLmdldEpTT04odGhpcy50b1N0cmluZygpLCBzdWNjZXNzKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgcG9zdChkYXRhPzogT2JqZWN0fHN0cmluZywgc3VjY2Vzcz86IChkYXRhOiBhbnksIHRleHRTdGF0dXM6IHN0cmluZywganFYSFI6IEpRdWVyeVhIUikgPT4gYW55LCBkYXRhVHlwZT86IHN0cmluZykge1xyXG4gICAgICAgICQucG9zdCh0aGlzLnRvU3RyaW5nKCksIGRhdGEsIHN1Y2Nlc3MsIGRhdGFUeXBlKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc3RhdGljIHBhcnNlKHVybDogc3RyaW5nIHwgVXJpKTogVXJpIHtcclxuICAgICAgICBpZiAodHlwZW9mIHVybCA9PSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gdXJsO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbmV3IFVyaSh1cmwpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB0b1N0cmluZygpIHtcclxuICAgICAgICBsZXQgcGFyYW0gPSBVcmkuZ2V0RGF0YSh0aGlzLl9kYXRhKTtcclxuICAgICAgICBpZiAocGFyYW0gPT0gJycpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3BhdGg7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLl9wYXRoICsgJz8nICsgcGFyYW07XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHN0YXRpYyBnZXREYXRhKGFyZ3M6IGFueSk6IHN0cmluZyB7XHJcbiAgICAgICAgaWYgKCdvYmplY3QnICE9IHR5cGVvZiBhcmdzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhcmdzO1xyXG4gICAgICAgIH1cclxuICAgICAgICAgICAgbGV0IHZhbHVlOiBzdHJpbmcgPSAnJztcclxuICAgICAgICAkLmVhY2goYXJncywgZnVuY3Rpb24oa2V5LCBpdGVtKSB7XHJcbiAgICAgICAgICAgIHZhbHVlICs9IFVyaS5fZmlsdGVyVmFsdWUoaXRlbSwga2V5KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdmFsdWUuc3Vic3RyaW5nKDAsIHZhbHVlLmxlbmd0aCAtIDEpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIF9maWx0ZXJWYWx1ZShkYXRhLCBwcmU6IHN0cmluZyB8IG51bWJlcikge1xyXG4gICAgICAgIGlmICh0eXBlb2YgZGF0YSAhPSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICByZXR1cm4gcHJlICsgXCI9XCIgKyBkYXRhICsgXCImXCI7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCB2YWx1ZSA9ICcnO1xyXG4gICAgICAgIGxldCBpc0FycmF5OiBib29sZWFuID0gZGF0YSBpbnN0YW5jZW9mIEFycmF5O1xyXG4gICAgICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbihrZXksIGl0ZW0pIHtcclxuICAgICAgICAgICAgdmFsdWUgKz0gVXJpLl9maWx0ZXJWYWx1ZShpdGVtLCBwcmUgKyAoaXNBcnJheSA/IFwiW11cIiA6IFwiW1wiICsga2V5ICsgXCJdXCIpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfcGFyc2VVcmwodXJsOiBzdHJpbmcpOiBbc3RyaW5nLCB7W2tleTogc3RyaW5nXTogc3RyaW5nfV0ge1xyXG4gICAgICAgIGxldCBbcGF0aCwgcGFyYW1dID0gdXJsLnNwbGl0KCc/JywgMik7XHJcbiAgICAgICAgaWYgKCFwYXJhbSkge1xyXG4gICAgICAgICAgICByZXR1cm4gW3BhdGgsIHt9XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IHJldCA9IHt9LFxyXG4gICAgICAgICAgc2VnID0gcGFyYW0uc3BsaXQoJyYnKSxcclxuICAgICAgICAgIGxlbiA9IHNlZy5sZW5ndGgsIGkgPSAwLCBzOyAvL2xlbiA9IDJcclxuICAgICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XHJcbiAgICAgICAgICAgIGlmICghc2VnW2ldKSB7IFxyXG4gICAgICAgICAgICAgIGNvbnRpbnVlOyBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzID0gc2VnW2ldLnNwbGl0KCc9Jyk7XHJcbiAgICAgICAgICAgIHJldFtzWzBdXSA9IHNbMV07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBbcGF0aCwgcmV0XTtcclxuICAgIH1cclxufSIsIi8qKlxyXG4gKiDliIbpobVcclxuICovXHJcbmNsYXNzIFBhZ2UgZXh0ZW5kcyBCb3gge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsZW1lbnQ6IEpRdWVyeSxcclxuICAgICAgICBvcHRpb24/OiBQYWdlT3B0aW9uXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBuZXcgUGFnZURlZmF1bHRPcHRpb24oKSwgb3B0aW9uKTtcclxuICAgICAgICB0aGlzLm9wdGlvbnMudXJsID0gVXJpLnBhcnNlKHRoaXMub3B0aW9ucy51cmwpO1xyXG4gICAgICAgIHRoaXMub3B0aW9ucy5kZWxldGVVcmwgPSBVcmkucGFyc2UodGhpcy5vcHRpb25zLmRlbGV0ZVVybCk7XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnVwZGF0ZVVybCA9IFVyaS5wYXJzZSh0aGlzLm9wdGlvbnMudXBkYXRlVXJsKTtcclxuICAgICAgICB0aGlzLmluaXQoKTtcclxuICAgICAgICB0aGlzLnNlYXJjaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBvcHRpb25zOiBQYWdlT3B0aW9uO1xyXG5cclxuICAgIHByaXZhdGUgX3NlYXJjaEZvcm06IEpRdWVyeTtcclxuXHJcbiAgICBwcml2YXRlIF9zZWFyY2hFbGVtZW50czogSlF1ZXJ5O1xyXG5cclxuICAgIHByaXZhdGUgX2NoZWNrQWxsOiBKUXVlcnk7XHJcblxyXG4gICAgcHJpdmF0ZSBfYm9keTogSlF1ZXJ5O1xyXG5cclxuICAgIHByaXZhdGUgX3BhZ2VyOiBQYWdlcjtcclxuXHJcbiAgICBwdWJsaWMgaW5pdCgpIHtcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2JvZHkgPSB0aGlzLmVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMucGFnZUJvZHkpO1xyXG4gICAgICAgIHRoaXMuX3NlYXJjaEZvcm0gPSB0aGlzLmVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuc2VhcmNoRm9ybSk7XHJcbiAgICAgICAgdGhpcy5fc2VhcmNoRWxlbWVudHMgPSB0aGlzLl9zZWFyY2hGb3JtLmZpbmQoJ2lucHV0LHNlbGVjdCx0ZXh0YXJlYScpO1xyXG4gICAgICAgIHRoaXMuX3BhZ2VyID0gJCgnPHVsIGNsYXNzPVwicGFnZXJcIj48L3VsPicpLnBhZ2VyKHtcclxuICAgICAgICAgICAgcGFnaW5hdGU6IGZ1bmN0aW9uKHBhZ2U6IG51bWJlcikge1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc2VhcmNoKCdwYWdlJywgcGFnZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9jaGVja0FsbCA9IHRoaXMuZWxlbWVudC5maW5kKCcuY2hlY2tBbGwnKTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuYXBwZW5kKHRoaXMuX3BhZ2VyLmVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX2JpbmRFdmVudCgpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjaGVja0FsbCgpIHtcclxuICAgICAgICB0aGlzLl9ib2R5LmZpbmQoXCIuY2hlY2tib3hcIikuYWRkQ2xhc3MoJ2NoZWNrZWQnKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0Q2hlY2tlZFJvdygpOiBBcnJheTxKUXVlcnk+IHtcclxuICAgICAgICBsZXQgZGF0YSA9IFtdO1xyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fYm9keS5maW5kKCcuY2hlY2tib3guY2hlY2tlZCcpLmVhY2goZnVuY3Rpb24oaSwgZWwpIHtcclxuICAgICAgICAgICAgZGF0YS5wdXNoKCQoZWwpLnBhcmVudHMoaW5zdGFuY2Uub3B0aW9ucy5yb3cpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBcclxuICAgIHB1YmxpYyBnZXRDaGVja2VkKCk6IEFycmF5PHN0cmluZz4ge1xyXG4gICAgICAgIGxldCBkYXRhID0gW107XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICAkLmVhY2godGhpcy5nZXRDaGVja2VkUm93KCksIGZ1bmN0aW9uKGksIGl0ZW0pIHtcclxuICAgICAgICAgICAgZGF0YS5wdXNoKGl0ZW0uYXR0cihpbnN0YW5jZS5vcHRpb25zLmlkVGFnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDmjpLluo9cclxuICAgICAqIEBwYXJhbSBuYW1lIFxyXG4gICAgICogQHBhcmFtIG9yZGVyIFxyXG4gICAgICovXHJcbiAgICBwdWJsaWMgc29ydChuYW1lOiBzdHJpbmcsIG9yZGVyOiBzdHJpbmcpIHtcclxuICAgICAgICB0aGlzLnNlYXJjaCh7XHJcbiAgICAgICAgICAgIHNvcnQ6IG5hbWUsXHJcbiAgICAgICAgICAgIG9yZGVyOiBvcmRlclxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5pCc57SiXHJcbiAgICAgKiBAcGFyYW0gbmFtZSBcclxuICAgICAqIEBwYXJhbSB2YWwgXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBzZWFyY2gobmFtZTogYW55ID0ge30sIHZhbD86IGFueSkge1xyXG4gICAgICAgIGlmICh0eXBlb2YgbmFtZSAhPSAnb2JqZWN0Jykge1xyXG4gICAgICAgICAgICBuYW1lID0ge1tuYW1lXTogdmFsfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCFuYW1lLmhhc093blByb3BlcnR5KCdwYWdlJykpIHtcclxuICAgICAgICAgICAgbmFtZVsncGFnZSddID0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vcHRpb25zLnVybC5zZXREYXRhKG5hbWUpO1xyXG4gICAgICAgIHRoaXMucmVmcmVzaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5Yig6Zmk6YCJ5LitXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBkZWxldGVDaGVja2VkKCkge1xyXG4gICAgICAgIGxldCBlbGVtZW50cyA9IHRoaXMuZ2V0Q2hlY2tlZFJvdygpO1xyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgbGV0IGRhdGEgPSBbXTtcclxuICAgICAgICBlbGVtZW50cy5mb3JFYWNoKGl0ZW09PiB7XHJcbiAgICAgICAgICAgIGRhdGEucHVzaChpdGVtLmF0dHIoaW5zdGFuY2Uub3B0aW9ucy5pZFRhZykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZGVsZXRlSWQoLi4uZGF0YSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGRlbGV0ZVJvdyhlbGVtZW50OiBKUXVlcnkpIHtcclxuICAgICAgICBsZXQgaWQgPSBlbGVtZW50LmF0dHIodGhpcy5vcHRpb25zLmlkVGFnKTtcclxuICAgICAgICBpZiAoIWlkKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5kZWxldGVJZChpZCk7XHJcbiAgICB9XHJcbiAgICAvKipcclxuICAgICAqIOiOt+WPlmlk5qCH6K6wXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2dldElkVGFnKCk6IHN0cmluZyB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5pZFRhZy5yZXBsYWNlKCdkYXRhLScsICcnKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZGVsZXRlSWQoLi4uZGF0YTogc3RyaW5nW10pIHtcclxuICAgICAgICBpZiAoZGF0YS5sZW5ndGggPT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgaWYgKGZhbHNlID09IHRoaXMudHJpZ2dlcignZGVsZXRlJywgLi4uZGF0YSkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2RlbGV0ZSBpcyBzdG9wIScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub3B0aW9ucy5kZWxldGVVcmwuc2V0RGF0YSh0aGlzLl9nZXRJZFRhZygpLCBkYXRhKS5wb3N0KHt9LGZ1bmN0aW9uKGRhdGEpIHtcclxuICAgICAgICAgICAgaWYgKGRhdGEuY29kZSA9PSAwKSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5yZWZyZXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9LCAnanNvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyByZWZyZXNoKCkge1xyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iZWZvcmVRdWVyeSBcclxuICAgICAgICAmJiB0aGlzLm9wdGlvbnMuYmVmb3JlUXVlcnkuY2FsbCh0aGlzKSA9PSBmYWxzZSkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncXVlcnkgaXMgc3RvcCEnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9wdGlvbnMudXJsLmdldEpzb24oZnVuY3Rpb24oZGF0YSkge1xyXG4gICAgICAgICAgICBpZiAoaW5zdGFuY2Uub3B0aW9ucy5hZnRlclF1ZXJ5KSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5vcHRpb25zLmFmdGVyUXVlcnkuY2FsbCh0aGlzLCBkYXRhKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoZGF0YS5jb2RlICE9IDApIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGluc3RhbmNlLl9jcmVhdGVCb2R5KGRhdGEuZGF0YS5wYWdlbGlzdCk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLl9wYWdlci5jaGFuZ2UoZGF0YS5kYXRhLnBhZ2UsIE1hdGguY2VpbChkYXRhLmRhdGEudG90YWwgLyBkYXRhLmRhdGEucGFnZVNpemUpKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIpOaWreaYr+WQpuS4uuepuuWAvFxyXG4gICAgICogQHBhcmFtIHZhbCBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfY2hlY2tFbXB0eSh2YWw/OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gIXZhbCB8fCB2YWwgPT0gJycgfHwgdmFsLnRyaW0oKSA9PSAnJztcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdXBkYXRlQ29sdW1uKGVsZW1lbnQ6IEpRdWVyeSkge1xyXG4gICAgICAgIGxldCBuYW1lID0gZWxlbWVudC5hdHRyKCdkYXRhLW5hbWUnKTtcclxuICAgICAgICBpZiAodGhpcy5fY2hlY2tFbXB0eShuYW1lKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpZCA9IGVsZW1lbnQucGFyZW50cyh0aGlzLm9wdGlvbnMucm93KS5hdHRyKHRoaXMub3B0aW9ucy5pZFRhZyk7XHJcbiAgICAgICAgaWYgKHRoaXMuX2NoZWNrRW1wdHkoaWQpKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKHRoaXMub3B0aW9ucy5iZWZvcmVVcGRhdGUgXHJcbiAgICAgICAgJiYgZmFsc2UgPT0gdGhpcy5vcHRpb25zLmJlZm9yZVVwZGF0ZS5jYWxsKHRoaXMsIGVsZW1lbnQsIGlkKSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgbGV0IGlucHV0ID0gJCgnPGlucHV0IHR5cGU9XCJ0ZXh0XCI+Jyk7XHJcbiAgICAgICAgaW5wdXQudmFsKGVsZW1lbnQudGV4dCgpKTtcclxuICAgICAgICBpbnB1dC5ibHVyKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsZXQgdmFsID0gaW5wdXQudmFsKCk7XHJcbiAgICAgICAgICAgIGlucHV0LnJlbW92ZSgpO1xyXG4gICAgICAgICAgICBlbGVtZW50LnRleHQodmFsKTtcclxuICAgICAgICAgICAgaW5zdGFuY2UudXBkYXRlRGF0YShpZCwgbmFtZSwgdmFsKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBlbGVtZW50Lmh0bWwoJycpLmFwcGVuZChpbnB1dCk7XHJcbiAgICAgICAgaW5wdXQuZm9jdXMoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgdXBkYXRlRGF0YShpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIHZhbDogc3RyaW5nKSB7XHJcbiAgICAgICAgaWYgKGZhbHNlID09IHRoaXMudHJpZ2dlcigndXBkYXRlJywgaWQsIG5hbWUsIHZhbCkpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3VwZGF0ZSBpcyBzdG9wIScpO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub3B0aW9ucy51cGRhdGVVcmwucG9zdCh7XHJcbiAgICAgICAgICAgIFt0aGlzLl9nZXRJZFRhZygpXTogaWQsXHJcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICAgIHZhbHVlOiB2YWxcclxuICAgICAgICB9LCBmdW5jdGlvbihkYXRhKSB7XHJcblxyXG4gICAgICAgIH0sICdqc29uJyk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfYmluZEV2ZW50KCkge1xyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5fc2VhcmNoRm9ybS5maW5kKFwiW3R5cGU9c3VibWl0XVwiKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2Uuc2VhcmNoKGluc3RhbmNlLl9nZXRTZWFyY2hGb3JtRGF0YSgpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLmVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuc29ydFJvdysgJz4qJykuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGxldCAkdGhpcyA9ICQodGhpcyk7XHJcbiAgICAgICAgICAgIGxldCBuYW1lID0gJHRoaXMuYXR0cignZGF0YS1uYW1lJyk7XHJcbiAgICAgICAgICAgIGlmIChpbnN0YW5jZS5fY2hlY2tFbXB0eShuYW1lKSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkdGhpcy5oYXNDbGFzcygnc29ydC1hc2MnKSkge1xyXG4gICAgICAgICAgICAgICAgJHRoaXMucmVtb3ZlQ2xhc3MoKS5hZGRDbGFzcygnc29ydC1kZXNjJyk7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5zb3J0KG5hbWUsICdkZXNjJyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkdGhpcy5yZW1vdmVDbGFzcygpLmFkZENsYXNzKCdzb3J0LWFzYycpO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2Uuc29ydChuYW1lLCAnYXNjJyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9jaGVja0FsbC5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbGV0ICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgaWYgKCR0aGlzLmhhc0NsYXNzKCdjaGVja2VkJykpIHtcclxuICAgICAgICAgICAgICAgICR0aGlzLnJlbW92ZUNsYXNzKCdjaGVja2VkJyk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5zdGFuY2UuX2NoZWNrQWxsLmFkZENsYXNzKCdjaGVja2VkJyk7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLl9ib2R5LmZpbmQoJy5jaGVja2JveCcpLmFkZENsYXNzKCdjaGVja2VkJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmZpbmQoJy5kZWxldGVBbGwnKS5jbGljayhmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbGV0ICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgbGV0IHRpcCA9ICR0aGlzLmF0dHIoJ2RhdGEtdGlwJykgfHwgaW5zdGFuY2Uub3B0aW9ucy5kZWxldGVUaXA7XHJcbiAgICAgICAgICAgIGlmIChjb25maXJtKHRpcCkpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmRlbGV0ZUNoZWNrZWQoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5maWx0ZXJSb3cgKyAnIGlucHV0JykuYmx1cihmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UuX3NlYXJjaEVsZW1lbnQoJCh0aGlzKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLmZpbHRlclJvdyArICcgc2VsZWN0JykuY2hhbmdlKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5fc2VhcmNoRWxlbWVudCgkKHRoaXMpKTtcclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9ib2R5Lm9uKFwiY2xpY2tcIiwgJy5kZWxldGUnLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgbGV0ICR0aGlzID0gJCh0aGlzKTtcclxuICAgICAgICAgICAgbGV0IHRpcCA9ICR0aGlzLmF0dHIoJ2RhdGEtdGlwJykgfHwgaW5zdGFuY2Uub3B0aW9ucy5kZWxldGVUaXA7XHJcbiAgICAgICAgICAgIGlmIChjb25maXJtKHRpcCkpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLmRlbGV0ZVJvdygkdGhpcy5wYXJlbnRzKGluc3RhbmNlLm9wdGlvbnMucm93KSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICB0aGlzLl9ib2R5Lm9uKFwiY2xpY2tcIiwgJy5jaGVja2JveCcsIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBsZXQgJHRoaXMgPSAkKHRoaXMpO1xyXG4gICAgICAgICAgICBpZiAoJHRoaXMuaGFzQ2xhc3MoJ2NoZWNrZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgJHRoaXMucmVtb3ZlQ2xhc3MoJ2NoZWNrZWQnKTtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLl9jaGVja0FsbC5yZW1vdmVDbGFzcygnY2hlY2tlZCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICR0aGlzLmFkZENsYXNzKCdjaGVja2VkJyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fYm9keS5vbignY2xpY2snLCB0aGlzLm9wdGlvbnMuY29sdW1uLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UudXBkYXRlQ29sdW1uKCQodGhpcykpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3NlYXJjaEVsZW1lbnQoZWxlbWVudDogSlF1ZXJ5KSB7XHJcbiAgICAgICAgbGV0IG5hbWUgPSBlbGVtZW50LmF0dHIoJ25hbWUnKTtcclxuICAgICAgICBpZiAoIW5hbWUpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLnNlYXJjaChuYW1lLCBlbGVtZW50LnZhbCgpKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9jcmVhdGVCb2R5KGRhdGE6IGFueSkge1xyXG4gICAgICAgIGxldCBodG1sID0gJyc7XHJcbiAgICAgICAgaWYgKHR5cGVvZiBkYXRhID09ICdvYmplY3QnKSB7XHJcbiAgICAgICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgICAgICQuZWFjaChkYXRhLCBmdW5jdGlvbihpLCBpdGVtKSB7XHJcbiAgICAgICAgICAgICAgICBodG1sICs9IGluc3RhbmNlLm9wdGlvbnMuY3JlYXRlUm93KGl0ZW0pO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICBodG1sID0gZGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fYm9keS5odG1sKGh0bWwpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2dldFNlYXJjaEZvcm1EYXRhKCkge1xyXG4gICAgICAgIGxldCBkYXRhID0ge307XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLl9zZWFyY2hFbGVtZW50cy5lYWNoKGZ1bmN0aW9uKGksIGVsZSkge1xyXG4gICAgICAgICAgICBsZXQgZWxlbWVudCA9ICQoZWxlKTtcclxuICAgICAgICAgICAgbGV0IG5hbWUgPSBlbGVtZW50LmF0dHIoJ25hbWUnKTtcclxuICAgICAgICAgICAgaWYgKGVsZW1lbnQuaXMoJ1t0eXBlPXJpZGlvXScpKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5pcygnOmNoZWNrZWQnKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGRhdGFbbmFtZV0gPSBlbGVtZW50LnZhbCgpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlbGVtZW50LmlzKCdbdHlwZT1jaGVja2JveF0nKSkge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuaXMoJzpjaGVja2VkJykpIHtcclxuICAgICAgICAgICAgICAgICAgICBkYXRhW25hbWVdID0gZWxlbWVudC52YWwoKTsgLy8g5aSa6YCJ5pe25pyq6Kej5YazXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZGF0YVtuYW1lXSA9IGVsZW1lbnQudmFsKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGRlbGV0ZShjYWxsYmFjazogKGlkOiBzdHJpbmcsIHJvdzogSlF1ZXJ5KSA9PiBhbnkpOiB0aGlzIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vbignZGVsZXRlJywgY2FsbGJhY2spO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB1cGRhdGUoY2FsbGJhY2s6IChpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIHZhbDogc3RyaW5nKSA9PiBhbnkpOiB0aGlzIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vbigndXBkYXRlJywgY2FsbGJhY2spO1xyXG4gICAgfVxyXG59XHJcblxyXG5pbnRlcmZhY2UgUGFnZU9wdGlvbiB7XHJcbiAgICB1cmw/OiBzdHJpbmcgfCBVcmksICAvLyDmn6Xor6Lpk77mjqVcclxuICAgIGRlbGV0ZVVybD86IHN0cmluZyB8IFVyaSwgLy/liKDpmaTpk77mjqXvvIwgcG9zdCDmj5DkuqRcclxuICAgIHVwZGF0ZVVybD86IHN0cmluZyB8IFVyaSwgIC8vIOabtOaWsOadpemTvuaOpe+8jHBvc3Qg5o+Q5LqkXHJcbiAgICBzZWFyY2hGb3JtPzogc3RyaW5nLCAgIC8v5pCc57Si6KGo5Y2VXHJcbiAgICBwYWdlQm9keT86IHN0cmluZywgICAgIC8vIOWIl+ihqOS4u+S9k1xyXG4gICAgZmlsdGVyUm93Pzogc3RyaW5nLCAgICAvL+etm+mAieihjFxyXG4gICAgc29ydFJvdz86IHN0cmluZywgICAgICAvL+aOkuW6j+ihjFxyXG4gICAgcm93Pzogc3RyaW5nLCAgICAgICAgICAvL+WIl+ihqOihjOagh+etvlxyXG4gICAgY29sdW1uPzogc3RyaW5nLCAgICAgIC8v5Y2V5YWD5qC85qCH562+XHJcbiAgICBpZFRhZz86IHN0cmluZywgICAgICAgIC8vIOihjOS4iueahGlkIOagh+iusFxyXG4gICAgY3JlYXRlUm93PzogKGRhdGE6IGFueSkgPT4gc3RyaW5nLCAgIC8v5LiA6KGM55Sf5oiQXHJcbiAgICBkZWxldGVUaXA/OiBzdHJpbmcsICAgICAvL+WIoOmZpOaPkOekulxyXG4gICAgb25kZWxldGU/OiAoaWQ6IHN0cmluZywgcm93OiBKUXVlcnkpID0+IGFueSwgIC8v5Yig6Zmk5LqL5Lu2XHJcbiAgICBvbnVwZGF0ZT86IChpZDogc3RyaW5nLCBuYW1lOiBzdHJpbmcsIHZhbDogc3RyaW5nKSA9PiBhbnksIC8v5pu05paw5LqL5Lu2XHJcbiAgICBiZWZvcmVVcGRhdGU/OiAoZWxlbWVudDogSlF1ZXJ5LCBpZDogc3RyaW5nKSA9PiBhbnksIFxyXG4gICAgYmVmb3JlUXVlcnk/OiAoKT0+YW55LCAgIC8v5p+l6K+i5byA5aeL5LqL5Lu2XHJcbiAgICBhZnRlclF1ZXJ5PzogKGRhdGEpID0+IGFueSwgLy/mn6Xor6Lnu5PmnZ9cclxufVxyXG5cclxuY2xhc3MgUGFnZURlZmF1bHRPcHRpb24gaW1wbGVtZW50cyBQYWdlT3B0aW9uIHtcclxuICAgIHVybDogc3RyaW5nID0gJ3F1ZXJ5JztcclxuICAgIHVwZGF0ZVVybDogc3RyaW5nID0gJ3VwZGF0ZSc7XHJcbiAgICBkZWxldGVVcmw6IHN0cmluZyA9ICdkZWxldGUnO1xyXG4gICAgaWRUYWc6IHN0cmluZyA9ICdkYXRhLWlkJztcclxuICAgIHNlYXJjaEZvcm0/OiBzdHJpbmcgPSAnLnBhZ2Utc2VhcmNoJztcclxuICAgIGRlbGV0ZVRpcDogc3RyaW5nID0gJ+ehruWumuWIoOmZpO+8nyc7XHJcbiAgICBwYWdlQm9keTogc3RyaW5nID0gJy5wYWdlLWJvZHknO1xyXG4gICAgZmlsdGVyUm93OiBzdHJpbmcgPSAnLmZpbHRlci1yb3cnO1xyXG4gICAgc29ydFJvdzogc3RyaW5nID0gJy5zb3J0LXJvdyc7XHJcbiAgICByb3c6IHN0cmluZyA9ICd0cic7XHJcbiAgICBjb2x1bW46IHN0cmluZyA9ICd0ZCc7XHJcbn1cclxuXHJcblxyXG47KGZ1bmN0aW9uKCQ6IGFueSkge1xyXG4gICQuZm4ucGFnZSA9IGZ1bmN0aW9uKG9wdGlvbiA/OiBQYWdlT3B0aW9uKSB7XHJcbiAgICByZXR1cm4gbmV3IFBhZ2UodGhpcywgb3B0aW9uKTsgXHJcbiAgfTtcclxufSkoalF1ZXJ5KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
