var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var Eve = /** @class */ (function () {
    function Eve() {
    }
    Eve.prototype.on = function (event, callback) {
        this.options['on' + event] = callback;
        return this;
    };
    Eve.prototype.hasEvent = function (event) {
        return this.options.hasOwnProperty('on' + event);
    };
    Eve.prototype.trigger = function (event) {
        var args = [];
        for (var _i = 1; _i < arguments.length; _i++) {
            args[_i - 1] = arguments[_i];
        }
        var realEvent = 'on' + event;
        if (!this.hasEvent(event)) {
            return;
        }
        return (_a = this.options[realEvent]).call.apply(_a, [this].concat(args));
        var _a;
    };
    return Eve;
}());
var Point = /** @class */ (function () {
    function Point(index, x, width, height) {
        this.index = index;
        this.width = width;
        this.height = height;
        this.elements = [];
        if (typeof x == 'number') {
            this.x = x;
            return;
        }
        this.elements.push(x);
        _a = this.getElementWidthAndHeight(), this.width = _a[0], this.height = _a[1];
        this.x = -this.width;
        var _a;
    }
    /**
     * 取元素的x
     * @param width
     */
    Point.prototype.getLeft = function (width) {
        return this.x - (width - 3 * this.width) / 2;
    };
    /**
     * 获取元素的宽和高
     */
    Point.prototype.getElementWidthAndHeight = function () {
        return [this.elements[0].width(), this.elements[0].height()];
    };
    /**
     * 应用当前的宽和高
     */
    Point.prototype.applyWidthAndHeight = function () {
        var instance = this;
        var _a = this.getElementWidthAndHeight(), width = _a[0], height = _a[1];
        if (height == this.height && this.width != width) {
            // 等比例缩放
            this.height = this.width * height / width;
        }
        $.each(this.elements, function (i, ele) {
            ele.width(instance.width);
            ele.height(instance.height);
        });
    };
    return Point;
}());
var SliderItem = /** @class */ (function (_super) {
    __extends(SliderItem, _super);
    function SliderItem(element, options) {
        var _this = _super.call(this) || this;
        _this.element = element;
        _this._data = [];
        _this._length = 0;
        _this._index = 0;
        var option = _this.element.attr('data-slider');
        if (option == '1') {
            return _this;
        }
        _this._extendOption(options, option);
        var items = _this.element.find(_this.options.item);
        if (items.length < 2) {
            return _this;
        }
        _this.options.width = _this._getOption('width');
        _this.options.height = _this._getOption('height');
        _this.options.animationMode = _this._getOption('animationMode');
        _this.element.addClass(_this.options.animationMode + '-slider');
        _this._length = items.length;
        _this._box = items.parent();
        _this.element.attr('data-slider', 1);
        if (_this._length < 2) {
            _this._initOnly(items);
            return _this;
        }
        _this._init(items);
        return _this;
    }
    SliderItem.prototype._timeCallback = function () {
        if (this._getOption('auto')) {
            this.next();
        }
    };
    SliderItem.prototype._extendOption = function (options, option) {
        try {
            option = JSON.parse(option);
        }
        catch (error) {
        }
        this.options = $.extend({}, options, option);
    };
    /**
     * 初始化只有一张
     */
    SliderItem.prototype._initOnly = function (items) {
        var instance = this;
        this._resetOnly(items);
        $(window).resize(function () {
            instance._resetOnly(items);
        });
    };
    /**
     * 设置一张图的高度
     * @param item
     */
    SliderItem.prototype._resetOnly = function (item) {
        var width = this.options.width > 0 ? this._getWidth(this.options.width) : item.width();
        var height = this.options.height > 0 ? this._getWidth(this.options.height) : item.height();
        item.css({ height: height, width: width });
        this.element.css({ height: height, width: width });
    };
    SliderItem.prototype._needMove = function () {
        return this.options.animationMode != 'fade';
    };
    SliderItem.prototype._copyItem = function (items) {
        for (var j = 0; j < 2; j++) {
            for (var i = 0, length_1 = items.length; i < length_1; i++) {
                var newLi = $(items[i].cloneNode(true));
                this._data[i].elements.push(newLi);
                this._box.append(newLi);
            }
        }
    };
    SliderItem.prototype._init = function (items) {
        var instance = this;
        items.each(function (i, item) {
            var point = new Point(i, $(item));
            instance._data.push(point);
        });
        /**
         * 复制两次
         */
        if (this._needMove()) {
            this._copyItem(items);
        }
        this.resize();
        // 输出可点击的列表
        if (this._getOption('hasPoint')) {
            this._addListPoint();
        }
        this._bindEvent();
        this._setTime();
    };
    SliderItem.prototype._bindEvent = function () {
        var instance = this;
        this.element.find(this.options.previous).click(function () {
            instance.previous();
        });
        this.element.find(this.options.next).click(function () {
            instance.next();
        });
        $(window).resize(function () {
            instance.resize();
        });
        if (!$.fn.swipe) {
            return;
        }
        this.element.swipe({
            swipeLeft: function () {
                instance.next();
            },
            swipeRight: function () {
                instance.previous();
            }
        });
    };
    /**
     * 获取配置
     * @param name
     */
    SliderItem.prototype._getOption = function (name) {
        var val = this.element.attr('data-' + name);
        return val || this.options[name];
    };
    SliderItem.prototype._getWidth = function (reltive) {
        if (reltive > 1) {
            return reltive;
        }
        return this.element.width() * reltive;
    };
    SliderItem.prototype._setTime = function () {
        this._time = (this._getOption('spaceTime') + this._getOption('animationTime')) / 16;
    };
    /**
     * 添加跳转点
     * @param count
     */
    SliderItem.prototype._addListPoint = function () {
        var html = '';
        for (var i = 1; i <= this._length; i++) {
            html += '<li><span>' + i + '</span></i>';
        }
        this.element.append('<ul class="slider-point">' + html + '</ul>');
        var instance = this;
        this.element.on(this._getOption('pointEvent'), ".slider-point li", function () {
            instance.index = $(this).index();
        });
    };
    /**
     * 浏览器尺寸变化
     */
    SliderItem.prototype.resize = function () {
        var instance = this;
        var maxWidth = this.element.width();
        var width = 0;
        $.each(this._data, function (i, point) {
            if (instance.options.width > 0) {
                point.width = instance._getWidth(instance.options.width);
            }
            if (instance.options.height > 0) {
                point.height = instance._getWidth(instance.options.height);
            }
            point.applyWidthAndHeight();
            width += point.width;
            point.x = -width;
        });
        if (this._needMove()) {
            this._applySize(width, maxWidth);
        }
        this.index = this._index;
    };
    SliderItem.prototype._applySize = function (width, maxWidth) {
        $.each(this._data, function (i, point) {
            point.x -= width;
        });
        this._box.css({ left: this._data[this._index].getLeft(maxWidth) + "px" });
        this._box.width(width * 3);
    };
    Object.defineProperty(SliderItem.prototype, "index", {
        get: function () {
            return this._index;
        },
        set: function (index) {
            this.goto(index);
        },
        enumerable: true,
        configurable: true
    });
    /**
     * 下一个
     */
    SliderItem.prototype.next = function () {
        this.index++;
    };
    /**
     * 上一个
     */
    SliderItem.prototype.previous = function () {
        this.index--;
    };
    /**
     * 获取起始点和终点
     * @param index
     */
    SliderItem.prototype._getPoint = function (index) {
        if (index < 0) {
            var last = this._data[this._data.length - 1];
            var point = new Point(index, this._data[0].x + last.width, last.width, last.height);
            return [point, last];
        }
        if (index >= this._data.length) {
            var first = this._data[0];
            var point = new Point(index, this._data[this._data.length - 1].x - first.width, first.width, first.height);
            return [point, first];
        }
        return [this._data[index], this._data[index]];
    };
    /**
     * 跳转
     * @param index
     */
    SliderItem.prototype.goto = function (index) {
        this._setTime();
        this._changePoint(index);
    };
    SliderItem.prototype._changePoint = function (index) {
        if (this._needMove()) {
            return this._movePoint(index);
        }
        if (index < 0) {
            index = this._data.length - 1;
        }
        else if (index >= this._data.length) {
            index = 0;
        }
        var instance = this;
        var time = this._getOption('animationTime');
        this._data.forEach(function (point, i) {
            if (i == index) {
                point.elements[0].animate({ opacity: 1 }, time, 'swing', function () {
                    instance._showPoint(index);
                });
                instance.trigger('change', point);
                return;
            }
            point.elements[0].animate({ opacity: 0 }, time, 'swing');
        });
    };
    SliderItem.prototype._showPoint = function (index) {
        this._index = index;
        if (!this.options.hasPoint) {
            return;
        }
        this.element.find(".slider-point li")
            .eq(index).addClass("active").siblings().removeClass("active");
    };
    SliderItem.prototype._movePoint = function (index) {
        var points = this._getPoint(index);
        var width = this.element.width();
        this.element.height(points[0].height);
        var instance = this;
        this._goAndCallback(points[0].getLeft(width), function () {
            if (points[0].index != points[1].index) {
                instance._box.css({ left: points[1].getLeft(width) + 'px' });
            }
            instance._showPoint(points[1].index);
        });
        this.trigger.apply(this, ['change'].concat(points));
    };
    /**
     * 移动动画及回调
     * @param left
     * @param callback
     */
    SliderItem.prototype._goAndCallback = function (left, callback) {
        this._box.animate({ left: left + "px" }, this._getOption('animationTime'), this.options.animationMode, callback);
    };
    SliderItem.prototype.run = function () {
        if (this._length < 1) {
            return;
        }
        this._time--;
        if (this._time <= 0) {
            this._timeCallback();
        }
    };
    return SliderItem;
}(Eve));
/*!
 * jquery.slider - https://github.com/zx648383079/ZoDream.UI
 * Version - 1.0
 * Licensed under the MIT license - http://opensource.org/licenses/MIT
 *
 * Copyright (c) 2017 ZoDream
 */
var Slider = /** @class */ (function () {
    function Slider(element, options) {
        var _this = this;
        this.element = element;
        this._data = [];
        this.options = $.extend({}, new SliderDefaultOptions(), options);
        if (this.element.length == 0) {
            return;
        }
        this.element.each(function (i, item) {
            _this.addItem($(item));
        });
        this._runTimer();
    }
    Slider.prototype.addItem = function (item) {
        if (item instanceof SliderItem) {
            this._data.push(item);
            return;
        }
        this._data.push(new SliderItem(item, this.options));
    };
    /**
     * 倒序循环
     * @param callback 返回false 结束循环，返回 true 删除
     * @param i 初始值
     */
    Slider.prototype.map = function (callback, i) {
        var _this = this;
        if (i === void 0) { i = this._data.length - 1; }
        if (typeof i != 'number') {
            i.forEach(function (j) {
                if (j < 0 || j >= _this._data.length) {
                    return;
                }
                callback(_this._data[j], j);
            });
            return;
        }
        if (i >= this._data.length) {
            i = this._data.length - 1;
        }
        for (; i >= 0; i--) {
            var item = this._data[i];
            var result = callback(item, i);
            if (result == true) {
                this._data.splice(i, 1);
            }
            if (result == false) {
                return;
            }
        }
    };
    Slider.prototype._runTimer = function () {
        var instance = this;
        this._timer = requestAnimationFrame(function () {
            instance.map(function (item) {
                item.run();
            });
            instance._runTimer();
        });
    };
    Slider.prototype._cancelTimer = function () {
        if (this._timer) {
            cancelAnimationFrame(this._timer);
        }
    };
    return Slider;
}());
var SliderDefaultOptions = /** @class */ (function () {
    function SliderDefaultOptions() {
        this.item = 'li';
        this.spaceTime = 3000;
        this.animationTime = 1000;
        this.animationMode = "swing";
        this.previous = ".slider-previous";
        this.next = ".slider-next";
        this.hasPoint = true;
        this.pointEvent = "click";
        this.auto = true;
    }
    return SliderDefaultOptions;
}());
;
(function ($) {
    $.fn.slider = function (options) {
        return new Slider(this, options);
    };
})(jQuery);

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV2ZW50LnRzIiwicG9pbnQudHMiLCJpdGVtLnRzIiwianF1ZXJ5LnNsaWRlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0FBQUE7SUFBQTtJQW1CQSxDQUFBO0lBaEJBLGdCQUFBLEdBQUEsVUFBQSxLQUFBLEVBQUEsUUFBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQSxHQUFBLFFBQUEsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsc0JBQUEsR0FBQSxVQUFBLEtBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxjQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHFCQUFBLEdBQUEsVUFBQSxLQUFBO1FBQUEsY0FBQTthQUFBLFVBQUEsRUFBQSxxQkFBQSxFQUFBLElBQUE7WUFBQSw2QkFBQTs7UUFDQSxJQUFBLFNBQUEsR0FBQSxJQUFBLEdBQUEsS0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsQ0FBQSxLQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsU0FBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLFlBQUEsSUFBQSxTQUFBLElBQUEsR0FBQTs7SUFDQSxDQUFBO0lBQ0EsVUFBQTtBQUFBLENBbkJBLEFBbUJBLElBQUE7QUNuQkE7SUFDQSxlQUNBLEtBQUEsRUFDQSxDQUFBLEVBQ0EsS0FBQSxFQUNBLE1BQUE7UUFIQSxVQUFBLEdBQUEsS0FBQSxDQUFBO1FBRUEsVUFBQSxHQUFBLEtBQUEsQ0FBQTtRQUNBLFdBQUEsR0FBQSxNQUFBLENBQUE7UUFhQSxhQUFBLEdBQUEsRUFBQSxDQUFBO1FBWEEsRUFBQSxDQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxRQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1FBQ0Esb0NBQUEsRUFBQSxrQkFBQSxFQUFBLG1CQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQTs7SUFDQSxDQUFBO0lBTUE7OztPQUdBO0lBQ0EsdUJBQUEsR0FBQSxVQUFBLEtBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsR0FBQSxDQUFBLEtBQUEsR0FBQSxDQUFBLEdBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxHQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7T0FFQTtJQUNBLHdDQUFBLEdBQUE7UUFDQSxNQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLEtBQUEsRUFBQSxFQUFBLElBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsTUFBQSxFQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7T0FFQTtJQUNBLG1DQUFBLEdBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLG9DQUFBLEVBQUEsYUFBQSxFQUFBLGNBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLE1BQUEsSUFBQSxJQUFBLENBQUEsTUFBQSxJQUFBLElBQUEsQ0FBQSxLQUFBLElBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLFFBQUE7WUFDQSxJQUFBLENBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLEdBQUEsTUFBQSxHQUFBLEtBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxDQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxRQUFBLEVBQUEsVUFBQSxDQUFBLEVBQUEsR0FBQTtZQUNBLEdBQUEsQ0FBQSxLQUFBLENBQUEsUUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1lBQ0EsR0FBQSxDQUFBLE1BQUEsQ0FBQSxRQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFDQSxZQUFBO0FBQUEsQ0FsREEsQUFrREEsSUFBQTtBQ2xEQTtJQUFBLDhCQUFBO0lBQ0Esb0JBQ0EsT0FBQSxFQUNBLE9BQUE7UUFGQSxZQUlBLGlCQUFBLFNBc0JBO1FBekJBLGFBQUEsR0FBQSxPQUFBLENBQUE7UUE2QkEsV0FBQSxHQUFBLEVBQUEsQ0FBQTtRQUVBLGFBQUEsR0FBQSxDQUFBLENBQUE7UUFFQSxZQUFBLEdBQUEsQ0FBQSxDQUFBO1FBN0JBLElBQUEsTUFBQSxHQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLGFBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsTUFBQSxJQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUE7O1FBRUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxhQUFBLENBQUEsT0FBQSxFQUFBLE1BQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxLQUFBLEdBQUEsS0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTs7UUFFQSxDQUFBO1FBQ0EsS0FBQSxDQUFBLE9BQUEsQ0FBQSxLQUFBLEdBQUEsS0FBQSxDQUFBLFVBQUEsQ0FBQSxPQUFBLENBQUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxHQUFBLEtBQUEsQ0FBQSxVQUFBLENBQUEsUUFBQSxDQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsT0FBQSxDQUFBLGFBQUEsR0FBQSxLQUFBLENBQUEsVUFBQSxDQUFBLGVBQUEsQ0FBQSxDQUFBO1FBQ0EsS0FBQSxDQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUEsS0FBQSxDQUFBLE9BQUEsQ0FBQSxhQUFBLEdBQUEsU0FBQSxDQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsT0FBQSxHQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUE7UUFDQSxLQUFBLENBQUEsSUFBQSxHQUFBLEtBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLGFBQUEsRUFBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLEtBQUEsQ0FBQSxTQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7O1FBRUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7O0lBQ0EsQ0FBQTtJQWNBLGtDQUFBLEdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUE7SUFDQSxDQUFBO0lBRUEsa0NBQUEsR0FBQSxVQUFBLE9BQUEsRUFBQSxNQUFBO1FBQ0EsSUFBQSxDQUFBO1lBQ0EsTUFBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQUEsS0FBQSxDQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtRQUVBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxFQUFBLE9BQUEsRUFBQSxNQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7T0FFQTtJQUNBLDhCQUFBLEdBQUEsVUFBQSxLQUFBO1FBQ0EsSUFBQSxRQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFVBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxNQUFBLENBQUE7WUFDQSxRQUFBLENBQUEsVUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUE7OztPQUdBO0lBQ0EsK0JBQUEsR0FBQSxVQUFBLElBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO1FBQ0EsSUFBQSxNQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsU0FBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxFQUFBLEtBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxNQUFBLEVBQUEsTUFBQSxFQUFBLEtBQUEsRUFBQSxLQUFBLEVBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDhCQUFBLEdBQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxhQUFBLElBQUEsTUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDhCQUFBLEdBQUEsVUFBQSxLQUFBO1FBQ0EsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQTtZQUNBLEdBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxHQUFBLENBQUEsRUFBQSxRQUFBLEdBQUEsS0FBQSxDQUFBLE1BQUEsRUFBQSxDQUFBLEdBQUEsUUFBQSxFQUFBLENBQUEsRUFBQSxFQUFBLENBQUE7Z0JBQ0EsSUFBQSxLQUFBLEdBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxTQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7Z0JBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxNQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7WUFDQSxDQUFBO1FBQ0EsQ0FBQTtJQUNBLENBQUE7SUFFQSwwQkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLEtBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLEVBQUEsSUFBQTtZQUNBLElBQUEsS0FBQSxHQUFBLElBQUEsS0FBQSxDQUFBLENBQUEsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQTs7V0FFQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLElBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsU0FBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLFdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLFVBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsQ0FBQSxhQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsVUFBQSxFQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsUUFBQSxFQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsK0JBQUEsR0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsUUFBQSxDQUFBLENBQUEsS0FBQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLFFBQUEsRUFBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBLEtBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxJQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxNQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsRUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxLQUFBLENBQUE7WUFDQSxTQUFBLEVBQUE7Z0JBQ0EsUUFBQSxDQUFBLElBQUEsRUFBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLFVBQUEsRUFBQTtnQkFDQSxRQUFBLENBQUEsUUFBQSxFQUFBLENBQUE7WUFDQSxDQUFBO1NBQ0EsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBOzs7T0FHQTtJQUNBLCtCQUFBLEdBQUEsVUFBQSxJQUFBO1FBQ0EsSUFBQSxHQUFBLEdBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxHQUFBLElBQUEsQ0FBQSxDQUFBO1FBQ0EsTUFBQSxDQUFBLEdBQUEsSUFBQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDhCQUFBLEdBQUEsVUFBQSxPQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsT0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLE1BQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsRUFBQSxHQUFBLE9BQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSw2QkFBQSxHQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsR0FBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsV0FBQSxDQUFBLEdBQUEsSUFBQSxDQUFBLFVBQUEsQ0FBQSxlQUFBLENBQUEsQ0FBQSxHQUFBLEVBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7O09BR0E7SUFDQSxrQ0FBQSxHQUFBO1FBQ0EsSUFBQSxJQUFBLEdBQUEsRUFBQSxDQUFBO1FBQ0EsR0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLENBQUEsSUFBQSxJQUFBLENBQUEsT0FBQSxFQUFBLENBQUEsRUFBQSxFQUFBLENBQUE7WUFDQSxJQUFBLElBQUEsWUFBQSxHQUFBLENBQUEsR0FBQSxhQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLENBQUEsMkJBQUEsR0FBQSxJQUFBLEdBQUEsT0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLEVBQUEsQ0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLFlBQUEsQ0FBQSxFQUFBLGtCQUFBLEVBQUE7WUFDQSxRQUFBLENBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQSxLQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBOztPQUVBO0lBQ0EsMkJBQUEsR0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLElBQUEsUUFBQSxHQUFBLElBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxFQUFBLENBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsSUFBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLEVBQUEsVUFBQSxDQUFBLEVBQUEsS0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLFFBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsS0FBQSxDQUFBLEtBQUEsR0FBQSxRQUFBLENBQUEsU0FBQSxDQUFBLFFBQUEsQ0FBQSxPQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsUUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxLQUFBLENBQUEsTUFBQSxHQUFBLFFBQUEsQ0FBQSxTQUFBLENBQUEsUUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQTtZQUNBLENBQUE7WUFDQSxLQUFBLENBQUEsbUJBQUEsRUFBQSxDQUFBO1lBQ0EsS0FBQSxJQUFBLEtBQUEsQ0FBQSxLQUFBLENBQUE7WUFDQSxLQUFBLENBQUEsQ0FBQSxHQUFBLENBQUEsS0FBQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsU0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLFVBQUEsQ0FBQSxLQUFBLEVBQUEsUUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsR0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLCtCQUFBLEdBQUEsVUFBQSxLQUFBLEVBQUEsUUFBQTtRQUNBLENBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsRUFBQSxVQUFBLENBQUEsRUFBQSxLQUFBO1lBQ0EsS0FBQSxDQUFBLENBQUEsSUFBQSxLQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxJQUFBLENBQUEsR0FBQSxDQUFBLEVBQUEsSUFBQSxFQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUEsR0FBQSxJQUFBLEVBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHNCQUFBLDZCQUFBO2FBQUE7WUFDQSxNQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQTtRQUNBLENBQUE7YUFFQSxVQUFBLEtBQUE7WUFDQSxJQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTs7O09BSkE7SUFNQTs7T0FFQTtJQUNBLHlCQUFBLEdBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxFQUFBLENBQUE7SUFDQSxDQUFBO0lBRUE7O09BRUE7SUFDQSw2QkFBQSxHQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBOzs7T0FHQTtJQUNBLDhCQUFBLEdBQUEsVUFBQSxLQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxLQUFBLEdBQUEsSUFBQSxLQUFBLENBQUEsS0FBQSxFQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLEVBQUEsSUFBQSxDQUFBLEtBQUEsRUFBQSxJQUFBLENBQUEsTUFBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUEsQ0FBQSxLQUFBLEVBQUEsSUFBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxJQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLElBQUEsS0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLEtBQUEsR0FBQSxJQUFBLEtBQUEsQ0FBQSxLQUFBLEVBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsR0FBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLEdBQUEsS0FBQSxDQUFBLEtBQUEsRUFBQSxLQUFBLENBQUEsS0FBQSxFQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQSxDQUFBLEtBQUEsRUFBQSxLQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxNQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsS0FBQSxDQUFBLEtBQUEsQ0FBQSxFQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQTs7O09BR0E7SUFDQSx5QkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLElBQUEsQ0FBQSxRQUFBLEVBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxZQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsaUNBQUEsR0FBQSxVQUFBLEtBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsU0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsS0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxLQUFBLEdBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtRQUFBLElBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxLQUFBLElBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsS0FBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLElBQUEsR0FBQSxJQUFBLENBQUEsVUFBQSxDQUFBLGVBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxPQUFBLENBQUEsVUFBQSxLQUFBLEVBQUEsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLEtBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUNBLEVBQUEsT0FBQSxFQUFBLENBQUEsRUFBQSxFQUNBLElBQUEsRUFDQSxPQUFBLEVBQ0E7b0JBQ0EsUUFBQSxDQUFBLFVBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQTtnQkFDQSxDQUFBLENBQ0EsQ0FBQTtnQkFDQSxRQUFBLENBQUEsT0FBQSxDQUFBLFFBQUEsRUFBQSxLQUFBLENBQUEsQ0FBQTtnQkFDQSxNQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsS0FBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQSxPQUFBLENBQ0EsRUFBQSxPQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQ0EsSUFBQSxFQUNBLE9BQUEsQ0FDQSxDQUFBO1FBQ0EsQ0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUEsK0JBQUEsR0FBQSxVQUFBLEtBQUE7UUFDQSxJQUFBLENBQUEsTUFBQSxHQUFBLEtBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsTUFBQSxDQUFBO1FBQ0EsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsSUFBQSxDQUFBLGtCQUFBLENBQUE7YUFDQSxFQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsUUFBQSxDQUFBLFFBQUEsQ0FBQSxDQUFBLFFBQUEsRUFBQSxDQUFBLFdBQUEsQ0FBQSxRQUFBLENBQUEsQ0FBQTtJQUNBLENBQUE7SUFFQSwrQkFBQSxHQUFBLFVBQUEsS0FBQTtRQUNBLElBQUEsTUFBQSxHQUFBLElBQUEsQ0FBQSxTQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7UUFDQSxJQUFBLEtBQUEsR0FBQSxJQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxRQUFBLEdBQUEsSUFBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLGNBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxFQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBLEtBQUEsSUFBQSxNQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsS0FBQSxDQUFBLENBQUEsQ0FBQTtnQkFDQSxRQUFBLENBQUEsSUFBQSxDQUFBLEdBQUEsQ0FBQSxFQUFBLElBQUEsRUFBQSxNQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsT0FBQSxDQUFBLEtBQUEsQ0FBQSxHQUFBLElBQUEsRUFBQSxDQUFBLENBQUE7WUFDQSxDQUFBO1lBQ0EsUUFBQSxDQUFBLFVBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxDQUFBLENBQUEsS0FBQSxDQUFBLENBQUE7UUFDQSxDQUFBLENBQUEsQ0FBQTtRQUNBLElBQUEsQ0FBQSxPQUFBLE9BQUEsSUFBQSxHQUFBLFFBQUEsU0FBQSxNQUFBLEdBQUE7SUFDQSxDQUFBO0lBRUE7Ozs7T0FJQTtJQUNBLG1DQUFBLEdBQUEsVUFBQSxJQUFBLEVBQUEsUUFBQTtRQUNBLElBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxDQUNBLEVBQUEsSUFBQSxFQUFBLElBQUEsR0FBQSxJQUFBLEVBQUEsRUFDQSxJQUFBLENBQUEsVUFBQSxDQUFBLGVBQUEsQ0FBQSxFQUNBLElBQUEsQ0FBQSxPQUFBLENBQUEsYUFBQSxFQUNBLFFBQUEsQ0FDQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLHdCQUFBLEdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxNQUFBLENBQUE7UUFDQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLEtBQUEsRUFBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLEtBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsSUFBQSxDQUFBLGFBQUEsRUFBQSxDQUFBO1FBQ0EsQ0FBQTtJQUNBLENBQUE7SUFDQSxpQkFBQTtBQUFBLENBNVVBLEFBNFVBLENBNVVBLEdBQUEsR0E0VUE7QUM1VUE7Ozs7OztHQU1BO0FBQ0E7SUFDQSxnQkFDQSxPQUFBLEVBQ0EsT0FBQTtRQUZBLGlCQVlBO1FBWEEsWUFBQSxHQUFBLE9BQUEsQ0FBQTtRQWVBLFVBQUEsR0FBQSxFQUFBLENBQUE7UUFaQSxJQUFBLENBQUEsT0FBQSxHQUFBLENBQUEsQ0FBQSxNQUFBLENBQUEsRUFBQSxFQUFBLElBQUEsb0JBQUEsRUFBQSxFQUFBLE9BQUEsQ0FBQSxDQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxNQUFBLElBQUEsQ0FBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsT0FBQSxDQUFBLElBQUEsQ0FBQSxVQUFBLENBQUEsRUFBQSxJQUFBO1lBQ0EsS0FBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBLENBQUEsSUFBQSxDQUFBLENBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO1FBQ0EsSUFBQSxDQUFBLFNBQUEsRUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQVFBLHdCQUFBLEdBQUEsVUFBQSxJQUFBO1FBQ0EsRUFBQSxDQUFBLENBQUEsSUFBQSxZQUFBLFVBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxJQUFBLENBQUEsS0FBQSxDQUFBLElBQUEsQ0FBQSxJQUFBLFVBQUEsQ0FBQSxJQUFBLEVBQUEsSUFBQSxDQUFBLE9BQUEsQ0FBQSxDQUFBLENBQUE7SUFDQSxDQUFBO0lBRUE7Ozs7T0FJQTtJQUNBLG9CQUFBLEdBQUEsVUFBQSxRQUFBLEVBQUEsQ0FBQTtRQUFBLGlCQXVCQTtRQXZCQSxrQkFBQSxFQUFBLElBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLEdBQUEsQ0FBQTtRQUNBLEVBQUEsQ0FBQSxDQUFBLE9BQUEsQ0FBQSxJQUFBLFFBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsT0FBQSxDQUFBLFVBQUEsQ0FBQTtnQkFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLEdBQUEsQ0FBQSxJQUFBLENBQUEsSUFBQSxLQUFBLENBQUEsS0FBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBLENBQUE7b0JBQ0EsTUFBQSxDQUFBO2dCQUNBLENBQUE7Z0JBQ0EsUUFBQSxDQUFBLEtBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLEVBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsQ0FBQTtZQUNBLE1BQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxDQUFBLElBQUEsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsQ0FBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsTUFBQSxHQUFBLENBQUEsQ0FBQTtRQUNBLENBQUE7UUFDQSxHQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsSUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEVBQUEsQ0FBQTtZQUNBLElBQUEsSUFBQSxHQUFBLElBQUEsQ0FBQSxLQUFBLENBQUEsQ0FBQSxDQUFBLENBQUE7WUFDQSxJQUFBLE1BQUEsR0FBQSxRQUFBLENBQUEsSUFBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsRUFBQSxDQUFBLENBQUEsTUFBQSxJQUFBLElBQUEsQ0FBQSxDQUFBLENBQUE7Z0JBQ0EsSUFBQSxDQUFBLEtBQUEsQ0FBQSxNQUFBLENBQUEsQ0FBQSxFQUFBLENBQUEsQ0FBQSxDQUFBO1lBQ0EsQ0FBQTtZQUNBLEVBQUEsQ0FBQSxDQUFBLE1BQUEsSUFBQSxLQUFBLENBQUEsQ0FBQSxDQUFBO2dCQUNBLE1BQUEsQ0FBQTtZQUNBLENBQUE7UUFDQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDBCQUFBLEdBQUE7UUFDQSxJQUFBLFFBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxJQUFBLENBQUEsTUFBQSxHQUFBLHFCQUFBLENBQUE7WUFDQSxRQUFBLENBQUEsR0FBQSxDQUFBLFVBQUEsSUFBQTtnQkFDQSxJQUFBLENBQUEsR0FBQSxFQUFBLENBQUE7WUFDQSxDQUFBLENBQUEsQ0FBQTtZQUNBLFFBQUEsQ0FBQSxTQUFBLEVBQUEsQ0FBQTtRQUNBLENBQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQTtJQUVBLDZCQUFBLEdBQUE7UUFDQSxFQUFBLENBQUEsQ0FBQSxJQUFBLENBQUEsTUFBQSxDQUFBLENBQUEsQ0FBQTtZQUNBLG9CQUFBLENBQUEsSUFBQSxDQUFBLE1BQUEsQ0FBQSxDQUFBO1FBQ0EsQ0FBQTtJQUNBLENBQUE7SUFDQSxhQUFBO0FBQUEsQ0ExRUEsQUEwRUEsSUFBQTtBQWtCQTtJQUFBO1FBQ0EsU0FBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLGNBQUEsR0FBQSxJQUFBLENBQUE7UUFDQSxrQkFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLGtCQUFBLEdBQUEsT0FBQSxDQUFBO1FBQ0EsYUFBQSxHQUFBLGtCQUFBLENBQUE7UUFDQSxTQUFBLEdBQUEsY0FBQSxDQUFBO1FBQ0EsYUFBQSxHQUFBLElBQUEsQ0FBQTtRQUNBLGVBQUEsR0FBQSxPQUFBLENBQUE7UUFDQSxTQUFBLEdBQUEsSUFBQSxDQUFBO0lBQ0EsQ0FBQTtJQUFBLDJCQUFBO0FBQUEsQ0FWQSxBQVVBLElBQUE7QUFHQSxDQUFBO0FBQUEsQ0FBQSxVQUFBLENBQUE7SUFDQSxDQUFBLENBQUEsRUFBQSxDQUFBLE1BQUEsR0FBQSxVQUFBLE9BQUE7UUFDQSxNQUFBLENBQUEsSUFBQSxNQUFBLENBQUEsSUFBQSxFQUFBLE9BQUEsQ0FBQSxDQUFBO0lBQ0EsQ0FBQSxDQUFBO0FBQ0EsQ0FBQSxDQUFBLENBQUEsTUFBQSxDQUFBLENBQUEiLCJmaWxlIjoianF1ZXJ5LnNsaWRlci5qcyIsInNvdXJjZXNDb250ZW50IjpbImFic3RyYWN0IGNsYXNzIEV2ZSB7XHJcbiAgICBwdWJsaWMgb3B0aW9uczogYW55O1xyXG5cclxuICAgIHB1YmxpYyBvbihldmVudDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pOiB0aGlzIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnNbJ29uJyArIGV2ZW50XSA9IGNhbGxiYWNrO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBoYXNFdmVudChldmVudDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMub3B0aW9ucy5oYXNPd25Qcm9wZXJ0eSgnb24nICsgZXZlbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyB0cmlnZ2VyKGV2ZW50OiBzdHJpbmcsIC4uLiBhcmdzOiBhbnlbXSkge1xyXG4gICAgICAgIGxldCByZWFsRXZlbnQgPSAnb24nICsgZXZlbnQ7XHJcbiAgICAgICAgaWYgKCF0aGlzLmhhc0V2ZW50KGV2ZW50KSkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLm9wdGlvbnNbcmVhbEV2ZW50XS5jYWxsKHRoaXMsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG59IiwiY2xhc3MgUG9pbnQge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGluZGV4OiBudW1iZXIsXHJcbiAgICAgICAgeDogbnVtYmVyIHwgSlF1ZXJ5LFxyXG4gICAgICAgIHB1YmxpYyB3aWR0aD86IG51bWJlcixcclxuICAgICAgICBwdWJsaWMgaGVpZ2h0PzogbnVtYmVyXHJcbiAgICApIHtcclxuICAgICAgICBpZiAodHlwZW9mIHggPT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgdGhpcy54ID0geDtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVsZW1lbnRzLnB1c2goeCk7XHJcbiAgICAgICAgW3RoaXMud2lkdGgsIHRoaXMuaGVpZ2h0XSA9IHRoaXMuZ2V0RWxlbWVudFdpZHRoQW5kSGVpZ2h0KCk7XHJcbiAgICAgICAgdGhpcy54ID0gLXRoaXMud2lkdGg7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHg6IG51bWJlcjtcclxuXHJcbiAgICBwdWJsaWMgZWxlbWVudHM6IEFycmF5PEpRdWVyeT4gPSBbXTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIOWPluWFg+e0oOeahHhcclxuICAgICAqIEBwYXJhbSB3aWR0aCBcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldExlZnQod2lkdGg6IG51bWJlcik6IG51bWJlciB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMueCAtICh3aWR0aCAtIDMgKiB0aGlzLndpZHRoKSAvIDI7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5blhYPntKDnmoTlrr3lkozpq5hcclxuICAgICAqL1xyXG4gICAgcHVibGljIGdldEVsZW1lbnRXaWR0aEFuZEhlaWdodCgpOiBbbnVtYmVyLCBudW1iZXJdIHtcclxuICAgICAgICByZXR1cm4gW3RoaXMuZWxlbWVudHNbMF0ud2lkdGgoKSwgdGhpcy5lbGVtZW50c1swXS5oZWlnaHQoKV07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDlupTnlKjlvZPliY3nmoTlrr3lkozpq5hcclxuICAgICAqL1xyXG4gICAgcHVibGljIGFwcGx5V2lkdGhBbmRIZWlnaHQoKSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBsZXQgW3dpZHRoLCBoZWlnaHRdID0gdGhpcy5nZXRFbGVtZW50V2lkdGhBbmRIZWlnaHQoKTtcclxuICAgICAgICBpZiAoaGVpZ2h0ID09IHRoaXMuaGVpZ2h0ICYmIHRoaXMud2lkdGggIT0gd2lkdGgpIHtcclxuICAgICAgICAgICAgLy8g562J5q+U5L6L57yp5pS+XHJcbiAgICAgICAgICAgIHRoaXMuaGVpZ2h0ID0gdGhpcy53aWR0aCAqIGhlaWdodCAvIHdpZHRoO1xyXG4gICAgICAgIH1cclxuICAgICAgICAkLmVhY2godGhpcy5lbGVtZW50cywgZnVuY3Rpb24oaSwgZWxlKSB7XHJcbiAgICAgICAgICAgIGVsZS53aWR0aChpbnN0YW5jZS53aWR0aCk7XHJcbiAgICAgICAgICAgIGVsZS5oZWlnaHQoaW5zdGFuY2UuaGVpZ2h0KTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSIsImNsYXNzIFNsaWRlckl0ZW0gZXh0ZW5kcyBFdmUge1xyXG4gICAgY29uc3RydWN0b3IoXHJcbiAgICAgICAgcHVibGljIGVsZW1lbnQ6IEpRdWVyeSxcclxuICAgICAgICBvcHRpb25zOiBTbGlkZXJPcHRpb25zXHJcbiAgICApIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIGxldCBvcHRpb24gPSB0aGlzLmVsZW1lbnQuYXR0cignZGF0YS1zbGlkZXInKTtcclxuICAgICAgICBpZiAob3B0aW9uID09ICcxJykge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX2V4dGVuZE9wdGlvbihvcHRpb25zLCBvcHRpb24pO1xyXG4gICAgICAgIGxldCBpdGVtcyA9IHRoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5pdGVtKTtcclxuICAgICAgICBpZiAoaXRlbXMubGVuZ3RoIDwgMikge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMub3B0aW9ucy53aWR0aCA9IHRoaXMuX2dldE9wdGlvbignd2lkdGgnKTtcclxuICAgICAgICB0aGlzLm9wdGlvbnMuaGVpZ2h0ID0gdGhpcy5fZ2V0T3B0aW9uKCdoZWlnaHQnKTtcclxuICAgICAgICB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uTW9kZSA9IHRoaXMuX2dldE9wdGlvbignYW5pbWF0aW9uTW9kZScpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hZGRDbGFzcyh0aGlzLm9wdGlvbnMuYW5pbWF0aW9uTW9kZSArICctc2xpZGVyJyk7XHJcbiAgICAgICAgdGhpcy5fbGVuZ3RoID0gaXRlbXMubGVuZ3RoO1xyXG4gICAgICAgIHRoaXMuX2JveCA9IGl0ZW1zLnBhcmVudCgpO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hdHRyKCdkYXRhLXNsaWRlcicsIDEpO1xyXG4gICAgICAgIGlmICh0aGlzLl9sZW5ndGggPCAyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXRPbmx5KGl0ZW1zKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9pbml0KGl0ZW1zKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb3B0aW9uczogU2xpZGVyT3B0aW9ucztcclxuXHJcbiAgICBwcml2YXRlIF9kYXRhOiBBcnJheTxQb2ludD4gPSBbXTtcclxuXHJcbiAgICBwcml2YXRlIF9sZW5ndGg6IG51bWJlciA9IDA7XHJcblxyXG4gICAgcHJpdmF0ZSBfaW5kZXg6IG51bWJlciA9IDA7XHJcblxyXG4gICAgcHJpdmF0ZSBfYm94OiBKUXVlcnk7XHJcblxyXG4gICAgcHJpdmF0ZSBfdGltZTogbnVtYmVyO1xyXG5cclxuICAgIHByaXZhdGUgX3RpbWVDYWxsYmFjaygpIHtcclxuICAgICAgICBpZiAodGhpcy5fZ2V0T3B0aW9uKCdhdXRvJykpIHtcclxuICAgICAgICAgICAgdGhpcy5uZXh0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2V4dGVuZE9wdGlvbihvcHRpb25zOiBhbnksIG9wdGlvbjogc3RyaW5nKSB7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgb3B0aW9uID0gSlNPTi5wYXJzZShvcHRpb24pO1xyXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgb3B0aW9ucywgb3B0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOWIneWni+WMluWPquacieS4gOW8oFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9pbml0T25seShpdGVtczogSlF1ZXJ5KSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLl9yZXNldE9ubHkoaXRlbXMpO1xyXG4gICAgICAgICQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLl9yZXNldE9ubHkoaXRlbXMpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6K6+572u5LiA5byg5Zu+55qE6auY5bqmXHJcbiAgICAgKiBAcGFyYW0gaXRlbSBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfcmVzZXRPbmx5KGl0ZW06IEpRdWVyeSkge1xyXG4gICAgICAgIGxldCB3aWR0aCA9IHRoaXMub3B0aW9ucy53aWR0aCA+IDAgPyB0aGlzLl9nZXRXaWR0aCh0aGlzLm9wdGlvbnMud2lkdGgpIDogaXRlbS53aWR0aCgpO1xyXG4gICAgICAgIGxldCBoZWlnaHQgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0ID4gMCA/IHRoaXMuX2dldFdpZHRoKHRoaXMub3B0aW9ucy5oZWlnaHQpIDogaXRlbS5oZWlnaHQoKTtcclxuICAgICAgICBpdGVtLmNzcyh7aGVpZ2h0OiBoZWlnaHQsIHdpZHRoOiB3aWR0aH0pO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5jc3Moe2hlaWdodDogaGVpZ2h0LCB3aWR0aDogd2lkdGh9KTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9uZWVkTW92ZSgpOiBib29sZWFuIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5vcHRpb25zLmFuaW1hdGlvbk1vZGUgIT0gJ2ZhZGUnO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2NvcHlJdGVtKGl0ZW1zOiBKUXVlcnkpIHtcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IDI7IGogKyspIHtcclxuICAgICAgICAgICAgZm9yKGxldCBpID0gMCwgbGVuZ3RoID0gaXRlbXMubGVuZ3RoOyBpIDwgbGVuZ3RoOyBpICsrKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgbmV3TGkgPSAkKGl0ZW1zW2ldLmNsb25lTm9kZSh0cnVlKSk7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kYXRhW2ldLmVsZW1lbnRzLnB1c2gobmV3TGkpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fYm94LmFwcGVuZChuZXdMaSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfaW5pdChpdGVtczogSlF1ZXJ5KSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBpdGVtcy5lYWNoKChpLCBpdGVtKT0+IHtcclxuICAgICAgICAgICAgbGV0IHBvaW50ID0gbmV3IFBvaW50KGksICQoaXRlbSkpO1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5fZGF0YS5wdXNoKHBvaW50KTtcclxuICAgICAgICB9KTtcclxuICAgICAgICAvKipcclxuICAgICAgICAgKiDlpI3liLbkuKTmrKFcclxuICAgICAgICAgKi9cclxuICAgICAgICBpZiAodGhpcy5fbmVlZE1vdmUoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9jb3B5SXRlbShpdGVtcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMucmVzaXplKCk7XHJcbiAgICAgICAgLy8g6L6T5Ye65Y+v54K55Ye755qE5YiX6KGoXHJcbiAgICAgICAgaWYgKHRoaXMuX2dldE9wdGlvbignaGFzUG9pbnQnKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRMaXN0UG9pbnQoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fYmluZEV2ZW50KCk7XHJcbiAgICAgICAgdGhpcy5fc2V0VGltZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2JpbmRFdmVudCgpIHtcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuZWxlbWVudC5maW5kKHRoaXMub3B0aW9ucy5wcmV2aW91cykuY2xpY2soZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLnByZXZpb3VzKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmZpbmQodGhpcy5vcHRpb25zLm5leHQpLmNsaWNrKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBpbnN0YW5jZS5uZXh0KCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UucmVzaXplKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgaWYgKCEkLmZuLnN3aXBlKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LnN3aXBlKHtcclxuICAgICAgICAgICAgc3dpcGVMZWZ0OiBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLm5leHQoKTtcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgc3dpcGVSaWdodDogZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICAgICBpbnN0YW5jZS5wcmV2aW91cygpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5bphY3nva5cclxuICAgICAqIEBwYXJhbSBuYW1lIFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9nZXRPcHRpb248VD4obmFtZTogc3RyaW5nKTogVCB7XHJcbiAgICAgICAgbGV0IHZhbCA9IHRoaXMuZWxlbWVudC5hdHRyKCdkYXRhLScgKyBuYW1lKTtcclxuICAgICAgICByZXR1cm4gdmFsIHx8IHRoaXMub3B0aW9uc1tuYW1lXTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9nZXRXaWR0aChyZWx0aXZlOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgICAgIGlmIChyZWx0aXZlID4gMSkge1xyXG4gICAgICAgICAgICByZXR1cm4gcmVsdGl2ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZWxlbWVudC53aWR0aCgpICogcmVsdGl2ZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9zZXRUaW1lKCkge1xyXG4gICAgICAgIHRoaXMuX3RpbWUgPSAodGhpcy5fZ2V0T3B0aW9uPG51bWJlcj4oJ3NwYWNlVGltZScpICsgdGhpcy5fZ2V0T3B0aW9uPG51bWJlcj4oJ2FuaW1hdGlvblRpbWUnKSkgLyAxNjtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOa3u+WKoOi3s+i9rOeCuVxyXG4gICAgICogQHBhcmFtIGNvdW50IFxyXG4gICAgICovXHJcbiAgICBwcml2YXRlIF9hZGRMaXN0UG9pbnQoKSB7XHJcbiAgICAgICAgbGV0IGh0bWwgPSAnJztcclxuICAgICAgICBmb3IobGV0IGkgPSAxOyBpIDw9IHRoaXMuX2xlbmd0aDsgaSArKykge1xyXG4gICAgICAgICAgICBodG1sICs9ICc8bGk+PHNwYW4+JyArIGkgKyc8L3NwYW4+PC9pPic7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5hcHBlbmQoJzx1bCBjbGFzcz1cInNsaWRlci1wb2ludFwiPicrIGh0bWwgKyc8L3VsPicpO1xyXG4gICAgICAgIGxldCBpbnN0YW5jZSA9IHRoaXM7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50Lm9uKHRoaXMuX2dldE9wdGlvbigncG9pbnRFdmVudCcpLCBcIi5zbGlkZXItcG9pbnQgbGlcIiwgZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIGluc3RhbmNlLmluZGV4ID0gJCh0aGlzKS5pbmRleCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5rWP6KeI5Zmo5bC65a+45Y+Y5YyWXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyByZXNpemUoKSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBsZXQgbWF4V2lkdGggPSB0aGlzLmVsZW1lbnQud2lkdGgoKTtcclxuICAgICAgICBsZXQgd2lkdGggPSAwO1xyXG4gICAgICAgICQuZWFjaCh0aGlzLl9kYXRhLCBmdW5jdGlvbihpLCBwb2ludCkge1xyXG4gICAgICAgICAgICBpZiAoaW5zdGFuY2Uub3B0aW9ucy53aWR0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHBvaW50LndpZHRoID0gaW5zdGFuY2UuX2dldFdpZHRoKGluc3RhbmNlLm9wdGlvbnMud2lkdGgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpbnN0YW5jZS5vcHRpb25zLmhlaWdodCA+IDApIHtcclxuICAgICAgICAgICAgICAgIHBvaW50LmhlaWdodCA9IGluc3RhbmNlLl9nZXRXaWR0aChpbnN0YW5jZS5vcHRpb25zLmhlaWdodCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcG9pbnQuYXBwbHlXaWR0aEFuZEhlaWdodCgpO1xyXG4gICAgICAgICAgICB3aWR0aCArPSBwb2ludC53aWR0aDtcclxuICAgICAgICAgICAgcG9pbnQueCA9IC13aWR0aDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBpZiAodGhpcy5fbmVlZE1vdmUoKSkge1xyXG4gICAgICAgICAgICB0aGlzLl9hcHBseVNpemUod2lkdGgsIG1heFdpZHRoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5pbmRleCA9IHRoaXMuX2luZGV4O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2FwcGx5U2l6ZSh3aWR0aDogbnVtYmVyLCBtYXhXaWR0aDogbnVtYmVyKSB7XHJcbiAgICAgICAgJC5lYWNoKHRoaXMuX2RhdGEsIGZ1bmN0aW9uKGksIHBvaW50KSB7XHJcbiAgICAgICAgICAgIHBvaW50LnggLT0gd2lkdGg7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fYm94LmNzcyh7bGVmdDogdGhpcy5fZGF0YVt0aGlzLl9pbmRleF0uZ2V0TGVmdChtYXhXaWR0aCkgKyBcInB4XCJ9KTtcclxuICAgICAgICB0aGlzLl9ib3gud2lkdGgod2lkdGggKiAzKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgaW5kZXgoKTogbnVtYmVyIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5faW5kZXg7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0IGluZGV4KGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLmdvdG8oaW5kZXgpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5LiL5LiA5LiqXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBuZXh0KCkge1xyXG4gICAgICAgIHRoaXMuaW5kZXggKys7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDkuIrkuIDkuKpcclxuICAgICAqL1xyXG4gICAgcHVibGljIHByZXZpb3VzKCkge1xyXG4gICAgICAgIHRoaXMuaW5kZXggLS07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiDojrflj5botbflp4vngrnlkoznu4jngrlcclxuICAgICAqIEBwYXJhbSBpbmRleCBcclxuICAgICAqL1xyXG4gICAgcHJpdmF0ZSBfZ2V0UG9pbnQoaW5kZXg6IG51bWJlcik6IFBvaW50W10ge1xyXG4gICAgICAgIGlmIChpbmRleCA8IDApIHtcclxuICAgICAgICAgICAgbGV0IGxhc3QgPSB0aGlzLl9kYXRhW3RoaXMuX2RhdGEubGVuZ3RoIC0gMV07XHJcbiAgICAgICAgICAgIGxldCBwb2ludCA9IG5ldyBQb2ludChpbmRleCwgdGhpcy5fZGF0YVswXS54ICsgbGFzdC53aWR0aCwgbGFzdC53aWR0aCwgbGFzdC5oZWlnaHQpO1xyXG4gICAgICAgICAgICByZXR1cm4gW3BvaW50LCBsYXN0XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluZGV4ID49IHRoaXMuX2RhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGxldCBmaXJzdCA9IHRoaXMuX2RhdGFbMF07XHJcbiAgICAgICAgICAgIGxldCBwb2ludCA9IG5ldyBQb2ludChpbmRleCwgdGhpcy5fZGF0YVt0aGlzLl9kYXRhLmxlbmd0aCAtIDFdLnggLSBmaXJzdC53aWR0aCwgZmlyc3Qud2lkdGgsIGZpcnN0LmhlaWdodCk7XHJcbiAgICAgICAgICAgIHJldHVybiBbcG9pbnQsIGZpcnN0XTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFt0aGlzLl9kYXRhW2luZGV4XSwgdGhpcy5fZGF0YVtpbmRleF1dO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog6Lez6L2sXHJcbiAgICAgKiBAcGFyYW0gaW5kZXggXHJcbiAgICAgKi9cclxuICAgIHB1YmxpYyBnb3RvKGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICB0aGlzLl9zZXRUaW1lKCk7XHJcbiAgICAgICAgdGhpcy5fY2hhbmdlUG9pbnQoaW5kZXgpO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2NoYW5nZVBvaW50KGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgICBpZiAodGhpcy5fbmVlZE1vdmUoKSkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW92ZVBvaW50KGluZGV4KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGluZGV4IDwgMCkge1xyXG4gICAgICAgICAgICBpbmRleCA9IHRoaXMuX2RhdGEubGVuZ3RoIC0gMTtcclxuICAgICAgICB9IGVsc2UgaWYgKGluZGV4ID49IHRoaXMuX2RhdGEubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGluZGV4ID0gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICBsZXQgdGltZSA9IHRoaXMuX2dldE9wdGlvbjxudW1iZXI+KCdhbmltYXRpb25UaW1lJyk7XHJcbiAgICAgICAgdGhpcy5fZGF0YS5mb3JFYWNoKChwb2ludCwgaSkgPT4ge1xyXG4gICAgICAgICAgICBpZiAoaSA9PSBpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgcG9pbnQuZWxlbWVudHNbMF0uYW5pbWF0ZShcclxuICAgICAgICAgICAgICAgICAgICB7b3BhY2l0eTogMX0sXHJcbiAgICAgICAgICAgICAgICAgICAgdGltZSxcclxuICAgICAgICAgICAgICAgICAgICAnc3dpbmcnLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbnN0YW5jZS5fc2hvd1BvaW50KGluZGV4KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UudHJpZ2dlcignY2hhbmdlJywgcG9pbnQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHBvaW50LmVsZW1lbnRzWzBdLmFuaW1hdGUoXHJcbiAgICAgICAgICAgICAgICB7b3BhY2l0eTogMH0sXHJcbiAgICAgICAgICAgICAgICB0aW1lLFxyXG4gICAgICAgICAgICAgICAgJ3N3aW5nJ1xyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3Nob3dQb2ludChpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5faW5kZXggPSBpbmRleDtcclxuICAgICAgICBpZiAoIXRoaXMub3B0aW9ucy5oYXNQb2ludCkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuZWxlbWVudC5maW5kKFwiLnNsaWRlci1wb2ludCBsaVwiKVxyXG4gICAgICAgIC5lcShpbmRleCkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9tb3ZlUG9pbnQoaW5kZXg6IG51bWJlcikge1xyXG4gICAgICAgIGxldCBwb2ludHMgPSB0aGlzLl9nZXRQb2ludChpbmRleCk7XHJcbiAgICAgICAgbGV0IHdpZHRoID0gdGhpcy5lbGVtZW50LndpZHRoKCk7XHJcbiAgICAgICAgdGhpcy5lbGVtZW50LmhlaWdodChwb2ludHNbMF0uaGVpZ2h0KTtcclxuICAgICAgICBsZXQgaW5zdGFuY2UgPSB0aGlzO1xyXG4gICAgICAgIHRoaXMuX2dvQW5kQ2FsbGJhY2socG9pbnRzWzBdLmdldExlZnQod2lkdGgpLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaWYgKHBvaW50c1swXS5pbmRleCAhPSBwb2ludHNbMV0uaW5kZXgpIHtcclxuICAgICAgICAgICAgICAgIGluc3RhbmNlLl9ib3guY3NzKHtsZWZ0OiBwb2ludHNbMV0uZ2V0TGVmdCh3aWR0aCkgKyAncHgnfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaW5zdGFuY2UuX3Nob3dQb2ludChwb2ludHNbMV0uaW5kZXgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMudHJpZ2dlcignY2hhbmdlJywgLi4ucG9pbnRzKTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIOenu+WKqOWKqOeUu+WPiuWbnuiwg1xyXG4gICAgICogQHBhcmFtIGxlZnQgXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sgXHJcbiAgICAgKi9cclxuICAgIHByaXZhdGUgX2dvQW5kQ2FsbGJhY2sobGVmdDogbnVtYmVyLCBjYWxsYmFjazogRnVuY3Rpb24pIHtcclxuICAgICAgICB0aGlzLl9ib3guYW5pbWF0ZShcclxuICAgICAgICAgICAge2xlZnQ6IGxlZnQgKyBcInB4XCJ9LCBcclxuICAgICAgICAgICAgdGhpcy5fZ2V0T3B0aW9uPG51bWJlcj4oJ2FuaW1hdGlvblRpbWUnKSwgXHJcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucy5hbmltYXRpb25Nb2RlLCBcclxuICAgICAgICAgICAgY2FsbGJhY2tcclxuICAgICAgICApO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBydW4oKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2xlbmd0aCA8IDEpIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl90aW1lIC0tO1xyXG4gICAgICAgIGlmICh0aGlzLl90aW1lIDw9IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fdGltZUNhbGxiYWNrKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59IiwiLyohXHJcbiAqIGpxdWVyeS5zbGlkZXIgLSBodHRwczovL2dpdGh1Yi5jb20veng2NDgzODMwNzkvWm9EcmVhbS5VSVxyXG4gKiBWZXJzaW9uIC0gMS4wXHJcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSAtIGh0dHA6Ly9vcGVuc291cmNlLm9yZy9saWNlbnNlcy9NSVRcclxuICpcclxuICogQ29weXJpZ2h0IChjKSAyMDE3IFpvRHJlYW1cclxuICovXHJcbmNsYXNzIFNsaWRlciB7XHJcbiAgICBjb25zdHJ1Y3RvcihcclxuICAgICAgICBwdWJsaWMgZWxlbWVudDogSlF1ZXJ5LFxyXG4gICAgICAgIG9wdGlvbnM/OiBTbGlkZXJPcHRpb25zXHJcbiAgICApIHtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgbmV3IFNsaWRlckRlZmF1bHRPcHRpb25zKCksIG9wdGlvbnMpO1xyXG4gICAgICAgIGlmICh0aGlzLmVsZW1lbnQubGVuZ3RoID09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLmVsZW1lbnQuZWFjaCgoaSwgaXRlbSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLmFkZEl0ZW0oJChpdGVtKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgdGhpcy5fcnVuVGltZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgb3B0aW9uczogU2xpZGVyT3B0aW9ucztcclxuXHJcbiAgICBwcml2YXRlIF9kYXRhOiBBcnJheTxTbGlkZXJJdGVtPiA9IFtdO1xyXG5cclxuICAgIHByaXZhdGUgX3RpbWVyOiBudW1iZXI7XHJcblxyXG4gICAgcHVibGljIGFkZEl0ZW0oaXRlbTogU2xpZGVySXRlbSB8IEpRdWVyeSkge1xyXG4gICAgICAgIGlmIChpdGVtIGluc3RhbmNlb2YgU2xpZGVySXRlbSkge1xyXG4gICAgICAgICAgICB0aGlzLl9kYXRhLnB1c2goaXRlbSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5fZGF0YS5wdXNoKG5ldyBTbGlkZXJJdGVtKGl0ZW0sIHRoaXMub3B0aW9ucykpO1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICog5YCS5bqP5b6q546vXHJcbiAgICAgKiBAcGFyYW0gY2FsbGJhY2sg6L+U5ZueZmFsc2Ug57uT5p2f5b6q546v77yM6L+U5ZueIHRydWUg5Yig6ZmkXHJcbiAgICAgKiBAcGFyYW0gaSDliJ3lp4vlgLxcclxuICAgICAqL1xyXG4gICAgcHVibGljIG1hcChjYWxsYmFjazogKGl0ZW06IFNsaWRlckl0ZW0sIGluZGV4OiBudW1iZXIpID0+IGFueSwgaTogbnVtYmVyIHwgbnVtYmVyW10gPSB0aGlzLl9kYXRhLmxlbmd0aCAtIDEpIHtcclxuICAgICAgICBpZiAodHlwZW9mIGkgIT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgaS5mb3JFYWNoKGogPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGogPCAwIHx8IGogPj0gdGhpcy5fZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYWxsYmFjayh0aGlzLl9kYXRhW2pdLCBqKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKGkgPj0gdGhpcy5fZGF0YS5sZW5ndGgpIHtcclxuICAgICAgICAgICAgaSA9IHRoaXMuX2RhdGEubGVuZ3RoIC0gMTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yICg7IGkgPj0gMDsgaSAtLSkge1xyXG4gICAgICAgICAgICBsZXQgaXRlbSA9IHRoaXMuX2RhdGFbaV07XHJcbiAgICAgICAgICAgIGxldCByZXN1bHQgPSBjYWxsYmFjayhpdGVtLCBpKTtcclxuICAgICAgICAgICAgaWYgKHJlc3VsdCA9PSB0cnVlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kYXRhLnNwbGljZShpLCAxKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocmVzdWx0ID09IGZhbHNlKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfcnVuVGltZXIoKSB7XHJcbiAgICAgICAgbGV0IGluc3RhbmNlID0gdGhpcztcclxuICAgICAgICB0aGlzLl90aW1lciA9IHJlcXVlc3RBbmltYXRpb25GcmFtZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgaW5zdGFuY2UubWFwKGl0ZW09PiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtLnJ1bigpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgaW5zdGFuY2UuX3J1blRpbWVyKCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfY2FuY2VsVGltZXIoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3RpbWVyKSB7XHJcbiAgICAgICAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMuX3RpbWVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuXHJcbmludGVyZmFjZSBTbGlkZXJPcHRpb25zIHtcclxuICAgIGl0ZW0/OiBzdHJpbmcsXHJcbiAgICBib3g/OiBzdHJpbmcsXHJcbiAgICB3aWR0aD86IG51bWJlciwgICAvL+e7n+S4gOaMh+WumuWuveW6plxyXG4gICAgaGVpZ2h0PzogbnVtYmVyLCAgLy/nu5/kuIDmjIflrprpq5jluqbvvIwg5bCP5pWw5pe25beyYm9455qE5a695bqm5Li65YeGXHJcbiAgICBzcGFjZVRpbWU/OiBudW1iZXIsXHJcbiAgICBhbmltYXRpb25UaW1lPzogbnVtYmVyLFxyXG4gICAgYW5pbWF0aW9uTW9kZT86IHN0cmluZyxcclxuICAgIHByZXZpb3VzPzogc3RyaW5nLFxyXG4gICAgbmV4dD86IHN0cmluZyxcclxuICAgIGhhc1BvaW50PzogYm9vbGVhbiwgICAvL+aYr+WQpuacieeCueWHu+i3s+i9rFxyXG4gICAgcG9pbnRFdmVudD86IHN0cmluZywgICAvLyDot7Povazop6blj5Hkuovku7ZcclxuICAgIGF1dG8/OiBib29sZWFuLCAgLy/mmK/lkKboh6rliqjmkq3mlL5cclxuICAgIG9uY2hhbmdlPzogKHN0YXJ0OiBQb2ludCwgZW5kOiBQb2ludCkgPT4gYW55OyAvL+WIh+aNouS6i+S7tlxyXG59XHJcblxyXG5jbGFzcyBTbGlkZXJEZWZhdWx0T3B0aW9ucyBpbXBsZW1lbnRzIFNsaWRlck9wdGlvbnMge1xyXG4gICAgaXRlbTogc3RyaW5nID0gJ2xpJztcclxuICAgIHNwYWNlVGltZTogbnVtYmVyID0gMzAwMDtcclxuICAgIGFuaW1hdGlvblRpbWU6IG51bWJlciA9IDEwMDA7XHJcbiAgICBhbmltYXRpb25Nb2RlOiBzdHJpbmcgPSBcInN3aW5nXCI7XHJcbiAgICBwcmV2aW91czogc3RyaW5nID0gXCIuc2xpZGVyLXByZXZpb3VzXCI7XHJcbiAgICBuZXh0OiBzdHJpbmcgPSBcIi5zbGlkZXItbmV4dFwiO1xyXG4gICAgaGFzUG9pbnQ6IGJvb2xlYW4gPSB0cnVlO1xyXG4gICAgcG9pbnRFdmVudDogc3RyaW5nID0gXCJjbGlja1wiO1xyXG4gICAgYXV0bzogYm9vbGVhbiA9IHRydWU7XHJcbn1cclxuXHJcblxyXG4gOyhmdW5jdGlvbigkOiBhbnkpIHtcclxuICAkLmZuLnNsaWRlciA9IGZ1bmN0aW9uKG9wdGlvbnMgPzogU2xpZGVyT3B0aW9ucykge1xyXG4gICAgcmV0dXJuIG5ldyBTbGlkZXIodGhpcywgb3B0aW9ucyk7IFxyXG4gIH07XHJcbn0pKGpRdWVyeSk7Il19
